{"results":[{"href":"https://blog.champ.design/posts/2021/10/adding-search-to-site/","title":"ç»™ hugo ç«™ç‚¹æ·»åŠ æœç´¢åŠŸèƒ½","body":"å‰è¨€ Â¶ å¯¹äºæ•°æ®åº“é©±åŠ¨çš„ç½‘ç«™ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡ŒSQLæŸ¥è¯¢å…³é”®å­—è¿›è¡Œæœç´¢ï¼›è€Œå¯¹äºé™æ€ç«™ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆç”Ÿæˆç´¢å¼•æ–‡ä»¶ï¼Œç„¶åç”¨ä¸€ä¸ªæœç´¢å¼•æ“è¿›è¡ŒæŸ¥è¯¢ã€‚\nè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªçº¯å‰ç«¯çš„æœç´¢å¼•æ“ Lunr ç”Ÿæˆæ–‡ç« åˆ—è¡¨æ•°æ® Â¶ å› ä¸ºæˆ‘ä»¬çš„ç½‘ç«™æ˜¯ç”¨ hugo æ­å»ºçš„é™æ€ç½‘ç«™ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦åœ¨ hugo æ„å»ºæ—¶ç”Ÿæˆ json æ ¼å¼çš„æ–‡ç« åˆ—è¡¨ã€‚\nåˆ›å»ºjsonæ¨¡æ¿ åˆ›å»ºæ¨¡æ¿æ–‡ä»¶layout/_default/search.jsonï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12  {\u0026#34;results\u0026#34;: [{{- range $index, $page := .Site.RegularPages }}{{- if $index -}}, {{- end }}{\u0026#34;href\u0026#34;: {{$page.Permalink | jsonify }},\u0026#34;title\u0026#34;: {{$page.Title | jsonify }},\u0026#34;body\u0026#34;: {{$page.Content | plainify | jsonify }}}{{- end }}]}  åº”ç”¨æ•°æ®æ¨¡æ¿ç”Ÿæˆæ–‡ç« åˆ—è¡¨æ•°æ® é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæœ‰æ•°æ®æ¨¡æ¿æ˜¯ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆæ•°æ®çš„ï¼Œæˆ‘ä»¬éœ€è¦æ˜¾å¼ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿ã€‚\né¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª search.md æ–‡æ¡£ï¼š\n1  hugo new search.md   æˆ‘ä»¬ä¸éœ€è¦è¿™ä¸ªæ–‡æ¡£çš„å†…å®¹ï¼Œæˆ‘ä»¬åªæ˜¯ä½¿ç”¨å®ƒçš„front matteræ¥æŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2 3 4  ---layout:searchoutputs:[\u0026#34;JSON\u0026#34;]---  æˆ‘ä»¬æŒ‡å®šäº†è¿™ä¸ªæ–‡æ¡£çš„æ¨¡æ¿é‡‡ç”¨æˆ‘ä»¬ä¹‹å‰åˆ›å»ºçš„æ•°æ®æ¨¡æ¿æ–‡ä»¶searchï¼Œè¾“å‡ºæ ¼å¼æŒ‡å®šä¸ºJSONã€‚ è¿™æ ·åœ¨ hugo æ„å»ºæ—¶å°±ä¼šè¾“å‡ºä¸€ä¸ªsearch/index.jsonæ–‡ä»¶ï¼Œå†…å®¹å°±æ˜¯æˆ‘ä»¬ç½‘ç«™çš„æ‰€æœ‰æ–‡ç« ç”Ÿæˆçš„ä¸€ä¸ª json æ–‡ä»¶ã€‚\næ„å»ºç´¢å¼•æ–‡ä»¶ Â¶ åœ¨ä¸»é¡µä½¿ç”¨axiosè·å–æ–‡ç« åˆ—è¡¨ï¼š\n1 2 3  axios.get(\u0026#34;/search/index.json\u0026#34;).then(response =\u0026gt; { window.ArticleList = response.data.result })   æ„å»ºlunrçš„ç´¢å¼•æ–‡ä»¶ï¼š\n1 2 3 4 5 6 7 8  const LunrSearchIndex = lunr(function () { this.ref(\u0026#39;href\u0026#39;) this.field(\u0026#39;title\u0026#39;) this.field(\u0026#39;body\u0026#39;) window.ArticleList.forEach(article =\u0026gt; { this.add(article) }) })   æ‰§è¡Œæœç´¢ Â¶ è¿™ä¸€éƒ¨åˆ†å°±æ¯”è¾ƒç®€å•äº†ï¼Œæˆ‘ä»¬æœ‰äº†æ–‡ç« çš„ç´¢å¼•ç›´æ¥è°ƒç”¨searchå°±å¯ä»¥äº†ï¼š\n1 2  let searchText = \u0026#39;search text from input\u0026#39; let resultList = LunrSearchIndex.search(searchText)   å…³äºlunræ”¯æŒçš„æœç´¢è¯­æ³•ï¼Œå¯ä»¥æŸ¥çœ‹Lurn#Search "},{"href":"https://blog.champ.design/posts/2021/10/position-sticky-not-working/","title":"Sticky å®šä½æ— æ•ˆçš„ä¸€äº›å‘","body":"åœºæ™¯ Â¶ åœ¨å¼€å‘è¿™ä¸ªç½‘ç«™æ—¶ï¼Œæˆ‘æƒ³è®©é¡¶éƒ¨çš„å¯¼èˆªæ /æœç´¢æ åœ¨æ»šåŠ¨æ—¶å›ºå®šåœ¨å±å¹•é¡¶éƒ¨ï¼Œè¿™æ ·ä¼šæ›´æ–¹ä¾¿ç”¨æˆ·çš„æ“ä½œã€‚æœŸæœ›çš„æ•ˆæœå¦‚ä¸‹ï¼š\nåˆæ­¥å®ç°çš„ä»£ç  (æ— æ•ˆä»£ç ğŸ˜Ÿ) Â¶ HTML 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  \u0026lt;body\u0026gt; \u0026lt;div class=\u0026#34;container\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;header\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;wrapper\u0026#34;\u0026gt;éœ€è¦å®šä½çš„å…ƒç´ \u0026lt;/div\u0026gt;  \u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;content\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;div class=\u0026#34;box\u0026#34;\u0026gt;\u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/body\u0026gt;   CSS 1 2 3 4 5 6 7 8 9 10 11 12 13 14  .header { padding-top: 200px; } .wrapper { height: 100px; background-color: red; position: sticky; top: 0; } .box { height: 200px; background-color: #6a737d; margin: 20px 0; }   æ­£å¦‚é«˜äº®éƒ¨åˆ†çš„ä»£ç é‚£æ ·ï¼Œæˆ‘è®¾ç½®äº†.wrapperå…ƒç´ çš„stickyç›¸å…³å±æ€§åå¹¶æ²¡æœ‰ä»€ä¹ˆæ•ˆæœã€‚\næ±‚åŠ© Google ğŸ˜Š Â¶ æœäº†ä¸€åœˆï¼Œç½‘ä¸Šå…³äºstickyæ— æ•ˆçš„å‡ ä¸ªåŸå› å¤§æ¦‚å¦‚ä¸‹ï¼š\n å¿…é¡»æŒ‡å®štop/bottom/left/rightè¿™å‡ ä¸ªå±æ€§ä¹‹ä¸€ çˆ¶å®¹å™¨çš„é«˜åº¦è¦å¤§äºstickyå…ƒç´ çš„é«˜åº¦ ä»»æ„çˆ¶èŠ‚ç‚¹çš„overflowå±æ€§å¿…é¡»éƒ½æ˜¯visible  åœ¨æˆ‘ä»¬è¿™ä¸ªä¾‹å­é‡Œï¼Œè¦å®šä½çš„å…ƒç´ æ˜¯.wrapperï¼Œçˆ¶å®¹å™¨æ˜¯.headerã€‚æˆ‘ä»¬æ²¡æœ‰ç»™.headeræ˜¾å¼è®¾ç½®é«˜åº¦ï¼Œå› æ­¤å®ƒçš„é«˜åº¦æ˜¯ç”±å†…å®¹æ’‘å¼€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œçˆ¶å®¹å™¨ .headerçš„é«˜åº¦ç­‰äºå­å…ƒç´ .wrapperçš„é«˜åº¦ï¼Œä¸æ»¡è¶³ç¬¬2ç‚¹ï¼Œå› æ­¤stickyå®šä½æ— æ•ˆã€‚\nä½†æ˜¯è¿™é‡Œæˆ‘ä»¬åˆä¸èƒ½é€šè¿‡è®¾ç½®.headerçš„é«˜åº¦æ¥å®ç°ï¼Œè€Œæ˜¯è¦åŸºäº.containerä½œä¸ºå®¹å™¨æ¥è®¾ç½®stickyï¼Œè¦ä¸ç„¶å°±ä¼šå‡ºç°ä¸‹é¢è¿™ç§å¥‡æ€ªçš„è¡Œä¸ºï¼š\n.wrapperå…ƒç´ è™½ç„¶ä¼šå¸é¡¶ï¼Œä½†æ˜¯å½“æ»šåŠ¨è·ç¦»å¤§äº.headerçš„é«˜åº¦åï¼Œä¼šè¢«åé¢çš„å…ƒç´ é¡¶ä¸Šå»ï¼Œä¹Ÿä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚\nå˜é€šåŠæ³• Â¶ æš‚æ—¶æ²¡æœ‰æ‰¾åˆ°æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ³•ï¼Œæˆ‘ä»¬åªèƒ½æŠŠ.headerå…ƒç´ è®¾ç½®ä¸ºstickyå®šä½ï¼Œç„¶åè°ƒæ•´topå€¼æ¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚\nç›¸å…³ä»£ç å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  .header { padding-top: 200px; position: sticky; top: -200px; } .wrapper { height: 100px; background-color: red; } .box { height: 200px; background-color: #6a737d; margin: 20px 0; }   æ€»ç»“ Â¶ è¦æƒ³å®ç°å…ƒç´ å¸é¡¶æ•ˆæœï¼Œå¿…é¡»è®¾ç½®æ»šåŠ¨å®¹å™¨å†…çš„ç›´æ¥å­å…ƒç´ ä¸ºstickyå®šä½ï¼Œä¸èƒ½æ˜¯åä»£å­å…ƒç´ ã€‚\nå‚è€ƒ Â¶  https://www.designcise.com/web/tutorial/how-to-fix-issues-with-css-position-sticky-not-working#checking-if-a-parent-element-is-a-flexbox   "},{"href":"https://blog.champ.design/posts/2021/goal/","title":"2021å¹´ç›®æ ‡","body":"2021å¹´è¦è¾¾åˆ°çš„ç›®æ ‡å¦‚ä¸‹ï¼š\n æŠŠblogå’Œtoolsè¿™ä¸¤ä¸ªé¡¹ç›®æ­å»ºèµ·æ¥ï¼Œé…ç½®è‡ªåŠ¨å‘å¸ƒï¼Œåç»­æ¥äº†å…´è‡´ä¹Ÿä¸è‡³äºæ²¡æœ‰åœ°æ–¹å†™ä»£ç ã€‚ é˜…è¯»ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹è¿™æœ¬ä¹¦ é˜…è¯»å¹¶å­¦ä¹ ECMAScriptè§„èŒƒ  "},{"href":"https://blog.champ.design/posts/2021/10/blog-build-process/","title":"ç½‘ç«™æ­å»ºè¿‡ç¨‹","body":"æ¡†æ¶é€‰å‹ Â¶ è¿™ä¸ªç½‘ç«™ä¸ºçº¯é™æ€ç«™ç‚¹ï¼Œä¸æ¶‰åŠæ•°æ®åº“åŠç”¨æˆ·çš„ä¿¡æ¯å­˜å‚¨ï¼Œæ‰€ä»¥é‡‡ç”¨é™æ€ç«™ç‚¹ç”Ÿæˆå™¨æ¥å®ç°ã€‚è€Œç›®å‰æˆ‘æ­£åœ¨å­¦ä¹ golangè¯­è¨€ï¼Œæ‰€ä»¥ä¹Ÿå°±é¡ºç†æˆç« åœ°é€‰æ‹©äº†hugoã€‚\n1  $ hugo new site champ.design   å…³äºä¸»é¢˜ Â¶ ç½‘ç«™æœ€å¼€å§‹é‡‡ç”¨çš„ jane ä¸»é¢˜ï¼Œçœ‹èµ·æ¥æ˜¯ä¸‹é¢è¿™æ ·å­ï¼š\nä¸è¿‡ä¸€ç›´éƒ½æ„Ÿè§‰ä¸å¤ªç¬¦åˆæˆ‘çš„å®¡ç¾ã€‚ ç›´åˆ°æœ‰ä¸€å¤©ï¼Œæˆ‘çœ‹åˆ°äº†è¿™ä¸ªç½‘ç«™ çš„è®¾è®¡ï¼Œç»™äº†æˆ‘ä¸€ç§ç‰¹åˆ«çš„æ„Ÿè§‰ã€‚æˆ–è®¸è¿™å°±æ˜¯æˆ‘æƒ³è¦çš„æ•ˆæœå§ï¼Œç®€æ´è€Œåˆå¤§æ–¹ï¼Œæ²¡æœ‰é‚£ä¹ˆèŠ±é‡Œèƒ¡å“¨ï¼š\nå› æ­¤ï¼Œè¿™ä¸ªç½‘ç«™çš„ä¸»é¢˜ä»æ­¤å°±åŸºäºå®ƒè¿›è¡ŒäºŒæ¬¡å¼€å‘äº†ã€‚\n1  $ hugo new theme basic   å…³äºè‡ªåŠ¨å‘å¸ƒ Â¶ é‡‡ç”¨ Github Actions çš„è‡ªåŠ¨å‘å¸ƒæœºåˆ¶ã€‚\n å…³äºé‡‡ç”¨Github Actionsè‡ªåŠ¨å‘å¸ƒhugoç«™ç‚¹ï¼Œå¯ä»¥å‚è€ƒ è¿™ç¯‡æ–‡ç«  å’Œ è¿™ç¯‡æ–‡ç«   åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ·»åŠ .github/workflows/deploy.ymlæ–‡ä»¶(æ–‡ä»¶åéšæ„ï¼Œä½†å¿…é¡»æ”¾åœ¨.github/workflowsç›®å½•ä¸‹é¢)ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  # Workflow to build and deploy site to Github Pages using Hugoname:Build and Deploy Blog siteon:push:branches:[master ]jobs:build-and-deploy:runs-on:ubuntu-lateststeps:# Step 1 - Checks-out your repository under $GITHUB_WORKSPACE- name:Checkout ğŸ›ï¸uses:actions/checkout@v2# Step 2 - Sets up the latest version of Hugo- name:Setup Hugo ğŸ”§uses:peaceiris/actions-hugo@v2with:hugo-version:\u0026#39;latest\u0026#39;extended:true# Step 3 - Install Dependencies and Build site- name:Install and Build ğŸ”§run:|yarn yarn build# Step 4 - Create name file- name:Create cname filerun:echo \u0026#39;blog.champ.design\u0026#39; \u0026gt; public/CNAME# Step 5 - Push our generated site to our gh-pages branch- name:Deployuses:JamesIves/github-pages-deploy-action@3.7.1with:ACCESS_TOKEN:${{ secrets.GITHUB_TOKEN }}BRANCH:gh-pagesFOLDER:publicCLEAN:true  åç»­å¯¹ç½‘ç«™çš„å®Œå–„ Â¶  ä¼˜åŒ–é¡µé¢æ ·å¼åŠäº¤äº’ é›†æˆç°ä»£å‰ç«¯å¼€å‘å·¥å…·é“¾ é›†æˆ tools é¡¹ç›®ï¼Œtoolsé¡¹ç›®é‡‡ç”¨sveltejså¼€å‘ å¼€å‘å®éªŒå®¤åŠŸèƒ½ï¼ŒåŠŸèƒ½å¾…å®š  "},{"href":"https://blog.champ.design/posts/2019/05/deno_install_explain/","title":"Denoå®‰è£…è„šæœ¬çš„è§£è¯»","body":"install.shæºç  denoçš„å®Œæ•´å®‰è£…è„šæœ¬å¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72  #!/bin/sh  # å½“å‘½ä»¤çš„è¿”å›å€¼ä¸ºéé›¶çŠ¶æ€æ—¶ï¼Œåˆ™ç«‹å³é€€å‡ºè„šæœ¬çš„æ‰§è¡Œ set -e # å®šä¹‰å˜é‡os case $(uname -s) in Darwin) os=\u0026#34;osx\u0026#34; ;; *) os=\u0026#34;linux\u0026#34; ;; esac # å®šä¹‰å˜é‡arch case $(uname -m) in x86_64) arch=\u0026#34;x86_64\u0026#34; ;; *) arch=\u0026#34;other\u0026#34; ;; esac # å¦‚æœä¸Šé¢å¾—åˆ°çš„ arch å˜é‡ä¸æ˜¯ x86_64ï¼Œåˆ™é€€å‡ºå®‰è£… if [ \u0026#34;$arch\u0026#34; = \u0026#34;other\u0026#34; ]; then echo \u0026#34;Unsupported architecture $(uname -m). Only x64 binaries are available.\u0026#34; exit fi # $# çš„æ„æ€æ˜¯ï¼Œä¼ é€’ç»™è¯¥è„šæœ¬çš„å‚æ•°ä¸ªæ•° # å¯ä»¥é€šè¿‡ $1 $2 ... æŒ‰ç…§ä½ç½®æ‹¿åˆ°è¿™äº›å‚æ•° # ä¸‹é¢è¿™å—ä»£ç çš„ç›®çš„ï¼Œæ˜¯æ‹¿åˆ°è¦ä¸‹è½½çš„å®‰è£…åŒ…åœ°å€ if [$# -eq 0 ]; then # æŒ‰ç…§readmeçš„å®‰è£…è¯´æ˜ï¼Œæ— å‚ä»£è¡¨å®‰è£…æœ€æ–°ç‰ˆ # æ³¨æ„ä¸‹é¢ç®¡é“ç¬¦çš„ä½¿ç”¨ï¼Œç”¨æ¥æµå¼å¤„ç†å‘½ä»¤çš„ç»“æœ deno_asset_path=$(curl -sSf https://github.com/denoland/deno/releases | grep -o \u0026#34;/denoland/deno/releases/download/.*/deno_${os}_x64\\\\.gz\u0026#34; | head -n 1) if [ ! \u0026#34;$deno_asset_path\u0026#34; ]; then exit 1; fi deno_uri=\u0026#34;https://github.com${deno_asset_path}\u0026#34; else # å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼Œç‰ˆæœ¬å·é€šè¿‡å‚æ•° $1 è·å– deno_uri=\u0026#34;https://github.com/denoland/deno/releases/download/${1}/deno_${os}_x64.gz\u0026#34; fi # å®šä¹‰denoäºŒè¿›åˆ¶æ–‡ä»¶çš„å®‰è£…è·¯å¾„å’Œå¯æ‰§è¡Œæ–‡ä»¶è·¯å¾„ # æ ¹æ® issue#40,è¿™ä¸ªè·¯å¾„åœ¨å°†æ¥å¯èƒ½ä¼šå‘ç”Ÿå˜åŒ– # https://github.com/denoland/deno_install/issues/40 bin_dir=\u0026#34;$HOME/.deno/bin\u0026#34; exe=\u0026#34;$bin_dir/deno\u0026#34; # å¦‚æœç›®å½•è¿˜ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º if [ ! -d \u0026#34;$bin_dir\u0026#34; ]; then mkdir -p \u0026#34;$bin_dir\u0026#34; fi # ä¸‹è½½å®‰è£…åŒ… # curl çš„ -o é€‰é¡¹è¡¨ç¤ºå†™å…¥ä¸Šé¢å®šä¹‰çš„æ–‡ä»¶è·¯å¾„ä¸­ # curl çš„ -# é€‰é¡¹è¡¨ç¤ºæ˜¾ç¤ºè¿›åº¦ curl -fL# -o \u0026#34;$exe.gz\u0026#34; \u0026#34;$deno_uri\u0026#34; # ä¸‹è½½å®ŒäºŒè¿›åˆ¶æ–‡ä»¶ä¹‹åï¼Œè¿›è¡Œè§£å‹ gunzip -df \u0026#34;$exe.gz\u0026#34; # æ·»åŠ æ‰§è¡Œæƒé™ chmod +x \u0026#34;$exe\u0026#34; echo \u0026#34;Deno was installed successfully to $exe\u0026#34; # æµ‹è¯• deno æ˜¯å¦åœ¨ PATH ä¸­å®šä¹‰ if command -v deno \u0026gt;/dev/null; then echo \u0026#34;Run \u0026#39;deno --help\u0026#39; to get started\u0026#34; else echo \u0026#34;Manually add the directory to your \\$HOME/.bash_profile (or similar)\u0026#34; echo \u0026#34; export PATH=\\\u0026#34;$bin_dir:\\$PATH\\\u0026#34;\u0026#34; echo \u0026#34;Run \u0026#39;$exe--help\u0026#39; to get started\u0026#34; fi   å…³äºset -eçš„ä½œç”¨ï¼Œå‚è€ƒshellè„šæœ¬ä¸­set -eé€‰é¡¹ä½œç”¨èŒƒå›´ å…³äºcommandå‘½ä»¤çš„è§£é‡Šï¼Œå‚è€ƒshell commandå‘½ä»¤  æ³¨æ„: å…³äºcurlå‘½ä»¤çš„-Lé€‰é¡¹ 1 2 3 4  $ curl -h ... -L, --location Follow redirects ...    è¯¥é€‰é¡¹å¯ä»¥è·Ÿéšurlçš„é‡å®šå‘ï¼Œæ‰€ä»¥å¯¹äºgithubä¸Šçš„èµ„æºä¸‹è½½æ˜¯å¾ˆé‡è¦çš„æˆ‘è‡ªå·±åœ¨è°ƒè¯•çš„æ—¶å€™ï¼Œä¸ºäº†ç®€å•ï¼Œæ²¡æœ‰ä½¿ç”¨è¯¥é€‰é¡¹ï¼Œæ‰€ä»¥å¯¼è‡´ä¸‹è½½äº†é”™è¯¯çš„æ–‡ä»¶ "},{"href":"https://blog.champ.design/posts/2019/05/mongo-learn-note-1/","title":"MongoDB å­¦ä¹ ç¬”è®°ä¹‹CRUD","body":"å¯åŠ¨ä¸€ä¸ª MongoDB æœåŠ¡å™¨å®¹å™¨ Â¶ 1 2  $ docker pull mongo:4 $ docker run --name mymongo -v /data/docker-db:/data/db -d mongo:4   å¯åŠ¨ Mongo Express å®¹å™¨ Â¶ 1 2  $ docker pull mongo-express $ docker run --link mymongo:mongo -p 8081:8081 -d mongo-express   åœ¨æµè§ˆå™¨æ‰“å¼€ http://localhost:8081ï¼Œmongo-expres çš„ç•Œé¢å¦‚ä¸‹:\nå¯åŠ¨ Mongo shell Â¶ 1  $ docker exec -it mymongo mongo   æ–‡æ¡£çš„åŸºæœ¬æ“ä½œ Â¶ 1 2 3 4 5 6 7 8 9 10 11 12  # æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“ \u0026gt; show dbs admin 0.000GB config 0.000GB local 0.000GB # åˆ‡æ¢åˆ° test æ•°æ®åº“ \u0026gt; use test switched to db test # æŸ¥çœ‹ test æ•°æ®åº“ä¸­çš„é›†åˆ \u0026gt; show collections   åˆ›å»ºæ–‡æ¡£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159  # å‡†å¤‡å†™å…¥æ•°æ®åº“çš„æ–‡æ¡£ # { # _id: \u0026#34;account1\u0026#34;, # name: \u0026#34;alice\u0026#34;, # balance: 100 # } # å°†æ–‡æ¡£å†™å…¥ accounts é›†åˆ \u0026gt; db.accounts.insertOne( ... { ... _id: \u0026#34;account1\u0026#34;, ... name: \u0026#34;alice\u0026#34;, ... balance: 100 ... } ...) { \u0026#34;acknowledged\u0026#34;: true, \u0026#34;insertedId\u0026#34;: \u0026#34;account1\u0026#34; } # å†™å…¥idé‡å¤çš„æ•°æ®æ—¶ \u0026gt; db.accounts.insertOne( ... { ... _id: \u0026#34;account1\u0026#34;, ... name: \u0026#34;bob\u0026#34;, ... balance: 200 ... } ...) 2019-05-18T13:37:29.722+0000 E QUERY [js] WriteError: E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \u0026#34;account1\u0026#34; } : WriteError({ \u0026#34;index\u0026#34; : 0, \u0026#34;code\u0026#34; : 11000, \u0026#34;errmsg\u0026#34; : \u0026#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \\\u0026#34;account1\\\u0026#34; }\u0026#34;, \u0026#34;op\u0026#34; : { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 200 } }) WriteError@src/mongo/shell/bulk_api.js:461:48 Bulk/mergeBatchResults@src/mongo/shell/bulk_api.js:841:49 Bulk/executeBatch@src/mongo/shell/bulk_api.js:906:13 Bulk/this.execute@src/mongo/shell/bulk_api.js:1150:21 DBCollection.prototype.insertOne@src/mongo/shell/crud_api.js:252:9 @(shell):1:1 # ä½¿ç”¨ try-catch æ•è·é”™è¯¯ \u0026gt; try { ... db.accounts.insertOne( ... { ... _id: \u0026#34;account1\u0026#34;, ... name: \u0026#34;bob\u0026#34;, ... balance: 200 ... } ... ) ...} catch (e) { ... print(e) ...} WriteError({ \u0026#34;index\u0026#34; : 0, \u0026#34;code\u0026#34; : 11000, \u0026#34;errmsg\u0026#34; : \u0026#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \\\u0026#34;account1\\\u0026#34; }\u0026#34;, \u0026#34;op\u0026#34; : { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 200 } }) # åˆ›å»ºå¤šä¸ªæ–‡æ¡£ \u0026gt; db.accounts.insertMany( [ ... { ... name: \u0026#39;charlie\u0026#39;, ... balance: 500 ... }, ... { ... name: \u0026#39;david\u0026#39;, ... balance: 200 ... } ... ] ) { \u0026#34;acknowledged\u0026#34; : true, \u0026#34;insertedIds\u0026#34; : [ ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;) ] } # é¡ºåºå†™å‡ºç°é”™è¯¯æ—¶ \u0026gt; try { ... db.accounts.insertMany( [ ... { ... _id: \u0026#39;account1\u0026#39;, ... name: \u0026#39;edwrad\u0026#39;, ... balance: 700 ... }, ... { ... name: \u0026#39;fred\u0026#39;, ... balance: 20 ... } ... ] ) ... } catch(e) { ... print(e) ... } BulkWriteError({ \u0026#34;writeErrors\u0026#34; : [ { \u0026#34;index\u0026#34; : 0, \u0026#34;code\u0026#34; : 11000, \u0026#34;errmsg\u0026#34; : \u0026#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \\\u0026#34;account1\\\u0026#34; }\u0026#34;, \u0026#34;op\u0026#34; : { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;edwrad\u0026#34;, \u0026#34;balance\u0026#34; : 700 } } ], \u0026#34;writeConcernErrors\u0026#34; : [ ], \u0026#34;nInserted\u0026#34; : 0, #æ³¨æ„è¿™é‡Œï¼Œæ’å…¥æ¡æ•°ä¸º0 \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;nRemoved\u0026#34; : 0, \u0026#34;upserted\u0026#34; : [ ] }) # ä¹±åºå†™å‡ºç°é”™è¯¯æ—¶ \u0026gt; try { ... db.accounts.insertMany( [ ... { ... _id: \u0026#39;account1\u0026#39;, ... name: \u0026#39;edwrad\u0026#39;, ... balance: 700 ... }, ... { ... name: \u0026#39;fred\u0026#39;, ... balance: 20 ... } ... ], { ordered: false } ) ... } catch(e) { ... print(e) ... } BulkWriteError({ \u0026#34;writeErrors\u0026#34; : [ { \u0026#34;index\u0026#34; : 0, \u0026#34;code\u0026#34; : 11000, \u0026#34;errmsg\u0026#34; : \u0026#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \\\u0026#34;account1\\\u0026#34; }\u0026#34;, \u0026#34;op\u0026#34; : { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;edwrad\u0026#34;, \u0026#34;balance\u0026#34; : 700 } } ], \u0026#34;writeConcernErrors\u0026#34; : [ ], \u0026#34;nInserted\u0026#34; : 1, #æˆåŠŸæ’å…¥äº†1æ¡ \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;nRemoved\u0026#34; : 0, \u0026#34;upserted\u0026#34; : [ ] })    æ€»ç»“db.collection.insertMany() å¤„ç†é”™è¯¯çš„æ–¹å¼: 1 2 3 4 5 6 7 8 9  { _id: \u0026#34;account1\u0026#34;, name: \u0026#34;edwrad\u0026#34;, -------\u0026gt; é”™è¯¯çš„æ–‡æ¡£ balance: 700 } { name: \u0026#34;fred\u0026#34;, -------\u0026gt; æ­£ç¡®çš„æ–‡æ¡£ balance: 20 }    åœ¨é¡ºåºå†™å…¥æ—¶ï¼Œä¸€æ—¦é‡åˆ°é”™è¯¯ï¼Œæ“ä½œä¾¿ä¼šé€€å‡ºï¼Œå‰©ä½™çš„æ–‡æ¡£æ— è®ºæ­£ç¡®ä¸å¦ï¼Œéƒ½ä¸ä¼šè¢«å†™å…¥æ‰€ä»¥ï¼Œä¸Šé¢è¿™ä¸¤ä¸ªæ–‡æ¡£éƒ½ä¸ä¼šè¢«å†™å…¥åˆ°æ•°æ®åº“åœ¨ä¹±åºå†™å…¥æ—¶ï¼Œå³ä½¿æŸäº›æ–‡æ¡£é€ æˆäº†é”™è¯¯ï¼Œå‰©ä½™çš„æ­£ç¡®çš„æ–‡æ¡£ä»ç„¶ä¼šè¢«å†™å…¥ æ‰€ä»¥ï¼Œç¬¬äºŒç¯‡æ–‡æ¡£ä¼šè¢«æ­£å¸¸å†™å…¥æ•°æ®åº“ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  # insert å‘½ä»¤ # åˆ›å»ºå•ä¸ªæˆ–å¤šä¸ªæ–‡æ¡£ \u0026gt; db.accounts.insert( ... { ... name: \u0026#39;george\u0026#39;, ... balance: 1000 ... } ... ) WriteResult({ \u0026#34;nInserted\u0026#34; : 1 }) \u0026gt; db.accounts.insert( [ ... { ... name: \u0026#39;abc\u0026#39;, ... balance: 200 ... }, ... { ... name: \u0026#39;xyz\u0026#39;, ... balance: 200 ... } ] ) BulkWriteResult({ \u0026#34;writeErrors\u0026#34;: [ ], \u0026#34;writeConcernErrors\u0026#34;: [ ], \u0026#34;nInserted\u0026#34;: 2, \u0026#34;nUpserted\u0026#34;: 0, \u0026#34;nMatched\u0026#34;: 0, \u0026#34;nModified\u0026#34;: 0, \u0026#34;nRemoved\u0026#34;: 0, \u0026#34;upserted\u0026#34;: [ ] })   1 2 3 4 5 6 7 8 9 10 11  # save åˆ›å»ºå•ä¸€æ–‡æ¡£ \u0026gt; db.accounts.save( { name: \u0026#39;\u0026#39;, balance: 200 }, { writeConcern: \u0026lt;document\u0026gt; } ) # save ä¼šè°ƒç”¨ insert åˆ›å»ºæ–‡æ¡£ï¼Œæ‰€ä»¥ save çš„è¿”å›ç±»å‹å’Œ insert ç›¸åŒ   å¯¹è±¡ä¸»é”® é»˜è®¤çš„å¯¹è±¡ä¸»é”® objectId\n1 2 3 4 5 6 7  # ç”ŸæˆobjectIdä¸»é”® \u0026gt; ObjectId() ObjectId(\u0026#34;5ce0ec0672e77e7cb392a90b\u0026#34;) # æå‰ ObjectId çš„åˆ›å»ºæ—¶é—´ \u0026gt; ObjectId(\u0026#34;5ce0ec0672e77e7cb392a90b\u0026#34;).getTimestamp() ISODate(\u0026#34;2019-05-19T05:39:18Z\u0026#34;)   å¤åˆä¸»é”® å¯ä»¥ä½¿ç”¨æ–‡æ¡£ä½œä¸ºæ–‡æ¡£çš„ä¸»é”®\n1 2 3 4 5 6 7  \u0026gt; db.accounts.insert( { _id: { accountNo: \u0026#34;001\u0026#34;, type: \u0026#34;savings\u0026#34; }, name: \u0026#34;irene\u0026#34;, balance: 80 } )   è¯»å–æ–‡æ¡£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76  # find æ”¯æŒåŒ¹é…æŸ¥è¯¢å’ŒæŠ•å°„ db.\u0026lt;collection\u0026gt;.find(\u0026lt;query\u0026gt;, \u0026lt;projection\u0026gt;) \u0026lt;query\u0026gt;å®šä¹‰äº†æœç´¢æ¡ä»¶ \u0026lt;projection\u0026gt;å®šä¹‰äº†æŠ•å°„ï¼Œå¯ä»¥åªè¿”å›ç»“æœæ–‡æ¡£ä¸­çš„éƒ¨åˆ†å­—æ®µ # è¯»å–å…¨éƒ¨æ–‡æ¡£ # æ—¢ä¸ç­›é€‰ï¼Œä¹Ÿä¸æŠ•å°„ \u0026gt; db.accounts.find() { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # æ ¼å¼åŒ–ç»“æœ \u0026gt; db.accounts.find().pretty() { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 }   åŒ¹é…æŸ¥è¯¢ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  # ç­›é€‰æ–‡æ¡£ # åŒ¹é…æŸ¥è¯¢ è¯­æ³•: { \u0026lt;field\u0026gt;: \u0026lt;value\u0026gt;, ... } # è¯»å– alice çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;alice\u0026#34; } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # è¯»å– alice çš„ä½™é¢ä¸º100å…ƒçš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;alice\u0026#34;, balance: 100 } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # è¯»å– alice çš„ä½™é¢ä¸º200å…ƒçš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;alice\u0026#34;, balance: 200 } ) ä¸å­˜åœ¨ # è¯»å–é“¶è¡Œè´¦æˆ·ç±»å‹ä¸º savings çš„æ–‡æ¡£ (å¤åˆä¸»é”®) \u0026gt; db.accounts.find( { \u0026#34;_id.type\u0026#34;: \u0026#34;savings\u0026#34; } ) { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 }   æ¯”è¾ƒæ“ä½œç¬¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66  # ç­›é€‰æ–‡æ¡£ # æ¯”è¾ƒæ“ä½œç¬¦ $eq equal $ne not equal $gt great than $gte great than or equal $lt less than $lte less than or equal è¯­æ³•: { \u0026lt;field\u0026gt;: { $\u0026lt;operator\u0026gt;: \u0026lt;value\u0026gt; } } # è¯»å– alice çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $eq: \u0026#34;alice\u0026#34; } } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # ä¸ db.accounts.find( { name: \u0026#34;alice\u0026#34; } ) çš„æŸ¥è¯¢æ•ˆæœç›¸åŒ # è¯»å–ä¸å±äº alice çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $ne: \u0026#34;alice\u0026#34; } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # è¯»å–æ‰€æœ‰ä½™é¢ä¸ç­‰äº100çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { balance: { $ne: 100 } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # è¯»å–ä½™é¢å¤§äº200çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { balance: { $gt: 200 } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } $in åŒ¹é…å­—æ®µå€¼ä¸ä»»ä¸€æŸ¥è¯¢å€¼ç›¸ç­‰çš„æ–‡æ¡£ $nin åŒ¹é…å­—æ®µå€¼ä¸ä»»ä½•æŸ¥è¯¢å€¼éƒ½ä¸ç›¸ç­‰çš„æ–‡æ¡£ è¯­æ³•: { \u0026lt;field\u0026gt;: { $in: [ \u0026lt;value1\u0026gt;, \u0026lt;value2\u0026gt;, ... ] } } # è¯»å– alice å’Œ charlie çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $in: [ \u0026#34;alice\u0026#34;, \u0026#34;charlie\u0026#34; ] } } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # è¯»å–é™¤äº† alice å’Œ charlie ä»¥å¤–çš„å…¶ä»–ç”¨æˆ·çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $nin: [ \u0026#34;alice\u0026#34;, \u0026#34;charlie\u0026#34; ] } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 }    æ³¨æ„: $neä¼šç­›é€‰å‡ºå¹¶ä¸åŒ…å«æŸ¥è¯¢å­—æ®µçš„æ–‡æ¡£æ¯”å¦‚ï¼Œè¯»å–é“¶è¡Œè´¦æˆ·ç±»å‹ä¸æ˜¯ savings çš„æ–‡æ¡£: db.accounts.find( { \u0026quot;_id.type\u0026quot;: { $ne: \u0026quot;savings\u0026quot; } } )\n 1 2 3 4 5 6 7 8  { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 }    å¯ä»¥çœ‹åˆ°ï¼Œç»“æœä¸­æœ‰å¾ˆå¤šæ–‡æ¡£å¹¶æ²¡æœ‰åŒ…å« _id.type è¿™ä¸ªå­—æ®µå¯ä»¥é…åˆä¸‹é¢çš„ $exists æ“ä½œç¬¦ä¸€å—ä½¿ç”¨ä¸ $ne ç±»ä¼¼ï¼Œ$nin ä¹Ÿä¼šç­›é€‰å‡ºå¹¶ä¸åŒ…å«æŸ¥è¯¢å­—æ®µçš„æ–‡æ¡£æ¯”å¦‚ï¼Œè¯»å–è´¦æˆ·ç±»å‹ä¸æ˜¯ savings çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£: db.accounts.find( { \u0026quot;_id.type\u0026quot;: { $nin: [ \u0026quot;savings\u0026quot; ] } } )\n 1 2 3 4 5 6 7 8  { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 }    å¯ä»¥çœ‹åˆ°ï¼Œç»“æœä¸­æœ‰å¾ˆå¤šæ–‡æ¡£å¹¶æ²¡æœ‰åŒ…å« _id.type è¿™ä¸ªå­—æ®µå¯ä»¥é…åˆä¸‹é¢çš„ $exists æ“ä½œç¬¦ä¸€å—ä½¿ç”¨ é€»è¾‘æ“ä½œç¬¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92  # ç­›é€‰æ–‡æ¡£ # é€»è¾‘æ“ä½œç¬¦æŸ¥è¯¢ $not åŒ¹é…ç­›é€‰æ¡ä»¶ä¸æˆç«‹çš„æ–‡æ¡£ $and åŒ¹é…å¤šä¸ªç­›é€‰æ¡ä»¶å…¨éƒ¨æˆç«‹çš„æ–‡æ¡£ $or åŒ¹é…è‡³å°‘ä¸€ä¸ªç­›é€‰æ¡ä»¶æˆç«‹çš„æ–‡æ¡£ $nor åŒ¹é…å¤šä¸ªç­›é€‰æ¡ä»¶å…¨éƒ¨ä¸æˆç«‹çš„æ–‡æ¡£ $not è¯­æ³•: { \u0026lt;field\u0026gt;: { $not: { \u0026lt;operator-expression\u0026gt; } } } # è¯»å–ä½™é¢ä¸å°äº200çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { balance: { $not: { $lt: 200 } } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } $and è¯­æ³•: { $and: [ { \u0026lt;expression1\u0026gt; }, { \u0026lt;expression2\u0026gt; }, ... ] } # è¯»å–ä½™é¢å¤§äº100å¹¶ä¸”ç”¨æˆ·å§“åæ’åœ¨ fred ä¹‹åçš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ $and: [ { balance: { $gt: 100 } }, { name: { $gt: \u0026#34;fred\u0026#34; } } ] }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # å½“ç­›é€‰æ¡ä»¶åº”ç”¨åœ¨ä¸åŒå­—æ®µä¸Šæ—¶ï¼Œå¯ä»¥çœç•¥ $and æ“ä½œç¬¦ \u0026gt; db.accounts.find( { balance: { $gt: 100 }, name: { $gt: \u0026#34;fred\u0026#34; } } ) å’Œä¸Šé¢çš„æŸ¥è¯¢æ•ˆæœç›¸åŒ # å½“ç­›é€‰æ¡ä»¶åº”ç”¨åœ¨åŒä¸€ä¸ªå­—æ®µä¸Šæ—¶ï¼Œä¹Ÿå¯ä»¥ç®€åŒ–å‘½ä»¤ # è¯»å–ä½™é¢å¤§äº100å¹¶ä¸”å°äº500çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ $and: [ { balance: { $gt: 100 } }, { balance: { $lt: 500 } } ] }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } \u0026gt; db.accounts.find( { balance: { $gt: 100, $lt: 500 } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } $or è¯­æ³•:(ä¸ $and ç±»ä¼¼) { $or: [ { \u0026lt;expression1\u0026gt; }, { \u0026lt;expression2\u0026gt; }, ... ] } # è¯»å–å±äº alice æˆ–è€… charlie çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ $or: [ { name: { $eq: \u0026#34;alice\u0026#34; } }, { name: { $eq: \u0026#34;charlie\u0026#34; } } ] }) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # å½“æ‰€æœ‰ç­›é€‰æ¡ä»¶ä½¿ç”¨çš„éƒ½æ˜¯ $eq æ“ä½œç¬¦æ—¶ï¼Œ$or å’Œ $in çš„æ•ˆæœæ˜¯ç›¸åŒçš„ \u0026gt; db.accounts.find( { name: { $in: [ \u0026#34;alice\u0026#34;, \u0026#34;charlie\u0026#34; ] } } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } # è¯»å–ä½™é¢å°äº100æˆ–è€…å¤§äº500çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ $or: [ { balance: { $lt: 100 } }, { balance: { $gt: 500 } } ] }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } $nor è¯­æ³•:(ä¸ $and ç±»ä¼¼) { $nor: [ { \u0026lt;expression1\u0026gt; }, { \u0026lt;expression2\u0026gt; }, ... ] } # è¯»å–ä¸å±äº alice å’Œ charlie ä¸”ä½™é¢ä¸å°äº100çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ $nor: [ { name: \u0026#34;alice\u0026#34; }, { name: \u0026#34;charlie\u0026#34; }, { balance: { $lt: 100 } } ] }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 }    æ³¨æ„: $not å’Œ $nor ä¹Ÿä¼šç­›é€‰å‡ºå¹¶ä¸åŒ…å«æŸ¥è¯¢å­—æ®µçš„æ–‡æ¡£å¯ä»¥é…åˆä¸‹é¢çš„ $exists æ“ä½œç¬¦ä¸€å—ä½¿ç”¨ å­—æ®µæ“ä½œç¬¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48  # ç­›é€‰æ–‡æ¡£ # å­—æ®µæ“ä½œç¬¦ $exists åŒ¹é…åŒ…å«æŸ¥è¯¢å­—æ®µçš„æ–‡æ¡£ $type åŒ¹é…å­—æ®µç±»å‹ç¬¦åˆæŸ¥è¯¢å€¼çš„æ–‡æ¡£ $exists è¯­æ³•: { \u0026lt;field\u0026gt;: { $exists: \u0026lt;boolean\u0026gt; } } # è¯»å–åŒ…å«è´¦æˆ·ç±»å‹å­—æ®µçš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { \u0026#34;_id.type\u0026#34;: { $exists: true } } ) { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } \u0026gt; db.accounts.find( { \u0026#34;_id.type\u0026#34;: { $ne: \u0026#34;alipay\u0026#34;, $exists: true } } ) { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } $type è¯­æ³•: { \u0026lt;field\u0026gt;: { $type: \u0026lt;BSON type\u0026gt; } } { \u0026lt;field\u0026gt;: { $type: [ \u0026lt;BSON type1\u0026gt;, \u0026lt;BSON type2\u0026gt;, ... ] } } # è¯»å–æ–‡æ¡£ä¸»é”®æ˜¯å­—ç¬¦ä¸²çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { _id: { $type: \u0026#34;string\u0026#34; } } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # è¯»å–æ–‡æ¡£ä¸»é”®æ˜¯å¯¹è±¡ä¸»é”®æˆ–è€…å¤åˆä¸»é”®çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { _id: { $type: [\u0026#34;objectId\u0026#34;, \u0026#34;object\u0026#34;] } } ) { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # è¯»å–ç”¨æˆ·å§“åæ˜¯ null çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $type: \u0026#34;null\u0026#34; } } ) é™¤äº†ä½¿ç”¨BSONç±»å‹åç§°ä½œä¸º $type æ“ä½œç¬¦çš„å‚æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨ç±»å‹åºå·ã€‚æ¯”å¦‚ \u0026gt; db.accounts.find( { _id: { $type: 2 } } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 }   æ•°ç»„æ“ä½œç¬¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60  # ç­›é€‰æ–‡æ¡£ # æ•°ç»„æ“ä½œç¬¦ $all åŒ¹é…æ•°ç»„å­—æ®µä¸­åŒ…å«æ‰€æœ‰æŸ¥è¯¢å€¼çš„æ–‡æ¡£ $elemMatch åŒ¹é…æ•°ç»„å­—æ®µä¸­è‡³å°‘å­˜åœ¨ä¸€ä¸ªå€¼æ»¡è¶³ç­›é€‰æ¡ä»¶çš„æ–‡æ¡£ $all è¯­æ³•: { \u0026lt;field\u0026gt;: { $all: [ \u0026lt;value1\u0026gt;, \u0026lt;value2\u0026gt;, ... ] } } # é¦–å…ˆï¼Œä¸ºäº†ç»ƒä¹ è¿™ä¸ªæ“ä½œç¬¦ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€äº›åŒ…å«æ•°ç»„å’ŒåµŒå¥—æ•°ç»„çš„æ–‡æ¡£ \u0026gt; db.accounts.insert([ { name: \u0026#34;jack\u0026#34;, balance: 2000, contact: [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] }, { name: \u0026#34;karen\u0026#34;, balance: 2500, contact: [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } ]) BulkWriteResult({ \u0026#34;writeErrors\u0026#34; : [ ], \u0026#34;writeConcernErrors\u0026#34; : [ ], \u0026#34;nInserted\u0026#34; : 2, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;nRemoved\u0026#34; : 0, \u0026#34;upserted\u0026#34; : [ ] }) # è¯»å–è”ç³»åœ°å€ä½äºä¸­å›½åŒ—äº¬çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { contact: { $all: [ \u0026#34;China\u0026#34;, \u0026#34;Beijing\u0026#34; ] } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } # è¯»å–è”ç³»ç”µè¯åŒ…å« 22222222 å’Œ 33333333 çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { contact: { $all: [ [\u0026#34;22222222\u0026#34;,\u0026#34;33333333\u0026#34;] ] } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } \u0026gt; db.accounts.find( { contact: { $all: [ [\u0026#34;33333333\u0026#34;,\u0026#34;22222222\u0026#34;] ] } } ) ä¸åŒ¹é…ä»»ä½•æ–‡æ¡£ $elemMatch è¯­æ³•: { \u0026lt;field\u0026gt;: { $elemMatch: { \u0026lt;query1\u0026gt;, \u0026lt;query2\u0026gt;, ... } } } # è¯»å–è”ç³»ç”µè¯èŒƒå›´åœ¨ 10000000 è‡³ 20000000 ä¹‹é—´çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { contact: { $elemMatch: { $gt: \u0026#34;10000000\u0026#34;, $lt: \u0026#34;20000000\u0026#34; } } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 2000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } # è¯»å–åŒ…å«ä¸€ä¸ªåœ¨ 10000000 è‡³ 20000000 ä¹‹é—´ï¼Œå’Œä¸€ä¸ªåœ¨ 20000000 è‡³ 30000000 ä¹‹é—´çš„è”ç³»ç”µè¯çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { contact: { $all: [ { $elemMatch: { $gt: \u0026#34;10000000\u0026#34;, $lt: \u0026#34;20000000\u0026#34; } }, { $elemMatch: { $gt: \u0026#34;20000000\u0026#34;, $lt: \u0026#34;30000000\u0026#34; } } ] } } )   è¿ç®—æ“ä½œç¬¦ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  # ç­›é€‰æ–‡æ¡£ # è¿ç®—æ“ä½œç¬¦ $regex åŒ¹é…æ»¡è¶³æ­£åˆ™è¡¨è¾¾å¼çš„æ–‡æ¡£ è¯­æ³•: { \u0026lt;field\u0026gt;: { $regex: /pattern/, $options: \u0026#34;\u0026lt;options\u0026gt;\u0026#34; } } # å¤§éƒ¨åˆ†åœºæ™¯ä½¿ç”¨è¯¥è¯­æ³• { \u0026lt;field\u0026gt;: /pattern/\u0026lt;options\u0026gt; } # ç‰¹å®šåœºæ™¯ä½¿ç”¨è¯¥è¯­æ³• å…¼å®¹ PCRE v8.41 æ­£åˆ™è¡¨è¾¾å¼åº“ åœ¨ä¸ $in æ“ä½œç¬¦é…åˆä½¿ç”¨æ—¶ï¼Œåªèƒ½ä½¿ç”¨ /pattern/\u0026lt;options\u0026gt; è¯­æ³• # è¯»å–ç”¨æˆ·å§“åä»¥ c æˆ–è€… j å¼€å¤´çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $in: [ /^c/, /^j/ ] } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 2000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } # è¯»å–ç”¨æˆ·å§“ååŒ…å« LIE (ä¸åŒºåˆ†å¤§å°å†™)çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: { $regex: /LIE/, $options: \u0026#39;i\u0026#39; } } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } \u0026gt; db.accounts.find( { name: /LIE/i } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 }   æ–‡æ¡£æ¸¸æ ‡ db.collection.find() è¿”å›çš„æ˜¯ä¸€ä¸ªæ–‡æ¡£é›†åˆæ¸¸æ ‡\nåœ¨ä¸è¿­ä»£æ¸¸æ ‡çš„æƒ…å†µä¸‹ï¼Œåªåˆ—å‡ºå‰20ä¸ªæ–‡æ¡£:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  \u0026gt; var myCursor = db.accounts.find(); \u0026gt; myCursor { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 2000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } // è¿™é‡Œç”±äºæˆ‘ä»¬çš„æ–‡æ¡£æ€»æ•°ä¸è¶³20ï¼Œæ‰€ä»¥çœ‹ä¸å‡ºæ•ˆæœ   æˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨æ¸¸æ ‡ä¸‹æ ‡ç›´æ¥è®¿é—®æ–‡æ¡£é›†åˆä¸­çš„æŸä¸€ä¸ªæ–‡æ¡£ï¼Œä¸‹æ ‡ä»0å¼€å§‹:\n1 2 3 4 5 6 7  \u0026gt; var myCursor = db.accounts.find(); \u0026gt; myCursor[1] { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 }   é»˜è®¤æƒ…å†µä¸‹ï¼Œéå†å®Œæ¸¸æ ‡ä¸­æ‰€æœ‰çš„æ–‡æ¡£ä¹‹åï¼Œæˆ–è€…åœ¨10åˆ†é’Ÿä¹‹åï¼Œæ¸¸æ ‡ä¾¿ä¼šè‡ªåŠ¨å…³é—­\næˆ‘ä»¬å¯ä»¥ä½¿ç”¨ noCursorTimeout() å‡½æ•°æ¥ä¿æŒæ¸¸æ ‡ä¸€ç›´æœ‰æ•ˆ\n1  \u0026gt; var myCursor = db.accounts.find().noCursorTimeout();   åœ¨è¿™ä¹‹åï¼Œå¦‚æœæˆ‘ä»¬éå†å®Œäº†æ¸¸æ ‡ï¼Œæ¸¸æ ‡ä¼šè‡ªåŠ¨å…³é—­ã€‚ä½†æ˜¯å¦‚æœåœ¨ä¸éå†æ¸¸æ ‡çš„æƒ…å†µä¸‹ï¼Œéœ€è¦ä¸»åŠ¨å…³é—­æ¸¸æ ‡\n1  \u0026gt; myCursor.close();   æ¸¸æ ‡å‡½æ•° 1 2 3 4 5 6 7  cursor.hasNext() cursor.next() cursor.forEach() cursor.limit() cursor.skip() cursor.count() cursor.sort()   hasNext å’Œ next å‡½æ•°  hasNext å’Œ next ç”¨äºéå†æ¸¸æ ‡\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  \u0026gt; var myCursor = db.accounts.find({ balance: 100 }); \u0026gt; while( myCursor.hasNext() ) { printjson(myCursor.next()); } { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 }   forEach å‡½æ•° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  \u0026gt; var myCursor = db.accounts.find({ balance: 100 }); \u0026gt; myCursor.forEach(printjson); { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 }   limit å’Œ skip å‡½æ•°  è¿™ä¸¤ä¸ªå‡½æ•°é€šå¸¸ç”¨äºåˆ†é¡µ\n 1 2 3 4 5 6 7 8  cursor.limit(\u0026lt;number\u0026gt;) cursor.skip(\u0026lt;offset\u0026gt;) \u0026gt; db.accounts.find({ balance: 100 }).limit(1) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } \u0026gt; db.accounts.find({ balance: 100 }).skip(1) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 }    é—®é¢˜: å¦‚æœä½¿ç”¨ cursor.limit(0) ä¼šè¿”å›ä»€ä¹ˆç»“æœå‘¢ï¼Ÿç­”æ¡ˆ:  1 2 3  { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 }    ä¸å¯¹æ¸¸æ ‡è¿›è¡Œä»»ä½•é™åˆ¶ï¼Œä¸ limit() ä»¥åŠä¸è¿›è¡Œè°ƒç”¨æ•ˆæœç›¸åŒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤è¿”å›å‰20ä¸ªæ–‡æ¡£ï¼Ÿ\n count å‡½æ•° 1  cursor.count(\u0026lt;applySkipLimit\u0026gt;)   é»˜è®¤æƒ…å†µä¸‹ï¼Œ\u0026lt;applySkipLimit\u0026gt; ä¸º falseï¼Œå³ cursor.count() ä¸ä¼šè€ƒè™‘ cursor.skip() å’Œ cursor.limit() çš„æ•ˆæœ\n1 2 3 4 5 6 7 8 9 10  \u0026gt; db.accounts.find({ balance: 100 }) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } \u0026gt; db.accounts.find({ balance: 100 }).limit(1).count() 3 \u0026gt; db.accounts.find({ balance: 100 }).limit(1).count(true) 1   1 2 3 4 5 6 7 8  # åœ¨ä¸æä¾›ç­›é€‰æ¡ä»¶æ—¶ï¼Œcursor.count() ä¼šä»é›†åˆçš„å…ƒæ•°æ® Metadata ä¸­å–å¾—ç»“æœï¼Œè€Œä¸ä¼šéå†é›†åˆ \u0026gt; db.accounts.find().count() 22 \u0026gt; db.accounts.count() 22 # å½“æ•°æ®åº“åˆ†å¸ƒå¼ç»“æ„è¾ƒä¸ºå¤æ‚æ—¶ï¼Œå…ƒæ•°æ®ä¸­çš„æ–‡æ¡£æ•°é‡å¯èƒ½ä¸å‡†ç¡® # åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåº”è¯¥é¿å…ä½¿ç”¨ä¸æä¾›ç­›é€‰æ¡ä»¶çš„ cursor.count() å‡½æ•°ï¼Œè€Œä½¿ç”¨èšåˆç®¡é“æ¥è®¡ç®—æ–‡æ¡£æ•°é‡   sort å‡½æ•° 1  cursor.sort(\u0026lt;document\u0026gt;)   è¿™é‡Œçš„ \u0026lt;document\u0026gt; å®šä¹‰äº†æ’åºçš„è¦æ±‚ï¼Œ{ field: ordering}\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  1è¡¨ç¤ºé€’å¢æ’åº -1è¡¨ç¤ºé€’å‡æ’åº # æŒ‰ç…§ä½™é¢ä»å¤§åˆ°å°ï¼Œç”¨æˆ·å§“åæŒ‰å­—æ¯æ’åºçš„æ–¹å¼æ’åˆ—é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find().sort( { balance: -1, name: 1 } ) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 2000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 500 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225972e77e7cb392a90f\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225b72e77e7cb392a910\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225c72e77e7cb392a911\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225d72e77e7cb392a912\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225d72e77e7cb392a913\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225e72e77e7cb392a914\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1226b72e77e7cb392a915\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1226b72e77e7cb392a916\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1226c72e77e7cb392a917\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1226d72e77e7cb392a918\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } Type \u0026#34;it\u0026#34; for more \u0026gt; it { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } # è¯»å–ä½™é¢æœ€å¤§çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find().sort({ balance: -1 }).limit(1) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] }    æ³¨æ„: cursor.skip(), cursor.limit(), cursor.sort()çš„æ‰§è¡Œé¡ºåºåŸåˆ™ä¸€: cursor.skip()æ°¸è¿œåœ¨cursor.limit()ä¹‹å‰æ‰§è¡Œ 1  \u0026gt; db.accounts.find().limit(5).skip(3)    ä»ä¹¦å†™é¡ºåºçœ‹ï¼Œæ˜¯å…ˆæ‰§è¡Œäº†limit(5)æ‹¿åˆ°5æ¡æ•°æ®ï¼Œç„¶åæ‰§è¡Œskip(3)è·³è¿‡3æ¡æ•°æ®ï¼Œç»“æœå°±å‰©2æ¡æ•°æ®äº†ã€‚ä½†æ˜¯æ‰§è¡Œç»“æœå¦‚ä¸‹ 1 2 3 4 5  { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;balance\u0026#34; : 1000 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 }    å®é™…æ‰§è¡Œé¡ºåºæ˜¯ï¼Œfind()æ‹¿åˆ°æ‰€æœ‰æ–‡æ¡£æ•°é‡ï¼Œskip(3)è·³è¿‡å‰3æ¡ï¼Œç„¶ålimit(5)å–å‡ºæ¥ä¸‹æ¥çš„5æ¡æ•°æ®åŸåˆ™äºŒ: cursor.sort()æ°¸è¿œåœ¨cursor.skip()å’Œcursor.limit()ä¹‹å‰æ‰§è¡Œ 1  \u0026gt; db.accounts.find().skip(3).limit(5).sort({ balance: -1 })    å…ˆæ‰§è¡Œsort({ balance: -1 })æŒ‰ç…§ä½™é¢é™åºæ’åºï¼Œç„¶åæ‰§è¡Œskip(3)è·³è¿‡å‰3æ¡ï¼Œæœ€åæ‰§è¡Œlimit(5)å–å‡ºæ¥ä¸‹æ¥çš„5æ¡æ•°æ®ä¸ db.accounts.find().limit(5).skip(3).sort({ balance: -1 })çš„ç»“æœç›¸åŒï¼Œä¸ç®¡ä¹¦å†™é¡ºåºå¦‚ä½•ï¼Œæ‰§è¡Œé¡ºåºæ°¸è¿œæ˜¯:sort() \u0026gt; skip() \u0026gt; limit() æ–‡æ¡£æŠ•å°„ 1  db.collection.find(\u0026lt;query\u0026gt;, \u0026lt;projection\u0026gt;)   ä¸ä½¿ç”¨æŠ•å°„æ—¶ï¼Œdb.collection.find()è¿”å›ç¬¦åˆç­›é€‰æ¡ä»¶çš„å®Œæ•´æ–‡æ¡£ï¼Œè€Œä½¿ç”¨æŠ•å°„å¯ä»¥æœ‰é€‰æ‹©æ€§çš„è¿”å›æ–‡æ¡£ä¸­çš„éƒ¨åˆ†å­—æ®µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  projection: { field: inclusion } 1 è¡¨ç¤ºè¿”å›è¯¥å­—æ®µ 0 è¡¨ç¤ºä¸è¿”å›è¯¥å­—æ®µ # åªè¿”å›é“¶è¡Œè´¦æˆ·æ–‡æ¡£ä¸­çš„ç”¨æˆ·å§“å \u0026gt; db.accounts.find({}, { name: 1 }) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } # åªè¿”å›é“¶è¡Œè´¦æˆ·æ–‡æ¡£ä¸­çš„ç”¨æˆ·å§“å(ä¸åŒ…å«æ–‡æ¡£ä¸»é”®) \u0026gt; db.accounts.find({}, { name: 1, _id: 0 }) { \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } # ä¸è¿”å›é“¶è¡Œè´¦æˆ·æ–‡æ¡£ä¸­çš„ç”¨æˆ·å§“å(ä¹Ÿä¸è¿”å›æ–‡æ¡£ä¸»é”®) \u0026gt; db.accounts.find({}, { name: 0, _id: 0 }) { \u0026#34;balance\u0026#34; : 100 } { \u0026#34;balance\u0026#34; : 200 } { \u0026#34;balance\u0026#34; : 100 } { \u0026#34;balance\u0026#34; : 500 } { \u0026#34;balance\u0026#34; : 2000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } { \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] }    æ³¨æ„: projectionå‚æ•°ä¸èƒ½æ··ç”¨åŒ…å«ä¸ä¸åŒ…å«è¿™ä¸¤ç§æŠ•å°„æ“ä½œï¼Œæ–‡æ¡£ä¸»é”®é™¤å¤– 1 2 3 4 5 6 7  \u0026gt; db.accounts.find({}, { name: 1, balance: 0, _id: 0 }) Error: error: { \u0026#34;ok\u0026#34; : 0, \u0026#34;errmsg\u0026#34; : \u0026#34;Projection cannot have a mix of inclusion and exclusion.\u0026#34;, \u0026#34;code\u0026#34; : 2, \u0026#34;codeName\u0026#34; : \u0026#34;BadValue\u0026#34; }   åœ¨æ•°ç»„å­—æ®µä¸Šä½¿ç”¨æŠ•å°„ $sliceæ“ä½œç¬¦å¯ä»¥è¿”å›æ•°ç»„å­—æ®µä¸­çš„éƒ¨åˆ†å…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44  # ä¸ä½¿ç”¨ slice æ“ä½œç¬¦ \u0026gt; db.accounts.find({}, { _id: 0, name: 1, contact: 1 }) { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } # è¿”å› contact å­—æ®µçš„ç¬¬ä¸€ä¸ªå…ƒç´  \u0026gt; db.accounts.find({}, { _id: 0, name: 1, contact: { $slice: 1 } }) { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34; ] } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ] ] } # è¿”å› contact å­—æ®µæœ€åä¸€ä¸ªå…ƒç´  \u0026gt; db.accounts.find({}, { _id: 0, name: 1, contact: { $slice: -1 } }) { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;US\u0026#34; ] } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;China\u0026#34; ] } # è¿”å› contact å­—æ®µçš„æœ€åä¸¤ä¸ªå…ƒç´  \u0026gt; db.accounts.find({}, { _id: 0, name: 1, contact: { $slice: -2 } }) { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] } # å¯¹ contact å­—æ®µå…ˆæ‰§è¡Œä¸€ä¸ª skip(1) æ“ä½œï¼Œç„¶åæ‰§è¡Œ limit(2) æ“ä½œ \u0026gt; db.accounts.find({}, { _id: 0, name: 1, contact: { $slice: [1, 2] } }) { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34; ] }   $elemMatchå’Œ$æ“ä½œç¬¦å¯ä»¥è¿”å›æ•°ç»„å­—æ®µä¸­ï¼Œæ»¡è¶³ç­›é€‰æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  # è¿”å› contact ä¸­å¤§äº Alabama çš„ç¬¬ä¸€ä¸ªå…ƒç´  \u0026gt; db.accounts.find({}, { _id: 0, name: 1, contact: { $elemMatch: { $gt: \u0026#34;Alabama\u0026#34; } } }) { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;US\u0026#34; ] } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;Beijing\u0026#34; ] } # ä½¿ç”¨\u0026lt;query\u0026gt;å‚æ•°ä¸­ contact çš„ç­›é€‰æ¡ä»¶ä½œä¸º projection ä¸­ contact çš„æŠ•å°„æ“ä½œ # æ˜¯ä¸Šé¢ $elemMatch çš„ç®€å†™å½¢å¼ \u0026gt; db.accounts.find({ contact: { $gt: \u0026#34;Alabama\u0026#34; } }, { _id: 0, name: 1, \u0026#34;contact.$\u0026#34;: 1 # contact: { $elemMatch: { $gt: \u0026#34;Alabama\u0026#34; } } çš„ç®€å†™å½¢å¼ï¼Ÿ })    ï¼Ÿç–‘é—® 1  \u0026gt; db.accounts.find({ contact: { $gt: \u0026#34;Alabama\u0026#34; } })    æ˜¯æŸ¥è¯¢å‡ºcontactå­—æ®µå¤§äºå­—ç¬¦ä¸²Alabamaçš„æ–‡æ¡£ï¼Œä½†æ˜¯contactæ˜¯æ•°ç»„ç±»å‹ï¼Œæ•°ç»„æ˜¯å¦‚ä½•ä¸å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ“ä½œçš„ï¼Ÿ\n æ›´æ–°æ–‡æ¡£ Â¶ 1 2 3 4 5 6 7 8  è¯­æ³•: db.\u0026lt;collection\u0026gt;.update(\u0026lt;query\u0026gt;, \u0026lt;update\u0026gt;, \u0026lt;options\u0026gt;) # \u0026lt;query\u0026gt; æ–‡æ¡£å®šä¹‰äº†æ›´æ–°æ–‡æ¡£æ—¶ç­›é€‰æ–‡æ¡£çš„æ¡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦æ›´æ–°å“ªäº›æ–‡æ¡£ # ä¸ db.collection.find() ä¸­çš„ query ç›¸åŒ # \u0026lt;update\u0026gt; æ–‡æ¡£æä¾›äº†æ›´æ–°çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦è¿›è¡Œä»€ä¹ˆæ ·çš„æ›´æ–° # \u0026lt;options\u0026gt; æ–‡æ¡£å£°æ˜äº†ä¸€äº›åº”ç”¨äºæ›´æ–°æ“ä½œçš„é€‰é¡¹å’Œå‚æ•°   æ›´æ–°æ•´ç¯‡æ–‡æ¡£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14  # å¦‚æœ \u0026lt;update\u0026gt; æ–‡æ¡£ä¸åŒ…å«ä»»ä½•æ›´æ–°æ“ä½œç¬¦ï¼Œåˆ™ä¼šæ›´æ–°æ•´ä¸ªæ–‡æ¡£ã€‚ # æ‰§è¡Œçš„æ˜¯æ›¿æ¢æ“ä½œ # æ£€æŸ¥ alice çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;alice\u0026#34; }) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # å°† alice çš„è´¦æˆ·ä½™é¢æ›´æ”¹ä¸º123 \u0026gt; db.accounts.update({ name: \u0026#34;alice\u0026#34; }, { name: \u0026#34;alice\u0026#34;, balance: 123 }) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æ£€æŸ¥ alice çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;alice\u0026#34; }) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 123 }    æ³¨æ„: ç¬¬ä¸€ï¼Œæ–‡æ¡£ä¸»é”® _id åœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯ä¸å¯ä»¥æ›´æ”¹çš„å¦‚æœæˆ‘ä»¬åœ¨ \u0026lt;update\u0026gt;æ–‡æ¡£ä¸­åŒ…å«_idå­—æ®µï¼Œåˆ™_idå€¼ä¸€å®šè¦å’Œè¢«æ›´æ–°æ–‡æ¡£çš„_idå€¼ä¿æŒä¸€è‡´ 1 2  \u0026gt; db.accounts.update({ name: \u0026#34;alice\u0026#34; }, { _id: \u0026#34;account1\u0026#34;, name: \u0026#34;alice\u0026#34;, balance: 100 }) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 })    å¦‚æœ\u0026lt;update\u0026gt;æ–‡æ¡£ä¸­åŒ…å«çš„_idå­—æ®µå’Œè¢«æ›´æ–°çš„æ–‡æ¡£_idå€¼ä¸ä¸€è‡´ï¼Œåˆ™ä¼šæ›´æ–°å¤±è´¥ 1 2 3 4 5 6 7 8 9 10  \u0026gt; db.accounts.update({ name: \u0026#34;alice\u0026#34; }, { _id: \u0026#34;account2\u0026#34;, name: \u0026#34;alice\u0026#34;, balance: 123 }) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;writeError\u0026#34; : { \u0026#34;code\u0026#34; : 66, \u0026#34;errmsg\u0026#34; : \u0026#34;After applying the update, the (immutable) field \u0026#39;_id\u0026#39; was found to have been altered to _id: \\\u0026#34;account2\\\u0026#34;\u0026#34; } })    ç¬¬äºŒï¼Œåœ¨ä½¿ç”¨\u0026lt;update\u0026gt;æ–‡æ¡£æ›¿æ¢æ•´ç¯‡è¢«æ›´æ–°æ–‡æ¡£æ—¶ï¼Œåªæœ‰ç¬¬ä¸€ç¯‡ç¬¦åˆ\u0026lt;query\u0026gt;ç­›é€‰æ¡ä»¶çš„æ–‡æ¡£æ‰ä¼šè¢«æ›´æ–°\n 1 2 3 4 5 6 7 8 9 10 11 12 13  # æŸ¥çœ‹è´¦æˆ·ä½™é¢åœ¨0åˆ°100ä¹‹é—´çš„è´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ balance: { $gt: 0, $lt: 100 } }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bob\u0026#34;, \u0026#34;balance\u0026#34; : 50 } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } # æ›´æ–°è´¦æˆ·ä½™é¢åœ¨0åˆ°100ä¹‹é—´çš„è´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.update({ balance: { $gt: 0, $lt: 100 } }, { name: \u0026#34;bill\u0026#34;, balance: 80, gender: \u0026#34;M\u0026#34; } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹è´¦æˆ·ä½™é¢åœ¨0åˆ°100ä¹‹é—´çš„è´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ balance: { $gt: 0, $lt: 100 } }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bill\u0026#34;, \u0026#34;balance\u0026#34; : 80, \u0026#34;gender\u0026#34; : \u0026#34;M\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 }    ä¹Ÿå°±æ˜¯è¯´ï¼Œæ›´æ–°æ•´ç¯‡æ–‡æ¡£çš„æ“ä½œï¼Œåªèƒ½åº”ç”¨åœ¨å•ä¸€æ–‡æ¡£ä¸Š\n æ›´æ–°ç‰¹å®šå­—æ®µ å¦‚æœ\u0026lt;update\u0026gt;æ–‡æ¡£åªåŒ…å«æ›´æ–°æ“ä½œç¬¦ï¼Œdb.collection.update()å°†ä¼šä½¿ç”¨\u0026lt;update\u0026gt;æ–‡æ¡£æ›´æ–°é›†åˆä¸­ç¬¦åˆ\u0026lt;query\u0026gt;ç­›é€‰æ¡ä»¶çš„æ‰€æœ‰æ–‡æ¡£ä¸­çš„ç‰¹å®šå­—æ®µ\n1 2 3 4 5 6 7 8 9  # æ–‡æ¡£æ›´æ–°æ“ä½œç¬¦ $set æ›´æ–°æˆ–æ–°å¢å­—æ®µ $unset åˆ é™¤å­—æ®µ $rename é‡å‘½åå­—æ®µ $inc åŠ å‡å­—æ®µå€¼ $mul ç›¸ä¹˜å­—æ®µå€¼ $min æ¯”è¾ƒå‡å°å­—æ®µå€¼ $max æ¯”è¾ƒå¢å¤§å­—æ®µå€¼   $setæ“ä½œç¬¦ æ›´æ–°æˆ–æ–°å¢å­—æ®µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173  è¯­æ³•: { $set: { \u0026lt;field1\u0026gt;: \u0026lt;value1\u0026gt;, \u0026lt;field2\u0026gt;: \u0026lt;value2\u0026gt;, ... } } # æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 2000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ] } # æ›´æ–° jack çš„é“¶è¡Œè´¦æˆ·ä½™é¢å’Œå¼€æˆ·ä¿¡æ¯ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $set: { balance: 3000, info: { dateOpened: new Date(\u0026#34;2019-05-18T16:00:00Z\u0026#34;), branch: \u0026#34;branch1\u0026#34; } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 3000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2019-05-18T16:00:00Z\u0026#34;), \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } } ## æ›´æ–°æˆ–æ–°å¢å†…åµŒæ–‡æ¡£çš„å­—æ®µ # æ›´æ–° jack çš„é“¶è¡Œè´¦æˆ·çš„å¼€æˆ·æ—¶é—´ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $set: { \u0026#34;info.dateOpened\u0026#34;: new Date(\u0026#34;2017-01-01T16:00:00Z\u0026#34;) } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 3000, \u0026#34;contact\u0026#34; : [ \u0026#34;11111111\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } } ## æ›´æ–°æˆ–æ–°å¢æ•°ç»„å†…çš„å…ƒç´  # æ›´æ–° jack çš„è”ç³»ç”µè¯ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $set: { \u0026#34;contact.0\u0026#34;: \u0026#34;66666666\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 3000, \u0026#34;contact\u0026#34; : [ \u0026#34;66666666\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } } # æ·»åŠ  jack çš„è”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $set: { \u0026#34;contact.3\u0026#34;: \u0026#34;new contact\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 3000, \u0026#34;contact\u0026#34; : [ \u0026#34;66666666\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34;, \u0026#34;new contact\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } } # æ•°ç»„ç´¢å¼•å¯ä»¥éšä¾¿è®¾ç½® \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $set: { \u0026#34;contact.10\u0026#34;: \u0026#34;new contact 10\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;balance\u0026#34; : 3000, \u0026#34;contact\u0026#34; : [ \u0026#34;66666666\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34;, \u0026#34;new contact\u0026#34;, null, null, null, null, null, null, \u0026#34;new contact10\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } }    æ³¨æ„: å¦‚æœå‘ç°æœ‰æ•°ç»„å­—æ®µèŒƒå›´ä»¥å¤–çš„ä½ç½®æ·»åŠ æ–°å€¼ï¼Œæ•°ç»„å­—æ®µçš„é•¿åº¦ä¼šæ‰©å¤§ï¼Œæœªè¢«èµ‹å€¼çš„æ•°ç»„æˆå‘˜å°†è¢«è®¾ç½®ä¸ºnull\n $unset æ“ä½œç¬¦ åˆ é™¤å­—æ®µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74  è¯­æ³•: { $unset: { \u0026lt;field1\u0026gt;: \u0026#34;\u0026#34;, \u0026lt;field2\u0026gt;: \u0026#34;\u0026#34;, ... } } # åˆ é™¤ jack çš„é“¶è¡Œè´¦æˆ·ä½™é¢å’Œå¼€æˆ·åœ°ç‚¹ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $unset: { balance: \u0026#34;\u0026#34;, \u0026#34;info.branch\u0026#34;: \u0026#34;\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;66666666\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34;, \u0026#34;new contact2\u0026#34;, null, null, null, null, null, null, \u0026#34;new contact10\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;) } } ## åˆ é™¤æ•°ç»„å†…çš„å­—æ®µ # åˆ é™¤ jack çš„è”ç³»ç”µè¯ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $unset: { \u0026#34;contact.0\u0026#34;: \u0026#34;\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ null, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34;, \u0026#34;new contact2\u0026#34;, null, null, null, null, null, null, \u0026#34;new contact10\u0026#34; ], \u0026#34;info\u0026#34; : { } }    æ³¨æ„: $unsetæ“ä½œç¬¦ä¸­çš„èµ‹å€¼(\u0026quot;\u0026quot;)å¯¹æ“ä½œç»“æœå¹¶æ²¡æœ‰ä»»ä½•å½±å“\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33  # åˆ é™¤ jack çš„é“¶è¡Œå¼€æˆ·æ—¶é—´ \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $unset: { \u0026#34;info.dateOpened\u0026#34;: \u0026#34;this can be any value\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å†æ¬¡æŸ¥çœ‹ jack çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;contact\u0026#34; : [ \u0026#34;66666666\u0026#34;, \u0026#34;Alabama\u0026#34;, \u0026#34;US\u0026#34;, \u0026#34;new contact2\u0026#34;, null, null, null, null, null, null, \u0026#34;new contact10\u0026#34; ], \u0026#34;info\u0026#34; : { } }    å¦‚æœ$unsetå‘½ä»¤ä¸­çš„å­—æ®µæ ¹æœ¬ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæ–‡æ¡£å†…å®¹å°†ä¿æŒä¸å˜ 1 2 3 4 5 6 7 8 9  \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $unset: { notExist: \u0026#34;\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 })    å½“ä½¿ç”¨$unsetå‘½ä»¤åˆ é™¤æ•°ç»„å­—æ®µä¸­çš„æŸä¸€ä¸ªå…ƒç´ æ—¶ï¼Œè¿™ä¸ªå…ƒç´ ä¸ä¼šè¢«åˆ é™¤ï¼Œåªä¼šè¢«èµ‹ä»¥nullå€¼ï¼Œè€Œæ•°ç»„çš„é•¿åº¦ä¸ä¼šæ”¹å˜\n $rename æ“ä½œç¬¦ é‡å‘½åå­—æ®µ\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123  è¯­æ³•: { $rename: { \u0026lt;field1\u0026gt;: \u0026lt;newName1\u0026gt;, \u0026lt;field2\u0026gt;: \u0026lt;newName2\u0026gt;, ... } } ## é‡å‘½åå†…åµŒæ–‡æ¡£çš„å­—æ®µ # æ›´æ–° karen çš„é“¶è¡Œè´¦æˆ·çš„å¼€æˆ·æ—¶é—´å’Œè”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $set: { info: { dateOpened: new Date(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), branch: \u0026#34;branch1\u0026#34; }, \u0026#34;contact.3\u0026#34;: { primaryEmail: \u0026#34;xxx@gmail.com\u0026#34;, secondaryEmail: \u0026#34;yyy@gmail.com\u0026#34; } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;karen\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;balance\u0026#34; : 2500, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; } ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } } # æ›´æ–°è´¦æˆ·ä½™é¢å’Œå¼€æˆ·åœ°ç‚¹å­—æ®µåœ¨æ–‡æ¡£ä¸­çš„ä½ç½® \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $rename: { \u0026#34;info.branch\u0026#34;: \u0026#34;branch\u0026#34;, \u0026#34;balance\u0026#34;: \u0026#34;info.balance\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;karen\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; } ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : 2500 }, \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34; } ## é‡å‘½åæ•°ç»„ä¸­å†…åµŒæ–‡æ¡£çš„å­—æ®µ # æ›´æ–° karen çš„è”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $rename: { \u0026#34;contact.3.primaryEmail\u0026#34;: \u0026#34;primaryEmail\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;writeError\u0026#34; : { \u0026#34;code\u0026#34; : 2, \u0026#34;errmsg\u0026#34; : \u0026#34;The source field cannot be an array element, \u0026#39;contact.3.primaryEmail\u0026#39; in doc with _id: ObjectId(\u0026#39;5ce1107d72e77e7cb392a90e\u0026#39;) has an array field called \u0026#39;contact\u0026#39;\u0026#34; } }) # åå‘æ“ä½œ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $rename: { \u0026#34;branch\u0026#34;: \u0026#34;contact.3.branch\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;writeError\u0026#34; : { \u0026#34;code\u0026#34; : 2, \u0026#34;errmsg\u0026#34; : \u0026#34;The destination field cannot be an array element, \u0026#39;contact.3.branch\u0026#39; in doc with _id: ObjectId(\u0026#39;5ce1107d72e77e7cb392a90e\u0026#39;) has an array field called \u0026#39;contact\u0026#39;\u0026#34; } })    æ³¨æ„: å¦‚æœ$renameå‘½ä»¤è¦é‡å‘½åçš„å­—æ®µåœ¨æ–‡æ¡£ä¸­å¹¶ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆæ–‡æ¡£å†…å®¹ä¸ä¼šå‘ç”Ÿä»»ä½•æ”¹å˜\n 1 2 3 4 5 6 7 8 9  \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $rename: { notExist: \u0026#34;name\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 })    å¦‚æœæ–°çš„å­—æ®µåå·²ç»å­˜åœ¨ï¼Œé‚£ä¹ˆåŸæœ‰çš„è¿™ä¸ªå­—æ®µä¼šè¢«è¦†ç›–\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  \u0026gt; db.accounts.update( { name: \u0026#34;jack\u0026#34; }, { $rename: { name: \u0026#34;contact\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) \u0026gt; db.accounts.find({ name: \u0026#34;jack\u0026#34; }).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;), \u0026#34;contact\u0026#34; : \u0026#34;jack\u0026#34;, \u0026#34;info\u0026#34; : { } # åŸæ¥çš„ contact å†…å®¹ä¸è§äº†!!! }    å½“$renameå‘½ä»¤ä¸­çš„æ–°å­—æ®µå­˜åœ¨çš„æ—¶å€™ï¼Œ$renameå‘½ä»¤ä¼šå…ˆ$unsetæ–°æ—§å­—æ®µï¼Œç„¶åå†$setæ–°å­—æ®µ$renameå‘½ä»¤ä¸­çš„æ—§å­—æ®µå’Œæ–°å­—æ®µéƒ½ä¸å¯ä»¥æŒ‡å‘æ•°ç»„å…ƒç´  $inc å’Œ $mul æ“ä½œç¬¦ æ›´æ–°å­—æ®µå€¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37  è¯­æ³•: { $inc: { \u0026lt;field1\u0026gt;: \u0026lt;amount1\u0026gt;, ... } } { $mul: { \u0026lt;field1\u0026gt;: \u0026lt;amount1\u0026gt;, ... } } # æŸ¥çœ‹ david çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;david\u0026#34; }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 200 } # æ›´æ–° david çš„è´¦æˆ·ä½™é¢ \u0026gt; db.accounts.update( { name: \u0026#34;david\u0026#34; }, { $inc: { balance: -0.5 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ david çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;david\u0026#34; }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 199.5 } # æ›´æ–° david çš„è´¦æˆ·ä½™é¢ \u0026gt; db.accounts.update( { name: \u0026#34;david\u0026#34; }, { $mul: { balance: 0.5 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ david çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;david\u0026#34; }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 99.75 }    æ³¨æ„: $incå’Œ$mulå‘½ä»¤åªèƒ½åº”ç”¨åœ¨æ•°å­—å­—æ®µä¸Š\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  \u0026gt; db.accounts.update( { name: \u0026#34;david\u0026#34; }, { $inc: { name: -0.5 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;writeError\u0026#34; : { \u0026#34;code\u0026#34; : 14, \u0026#34;errmsg\u0026#34; : \u0026#34;Cannot apply $incto a value of non-numeric type. {_id: ObjectId(\u0026#39;5ce00d5972e77e7cb392a8ff\u0026#39;)} has the field \u0026#39;name\u0026#39; of non-numeric type string\u0026#34; } })    å¦‚æœè¢«$incæˆ–$mulæ›´æ–°çš„å­—æ®µä¸å­˜åœ¨ã€‚ã€‚ã€‚\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25  \u0026gt; db.accounts.update( { name: \u0026#34;david\u0026#34; }, { $inc: { notYetExist: 10 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) \u0026gt; db.accounts.find({ name: \u0026#34;david\u0026#34; }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 99.75, \u0026#34;notYetExist\u0026#34; : 10 } \u0026gt; db.accounts.update( { name: \u0026#34;david\u0026#34; }, { $mul: { notYetExistEither: 20 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) \u0026gt; db.accounts.find({ name: \u0026#34;david\u0026#34; }) { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 99.75, \u0026#34;notYetExist\u0026#34; : 10, \u0026#34;notYetExistEither\u0026#34; : 0 }   $min å’Œ $max æ“ä½œç¬¦ æ¯”è¾ƒä¹‹åæ›´æ–°å­—æ®µå€¼\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77  è¯­æ³•: { $min: { \u0026lt;field1\u0026gt;: \u0026lt;value1\u0026gt;, ... } } { $max: { \u0026lt;field1\u0026gt;: \u0026lt;value1\u0026gt;, ... } } # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, info: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : 2500 } } # æ›´æ–° karen çš„è´¦æˆ·ä½™é¢ # æ¯”è¾ƒ info.balance å­—æ®µåŸæœ¬çš„å­—æ®µå€¼ä¸5000çš„å¤§å°ï¼ŒæŠŠè¿™ä¸¤è€…ä¸­è¾ƒå°çš„ä¿ç•™ï¼Œä½œä¸º info.balance å­—æ®µçš„å€¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $min: { \u0026#34;info.balance\u0026#34;: 5000 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 }) # æ›´æ–° karen çš„è´¦æˆ·ä½™é¢ # æ¯”è¾ƒ info.balance å­—æ®µåŸæœ¬çš„å­—æ®µå€¼ä¸5000çš„å¤§å°ï¼ŒæŠŠè¿™ä¸¤è€…ä¸­è¾ƒå¤§çš„ä¿ç•™ï¼Œä½œä¸º info.balance å­—æ®µçš„å€¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $max: { \u0026#34;info.balance\u0026#34;: 5000 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, info: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2017-01-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : 5000 } } # æ›´æ–° karen çš„å¼€æˆ·æ—¶é—´ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $min: { \u0026#34;info.dateOpened\u0026#34;: new Date(\u0026#34;2013-10-01T16:00:00Z\u0026#34;) } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, info: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2013-10-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : 5000 } }    æ³¨æ„: å¦‚æœè¢«æ›´æ–°çš„å­—æ®µä¸å­˜åœ¨ã€‚ã€‚ã€‚\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $min: { notYetExist: 10 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ kaven çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, info: 1, notYetExist: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2013-10-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : 5000 }, \u0026#34;notYetExist\u0026#34; : 10 }    å¦‚æœè¢«æ›´æ–°çš„å­—æ®µä¸å­˜åœ¨ï¼Œ$minå’Œ$maxå‘½ä»¤ä¼šåˆ›å»ºå­—æ®µï¼Œå¹¶ä¸”å°†å­—æ®µå€¼è®¾ç½®ä¸ºå‘½ä»¤ä¸­çš„æ›´æ–°å€¼å¦‚æœè¢«æ›´æ–°çš„å­—æ®µç±»å‹å’Œæ›´æ–°å€¼ç±»å‹ä¸ä¸€è‡´ã€‚ã€‚ã€‚\n 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23  \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $min: { \u0026#34;info.balance\u0026#34;: null } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, info: 1, notYetExist: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2013-10-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : null }, \u0026#34;notYetExist\u0026#34; : 10 }    å¦‚æœè¢«æ›´æ–°çš„å­—æ®µç±»å‹å’Œæ›´æ–°å€¼ç±»å‹ä¸ä¸€è‡´ï¼Œ$minå’Œ$maxå‘½ä»¤ä¼šæŒ‰ç…§BSONæ•°æ®ç±»å‹æ’åºè§„åˆ™è¿›è¡Œæ¯”è¾ƒ 1 2 3 4 5 6 7 8 9 10 11 12 13  (æœ€å°) Null Numbers (ints, longs, doubles, decimals) Symbol, String Object Array BinData ObjectId Boolean Date Timestamp Regular Expression (æœ€å¤§)   æ•°ç»„æ›´æ–°æ“ä½œç¬¦ 1 2 3 4 5  $addToSet å‘æ•°ç»„ä¸­å¢æ·»å…ƒç´  $pop ä»æ•°ç»„ä¸­ç§»é™¤å…ƒç´  $pull ä»æ•°ç»„ä¸­æœ‰é€‰æ‹©æ€§åœ°ç§»é™¤å…ƒç´  $pullAll ä»æ•°ç»„ä¸­æœ‰é€‰æ‹©æ€§åœ°ç§»é™¤å…ƒç´  $push å‘æ•°ç»„ä¸­å¢æ·»å…ƒç´    $addToSet æ“ä½œç¬¦ å‘æ•°ç»„å­—æ®µä¸­æ·»åŠ å…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34  è¯­æ³•: { $addToSet: { \u0026lt;field1\u0026gt;: \u0026lt;value1\u0026gt;, ... } } # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; } ] } # å‘ karen çš„è´¦æˆ·æ–‡æ¡£ä¸­æ·»åŠ è”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $addToSet: { contact: \u0026#34;China\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 })    æ³¨æ„: å¦‚æœè¦æ’å…¥çš„å€¼å·²ç»å­˜åœ¨æ•°ç»„å­—æ®µä¸­ï¼Œåˆ™$addToSetä¸ä¼šå†æ·»åŠ é‡å¤å€¼æ³¨æ„ä¸€ä¸‹ï¼Œä½¿ç”¨$addToSetæ’å…¥æ•°ç»„å’Œæ–‡æ¡£æ—¶ï¼Œæ’å…¥å€¼ä¸­çš„å­—æ®µé¡ºåºä¹Ÿå’Œå·²æœ‰å€¼é‡å¤çš„æ—¶å€™ï¼Œæ‰è¢«ç®—ä½œé‡å¤å€¼è¢«å¿½ç•¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127  # å‘ karen çš„è´¦æˆ·æ–‡æ¡£ä¸­æ·»åŠ æ–°çš„è”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $addToSet: { contact: { \u0026#34;secondaryEmail\u0026#34;: \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34;: \u0026#34;xxx@gmail.com\u0026#34; } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; } ] } ## å‘æ•°ç»„å­—æ®µä¸­æ·»åŠ å¤šä¸ªå€¼ # å‘ karen çš„è´¦æˆ·æ–‡æ¡£ä¸­æ·»åŠ å¤šä¸ªè”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $addToSet: { contact: [ \u0026#34;contact1\u0026#34;, \u0026#34;contact2\u0026#34; ] } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ \u0026#34;contact1\u0026#34;, \u0026#34;contact2\u0026#34; ] ] } #ç”±æ­¤å¯è§ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ$addToSet ä¼šå°†æ•°ç»„æ’å…¥è¢«æ›´æ–°çš„æ•°ç»„å­—æ®µä¸­ï¼Œæˆä¸ºå†…åµŒæ•°ç»„ #å¦‚æœæƒ³è¦å°†å¤šä¸ªå…ƒç´ ç›´æ¥æ·»åŠ åˆ°æ•°ç»„å­—æ®µä¸­ï¼Œåˆ™éœ€è¦ä½¿ç”¨ $each æ“ä½œç¬¦ # å‘ karen çš„è´¦æˆ·æ–‡æ¡£ä¸­æ·»åŠ å¤šä¸ªè”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $addToSet: { contact: { $each: [ \u0026#34;contact1\u0026#34;, \u0026#34;contact2\u0026#34; ] } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ \u0026#34;contact1\u0026#34;, \u0026#34;contact2\u0026#34; ], \u0026#34;contact1\u0026#34;, \u0026#34;contact2\u0026#34; ] }   $pop æ“ä½œç¬¦ ä»æ•°ç»„å­—æ®µä¸­åˆ é™¤å…ƒç´ (åªèƒ½åˆ é™¤æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªæˆ–è€…æœ€åä¸€ä¸ªå…ƒç´ )\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121  è¯­æ³•: { $pop: { \u0026lt;field\u0026gt;: \u0026lt;-1 | 1\u0026gt;, ... } } # ä» karen çš„è´¦æˆ·æ–‡æ¡£ä¸­åˆ é™¤æœ€åä¸€ä¸ªè”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pop: { contact: 1 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ \u0026#34;contact1\u0026#34;, \u0026#34;contact2\u0026#34; ], \u0026#34;contact1\u0026#34; ] } # ä» karen çš„è´¦æˆ·æ–‡æ¡£ä¸­åˆ é™¤ç¬¬ä¸€ä¸ªè”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pop: { \u0026#34;contact.5\u0026#34;: -1 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ \u0026#34;contact2\u0026#34; ], \u0026#34;contact1\u0026#34; ] } # ç»§ç»­ä» karen çš„è´¦æˆ·æ–‡æ¡£ä¸­åˆ é™¤è”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pop: { \u0026#34;contact.5\u0026#34;: -1 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ] }    æ³¨æ„: åˆ é™¤æ‰æ•°ç»„ä¸­æœ€åä¸€ä¸ªå…ƒç´ åï¼Œä¼šç•™ä¸‹ç©ºæ•°ç»„$popæ“ä½œç¬¦åªèƒ½åº”ç”¨åœ¨æ•°ç»„å­—æ®µä¸Š 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pop: { \u0026#34;contact.1\u0026#34;: -1 } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0, \u0026#34;writeError\u0026#34; : { \u0026#34;code\u0026#34; : 14, \u0026#34;errmsg\u0026#34; : \u0026#34;Path \u0026#39;contact.1\u0026#39; contains an element of non-array type \u0026#39;string\u0026#39;\u0026#34; } })   $pull æ“ä½œç¬¦ ä»æ•°ç»„å­—æ®µä¸­åˆ é™¤ç‰¹å®šå…ƒç´ (çµæ´»æ€§æ¯”$popå¼º)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130  è¯­æ³•: { $pull: { \u0026lt;field1\u0026gt;: \u0026lt;value | condition\u0026gt;, ... } } # ä¸ºäº†æ¼”ç¤ºæ–¹ä¾¿ï¼Œé¦–å…ˆå°† karen çš„è´¦æˆ·æ–‡æ¡£å¤åˆ¶æˆä¸ºä¸€ç¯‡æ–°æ–‡æ¡£ï¼Œå¹¶ä¸”æŠŠæ–°æ–‡æ¡£çš„ç”¨æˆ·å§“åè®¾ç½®ä¸º lawrence \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { _id: 0 } ).forEach(doc =\u0026gt; { var newDoc = doc; newDoc.name = \u0026#34;lawrence\u0026#34;; db.accounts.insert(newDoc); }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; } ).pretty() { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce188c687c9a4c5934a9550\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ], \u0026#34;info\u0026#34; : { \u0026#34;dateOpened\u0026#34; : ISODate(\u0026#34;2013-10-01T16:00:00Z\u0026#34;), \u0026#34;balance\u0026#34; : null }, \u0026#34;branch\u0026#34; : \u0026#34;branch1\u0026#34;, \u0026#34;notYetExist\u0026#34; : 10 } # ä» karen çš„è”ç³»æ–¹å¼ä¸­åˆ é™¤åŒ…å« \u0026#39;hi\u0026#39; å­—æ¯çš„å…ƒç´  # æƒ³ä¸€æƒ³ï¼Œæ—¢ç„¶æ˜¯é’ˆå¯¹æ•°ç»„å…ƒç´ çš„ç­›é€‰æ¡ä»¶ï¼Œæ˜¯å¦éœ€è¦ä½¿ç”¨ $elemMatch æ“ä½œç¬¦å‘¢ï¼Ÿ \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pull: { contact: { $elemMatch: { $regex: /hi/ } } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 }) # äº‹å®ä¸Šï¼Œæ—¢ç„¶ $pull æ“ä½œç¬¦æœ¬èº«æ˜¯åªèƒ½ä½œç”¨åœ¨æ•°ç»„å…ƒç´ ä¸Šçš„ï¼Œæˆ‘ä»¬ä¾¿ä¸éœ€è¦å†é¢å¤–ä½¿ç”¨ $elemMatch æ“ä½œç¬¦äº† \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pull: { contact: { $regex: /hi/ } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { contact: 1, _id: 0 } ).pretty() { \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ] } # å½“ç„¶ï¼Œå¦‚æœæœ‰æ•°ç»„å…ƒç´ æœ¬èº«å°±æ˜¯ä¸€ä¸ªå†…åµŒæ•°ç»„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨ $elemMatch æ¥å¯¹è¿™äº›å†…åµŒæ•°ç»„è¿›è¡Œç­›é€‰ # ä» karen çš„è”ç³»æ–¹å¼ä¸­åˆ é™¤ç”µè¯å·ç  22222222 \u0026gt; db.accounts.update( { name: \u0026#34;karen\u0026#34; }, { $pull: { contact: { $elemMatch: { $eq: \u0026#34;22222222\u0026#34; }} } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ karen çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;karen\u0026#34; }, { contact: 1, _id: 0 } ).pretty() { \u0026#34;contact\u0026#34; : [ \u0026#34;Beijing\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ] } # è¿™é‡Œéœ€è¦è¯´æ˜ä¸€ä¸‹ï¼Œè™½ç„¶ $elemMatch åŒ¹é…çš„æ˜¯å†…åµŒæ•°ç»„ä¸­çš„å…ƒç´ ï¼Œä½†æ˜¯ $pull çš„åˆ é™¤æ“ä½œæ˜¯é’ˆå¯¹ contact çš„é¡¶çº§å…ƒç´ è¿›è¡Œçš„ï¼Œæ‰€ä»¥ä¼šæŠŠç¬¦åˆå†…åµŒæ•°ç»„ä¸­çš„ç­›é€‰æ¡ä»¶çš„å…ƒç´ æ‰€åœ¨çš„é¡¶çº§å…ƒç´ æ•´ä¸ªåˆ é™¤æ‰ã€‚ # å› æ­¤ï¼Œ33333333æ²¡æœ‰å‡ºç°åœ¨æŸ¥è¯¢ç»“æœä¸­   $pullAll æ“ä½œç¬¦ ä»æ•°ç»„å­—æ®µä¸­åˆ é™¤ç‰¹å®šå…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186  { $pull: { \u0026lt;field1\u0026gt;: \u0026lt;value\u0026gt;, ... } } { $pullAll: { \u0026lt;field1\u0026gt;: [ \u0026lt;value1\u0026gt;, \u0026lt;value2\u0026gt;, ... ] } } { $pullAll: { \u0026lt;field1\u0026gt;: [ \u0026lt;value1\u0026gt;, \u0026lt;value2\u0026gt;, ... ] } } ç›¸å½“äº { $pull: { \u0026lt;field1\u0026gt;: { $in: [ \u0026lt;value1\u0026gt;, \u0026lt;value2\u0026gt;, ... ] } } } ## å¦‚æœè¦åˆ é™¤çš„å…ƒç´ æ˜¯ä¸€ä¸ªå†…åµŒæ•°ç»„ï¼Œåˆ™æ•°ç»„å…ƒç´ çš„å€¼å’Œæ’åˆ—é¡ºåºéƒ½å¿…é¡»å’Œè¢«åˆ é™¤çš„æ•°ç»„å®Œå…¨ä¸€æ · # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ] } # åˆ é™¤ç¬¬ä¸€ä¸ªè”ç³»æ–¹å¼ \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $pullAll: { contact: [ [\u0026#34;33333333\u0026#34;, \u0026#34;22222222\u0026#34;] ] } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 }) # å› ä¸ºæ’åˆ—é¡ºåºä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ²¡æœ‰è¢«åˆ é™¤ ## å¦‚æœè¦åˆ é™¤çš„å…ƒç´ æ˜¯ä¸€ä¸ªå†…åµŒæ–‡æ¡£ $pullAll å‘½ä»¤åªä¼šåˆ é™¤å­—æ®µå’Œå­—æ®µæ’åˆ—é¡ºåºéƒ½å®Œå…¨åŒ¹é…çš„æ–‡æ¡£å…ƒç´  # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, { \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ] } \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $pullAll: { contact: [ {\u0026#34;primaryEmail\u0026#34;:\u0026#34;xxx@gmail.com\u0026#34;} ] } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 0 }) # å› ä¸ºæä¾›ç»™ $pullAll çš„æ–‡æ¡£å’Œæºæ–‡æ¡£å¹¶æ²¡æœ‰å®Œå…¨åŒ¹é…ï¼Œæ‰€ä»¥æ²¡æœ‰åˆ é™¤ \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $pullAll: { contact: [ { \u0026#34;secondaryEmail\u0026#34;: \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34;: \u0026#34;xxx@gmail.com\u0026#34; }, ] } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # åªä¼šåˆ é™¤ç¬¬äºŒä¸ªå†…åµŒæ–‡æ¡£ # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, { \u0026#34;primaryEmail\u0026#34; : \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34; : \u0026#34;yyy@gmail.com\u0026#34; }, [ ], \u0026#34;contact1\u0026#34; ] } # ä½†æ˜¯ï¼Œ$pull å‘½ä»¤ä¼šåˆ é™¤åŒ…å«æŒ‡å®šçš„æ–‡æ¡£å­—æ®µå’Œå­—æ®µå€¼çš„æ–‡æ¡£å…ƒç´ ï¼Œå­—æ®µæ’åˆ—é¡ºåºä¸éœ€è¦å®Œå…¨åŒ¹é…ã€‚ # è¿™ä¸€ç‚¹å’Œ $pullAll ä¸å¤ªä¸€æ · \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $pull: { contact: { \u0026#34;primaryEmail\u0026#34;: \u0026#34;xxx@gmail.com\u0026#34; } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # $pull åœ¨åˆ é™¤å†…åµŒæ–‡æ¡£çš„æ—¶å€™ï¼Œå…è®¸éƒ¨åˆ†åŒ¹é…ï¼Œä»–çš„æ¨¡ç³Šç¨‹åº¦æ›´é«˜ # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, [ ], \u0026#34;contact1\u0026#34; ] } # å°†åˆšæ‰åˆ é™¤çš„æ–‡æ¡£å…ƒç´ å†æ·»åŠ åˆ° contact æ•°ç»„ä¸­å» \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $addToSet: { contact: { \u0026#34;primaryEmail\u0026#34;: \u0026#34;xxx@gmail.com\u0026#34;, \u0026#34;secondaryEmail\u0026#34;: \u0026#34;yyy@gmail.com\u0026#34; } } } ) \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $pull: { contact: { \u0026#34;secondaryEmail\u0026#34;: \u0026#34;yyy@gmail.com\u0026#34;, \u0026#34;primaryEmail\u0026#34;: \u0026#34;xxx@gmail.com\u0026#34; } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # å¯ä»¥çœ‹åˆ°ï¼Œ$pull åœ¨åˆ é™¤å†…åµŒæ–‡æ¡£æ—¶ï¼Œå¯¹å­—æ®µçš„æ’åˆ—é¡ºåºæ²¡æœ‰è¦æ±‚   $push æ“ä½œç¬¦ å‘æ•°ç»„å­—æ®µä¸­æ·»åŠ å…ƒç´ \n$pushå’Œ$addToSetå‘½ä»¤ç›¸ä¼¼ï¼Œä½†æ˜¯$pushå‘½ä»¤çš„åŠŸèƒ½æ›´å¼ºå¤§\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326  è¯­æ³•: { $push: { \u0026lt;field1\u0026gt;: \u0026lt;value1\u0026gt;, ... } } # å’Œ $addToSet å‘½ä»¤ä¸€æ ·ï¼Œå¦‚æœ $push å‘½ä»¤ä¸­æŒ‡å®šçš„æ•°ç»„å­—æ®µä¸å­˜åœ¨ï¼Œåˆ™è¿™ä¸ªå­—æ®µä¼šè¢«æ·»åŠ åˆ°åŸæ–‡æ¡£ä¸­ \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: \u0026#34;new element\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;new element\u0026#34; ] } ## å’Œ $addToSet ç›¸ä¼¼ï¼Œ$push æ“ä½œç¬¦ä¹Ÿå¯ä»¥å’Œ $each æ­é…ä½¿ç”¨ \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ 2, 3, 4 ] } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;new element\u0026#34;, 2, 3, 4 ] } ## $push å’Œ $each æ“ä½œç¬¦è¿˜å¯ä»¥å’Œæ›´å¤šçš„æ“ä½œç¬¦æ­é…ä½¿ç”¨ï¼Œå®ç°æ¯” $addToSet æ›´å¤æ‚çš„æ“ä½œ ## ä½¿ç”¨ $position æ“ä½œç¬¦å°†å…ƒç´ æ’å…¥åˆ°æ•°ç»„çš„æŒ‡å®šä½ç½® \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ \u0026#34;pos1\u0026#34;, \u0026#34;pos2\u0026#34; ], $position: 0 } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;pos1\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;new element\u0026#34;, 2, 3, 4 ] } \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ \u0026#34;pos3\u0026#34;, \u0026#34;pos4\u0026#34; ], $position: -1 #æ’å…¥åˆ°æœ€åä¸€ä¸ªå…ƒç´ çš„å‰é¢ } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;pos1\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;new element\u0026#34;, 2, 3, \u0026#34;pos3\u0026#34;, \u0026#34;pos4\u0026#34;, 4 ] } ## ä½¿ç”¨ $sort å¯¹æ•°ç»„è¿›è¡Œæ’åº \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ \u0026#34;sort1\u0026#34; ], $sort: 1 # 1å‡åº -1é™åº } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ 2, 3, 4, \u0026#34;new element\u0026#34;, \u0026#34;pos1\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos3\u0026#34;, \u0026#34;pos4\u0026#34;, \u0026#34;sort1\u0026#34; ] } # å¦‚æœæ’å…¥çš„å…ƒç´ æ˜¯ä¸€ä¸ªå†…åµŒæ–‡æ¡£ï¼Œä¹Ÿå¯ä»¥æ ¹æ®å†…åµŒæ–‡æ¡£çš„å­—æ®µå€¼è¿›è¡Œæ’åº \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ { key: \u0026#34;sort\u0026#34;, value: 100 }, { key: \u0026#34;sort\u0026#34;, value: 200 } ], $sort: { value: -1 } # 1å‡åº -1é™åº } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ { \u0026#34;key\u0026#34; : \u0026#34;sort\u0026#34;, \u0026#34;value\u0026#34; : 200 }, { \u0026#34;key\u0026#34; : \u0026#34;sort\u0026#34;, \u0026#34;value\u0026#34; : 100 }, 2, 3, 4, \u0026#34;new element\u0026#34;, \u0026#34;pos1\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos3\u0026#34;, \u0026#34;pos4\u0026#34;, \u0026#34;sort1\u0026#34; ] } # å¦‚æœä¸æƒ³æ’å…¥å…ƒç´ ï¼Œåªæƒ³å¯¹æ–‡æ¡£ä¸­çš„æ•°ç»„å­—æ®µè¿›è¡Œæ’åºã€‚ã€‚ã€‚ \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ ], $sort: -1 } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ { \u0026#34;key\u0026#34; : \u0026#34;sort\u0026#34;, \u0026#34;value\u0026#34; : 200 }, { \u0026#34;key\u0026#34; : \u0026#34;sort\u0026#34;, \u0026#34;value\u0026#34; : 100 }, \u0026#34;sort1\u0026#34;, \u0026#34;pos4\u0026#34;, \u0026#34;pos3\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos1\u0026#34;, \u0026#34;new element\u0026#34;, 4, 3, 2 ] } ## ä½¿ç”¨ $slice æ¥æˆªå–æ•°ç»„çš„ä¸€éƒ¨åˆ† \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ \u0026#34;slice1\u0026#34; ], $slice: -8 #åªä¿ç•™æœ€å8ä¸ªå…ƒç´ ï¼Œå…¶ä»–çš„éƒ½è¢«åˆ é™¤æ‰ } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;pos3\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos1\u0026#34;, \u0026#34;new element\u0026#34;, 4, 3, 2, \u0026#34;slice1\u0026#34; ] } # å¦‚æœä¸æƒ³æ’å…¥å…ƒç´ ï¼Œåªæƒ³æˆªå–æ–‡æ¡£ä¸­çš„æ•°ç»„å­—æ®µã€‚ã€‚ã€‚ \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ ], $slice: 6 } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;pos3\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos1\u0026#34;, \u0026#34;new element\u0026#34;, 4, 3 ] } ## $position, $sort, $slice å¯ä»¥ä¸€èµ·ä½¿ç”¨ # è¿™ä¸‰ä¸ªæ“ä½œç¬¦çš„æ‰§è¡Œé¡ºåºæ˜¯: # $position -\u0026gt; $sort -\u0026gt; $slice # å†™åœ¨å‘½ä»¤ä¸­çš„æ“ä½œç¬¦é¡ºåºå¹¶ä¸é‡è¦ï¼Œå¹¶ä¸ä¼šå½±å“å‘½ä»¤çš„æ‰§è¡Œé¡ºåº \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $push: { newArray: { $each: [ \u0026#34;push1\u0026#34;, \u0026#34;push2\u0026#34; ], $position: 2, $sort: -1, $slice: 5 } } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;push2\u0026#34;, \u0026#34;push1\u0026#34;, \u0026#34;pos3\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos1\u0026#34; ] }   $å ä½æ“ä½œç¬¦ æ›´æ–°æ•°ç»„ä¸­çš„ç‰¹å®šå…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49  è¯­æ³•: db.collection.update( { \u0026lt;array\u0026gt;: \u0026lt;query selector\u0026gt; }, { \u0026lt;update operator\u0026gt;: { \u0026#34;\u0026lt;array\u0026gt;.$\u0026#34;: value } } ) $ æ˜¯æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªç¬¦åˆç­›é€‰æ¡ä»¶çš„æ•°ç»„å…ƒç´ çš„å ä½ç¬¦ æ­é…æ›´æ–°æ“ä½œç¬¦ä½¿ç”¨ï¼Œå¯ä»¥å¯¹æ»¡è¶³ç­›é€‰æ¡ä»¶çš„æ•°ç»„å…ƒç´ è¿›è¡Œæ›´æ–° # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;push2\u0026#34;, \u0026#34;push1\u0026#34;, \u0026#34;pos3\u0026#34;, \u0026#34;pos2\u0026#34;, \u0026#34;pos1\u0026#34; ] } \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34;, newArray: \u0026#34;pos2\u0026#34; }, { $set: { \u0026#34;newArray.$\u0026#34;: \u0026#34;updated\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, newArray: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;newArray\u0026#34; : [ \u0026#34;push2\u0026#34;, \u0026#34;push1\u0026#34;, \u0026#34;pos3\u0026#34;, \u0026#34;updated\u0026#34;, \u0026#34;pos1\u0026#34; ] }   æ›´æ–°æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ \n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56  è¯­æ³•: db.collection.update( { \u0026lt;query\u0026gt; }, { \u0026lt;update operator\u0026gt;: { \u0026#34;\u0026lt;array\u0026gt;.$[]\u0026#34;: value } } ) $[] æŒ‡ä»£æ•°ç»„å­—æ®µä¸­çš„æ‰€æœ‰å…ƒç´  æ­é…æ›´æ–°æ“ä½œç¬¦ä½¿ç”¨ï¼Œå¯ä»¥å¯¹æ•°ç»„ä¸­æ‰€æœ‰çš„å…ƒç´ è¿›è¡Œæ›´æ–° # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;22222222\u0026#34;, \u0026#34;33333333\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, [ ], \u0026#34;contact1\u0026#34; ] } \u0026gt; db.accounts.update( { name: \u0026#34;lawrence\u0026#34; }, { $set: { \u0026#34;contact.0.$[]\u0026#34;: \u0026#34;88888888\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹ lawrence çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;lawrence\u0026#34; }, { name: 1, contact: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34;, \u0026#34;contact\u0026#34; : [ [ \u0026#34;88888888\u0026#34;, \u0026#34;88888888\u0026#34; ], \u0026#34;Beijing\u0026#34;, \u0026#34;China\u0026#34;, [ ], \u0026#34;contact1\u0026#34; ] }   update options db.\u0026lt;collection\u0026gt;.update(\u0026lt;query\u0026gt;, \u0026lt;update\u0026gt;, \u0026lt;options\u0026gt;)\n\u0026lt;options\u0026gt;å‚æ•°æä¾›äº†updateå‘½ä»¤çš„æ›´å¤šé€‰é¡¹\nmulti æ›´æ–°å¤šä¸ªæ–‡æ¡£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64  è¯­æ³•: { multi: \u0026lt;boolean\u0026gt; } åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå³ä½¿ç­›é€‰æ¡ä»¶å¯¹åº”äº†å¤šç¯‡æ–‡æ¡£ï¼Œupdateå‘½ä»¤ä»ç„¶åªä¼šæ›´æ–°ä¸€ç¯‡æ–‡æ¡£ \u0026gt; db.accounts.update( {}, { $set: { currency: \u0026#34;USD\u0026#34; } } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, currency: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;bill\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } # ä½¿ç”¨ multi é€‰é¡¹æ¥æ›´æ–°å¤šä¸ªç¬¦åˆç­›é€‰æ¡ä»¶çš„æ–‡æ¡£ \u0026gt; db.accounts.update( {}, { $set: { currency: \u0026#34;USD\u0026#34; } }, { multi: true } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 24, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 23 }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, currency: 1, _id: 0 } ).pretty() { \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;bill\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;currency\u0026#34; : \u0026#34;USD\u0026#34; }    æ³¨æ„: MongoDBåªèƒ½ä¿è¯å•ä¸ªæ–‡æ¡£æ“ä½œçš„åŸå­æ€§ï¼Œä¸èƒ½ä¿è¯å¤šä¸ªæ–‡æ¡£æ“ä½œçš„åŸå­æ€§æ›´æ–°å¤šä¸ªæ–‡æ¡£çš„æ“ä½œè™½ç„¶åœ¨å•ä¸€çº¿ç¨‹ä¸­æ‰§è¡Œï¼Œä½†æ˜¯çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å¯èƒ½ä¼šè¢«æŒ‚èµ·ï¼Œä»¥ä¾¿å…¶ä»–çº¿ç¨‹ä¹Ÿæœ‰æœºä¼šå¯¹æ•°æ®è¿›è¡Œæ“ä½œå¦‚æœéœ€è¦ä¿è¯å¤šä¸ªæ–‡æ¡£æ“ä½œæ—¶çš„åŸå­æ€§ï¼Œå°±éœ€è¦ä½¿ç”¨MongoDB 4.0ç‰ˆæœ¬ä¸­å¼•å…¥çš„äº‹ç‰©åŠŸèƒ½è¿›è¡Œæ“ä½œ upsert æ›´æ–°æˆ–åˆ›å»ºæ–‡æ¡£ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  è¯­æ³•: { upsert: \u0026lt;boolean\u0026gt; } åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœ update å‘½ä»¤ä¸­çš„ç­›é€‰æ¡ä»¶æ²¡æœ‰åŒ¹é…ä»»ä½•æ–‡æ¡£ï¼Œåˆ™ä¸ä¼šè¿›è¡Œä»»ä½•æ“ä½œ å°† upsert é€‰é¡¹è®¾ç½®ä¸º true, å¦‚æœ update å‘½ä»¤ä¸­çš„ç­›é€‰æ¡ä»¶æ²¡æœ‰åŒ¹é…ä»»ä½•æ–‡æ¡£ï¼Œåˆ™ä¼šåˆ›å»ºæ–°æ–‡æ¡£ # æŸ¥çœ‹ maggie çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;maggie\u0026#34; }, { name: 1, balance: 1, _id: 0 } ) æ— è¾“å‡ºï¼Œè¯´æ˜æ²¡æœ‰è¿™ä¸ªç”¨æˆ· \u0026gt; db.accounts.update( { name: \u0026#34;maggie\u0026#34; }, { $set: { balance: 700 } }, { upsert: true } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 1, \u0026#34;nModified\u0026#34; : 0, \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce23eaf65fdd3b3b65b3810\u0026#34;) }) # æŸ¥çœ‹ maggie çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;maggie\u0026#34; }, { name: 1, balance: 1, _id: 0 } ) { \u0026#34;name\u0026#34; : \u0026#34;maggie\u0026#34;, \u0026#34;balance\u0026#34; : 700 } å¦‚æœæ— æ³•ä»ç­›é€‰æ¡ä»¶ä¸­æ¨æ–­å‡ºç¡®å®šçš„å­—æ®µå€¼ï¼Œæ–°åˆ›å»ºçš„æ–‡æ¡£å°†ä¸ä¼šåŒ…å«ç­›é€‰æ¡ä»¶æ¶‰åŠçš„å­—æ®µ \u0026gt; db.accounts.update( { balance: { $gt: 20000 } }, { $set: { name: \u0026#34;nick\u0026#34; } }, { upsert: true } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 1, \u0026#34;nModified\u0026#34; : 0, \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce2403b65fdd3b3b65b3869\u0026#34;) }) # æŸ¥çœ‹ nick çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( { name: \u0026#34;nick\u0026#34; }, { name: 1, balance: 1, _id: 0 } ) { \u0026#34;name\u0026#34; : \u0026#34;nick\u0026#34; } # ğŸ‘†è¿™é‡Œæ²¡æœ‰åŒ…å« balance å­—æ®µ   save è¿™ä¸ªå‘½ä»¤ä¹Ÿå¯ä»¥ç”¨æ¥æ›´æ–°æ–‡æ¡£\n1 2  è¯­æ³•: db.\u0026lt;collection\u0026gt;.save(\u0026lt;document\u0026gt;)   å¦‚æœdocumentæ–‡æ¡£ä¸­åŒ…å«äº†_idå­—æ®µï¼Œsave()å‘½ä»¤å°†ä¼šè°ƒç”¨db.collection.update()å‘½ä»¤(upserté€‰é¡¹è¢«æ‰“å¼€)\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61  # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, _id: 1 } ) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00c9672e77e7cb392a8fd\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;bill\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8fe\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;charlie\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00d5972e77e7cb392a8ff\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce00f5272e77e7cb392a901\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce011fd72e77e7cb392a902\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;george\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce0f15c72e77e7cb392a90c\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;001\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34; } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;savings\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;002\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;_id\u0026#34; : { \u0026#34;type\u0026#34; : \u0026#34;alipay\u0026#34;, \u0026#34;accountId\u0026#34; : \u0026#34;003\u0026#34; }, \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90d\u0026#34;) } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1107d72e77e7cb392a90e\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34; } { \u0026#34;_id\u0026#34; : ObjectId(\u0026#34;5ce1225972e77e7cb392a90f\u0026#34;), \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34; } # _idå·²å­˜åœ¨ï¼Œæ›´æ–°å·²æœ‰æ–‡æ¡£ \u0026gt; db.accounts.save( { _id: \u0026#34;account1\u0026#34;, name: \u0026#34;alice\u0026#34;, balance: 100 } ) ç›¸å½“äºæ‰§è¡Œ \u0026gt; db.accounts.update( { _id: \u0026#34;account1\u0026#34; }, { $set: { name: \u0026#34;alice\u0026#34;, balance: 100 } }, { upsert: true } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 1, \u0026#34;nUpserted\u0026#34; : 0, \u0026#34;nModified\u0026#34; : 1 }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;alice\u0026#34; }) { \u0026#34;_id\u0026#34; : \u0026#34;account1\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } # _idä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°æ–‡æ¡£ \u0026gt; db.accounts.save( { _id: \u0026#34;account2\u0026#34;, name: \u0026#34;oliver\u0026#34;, balance: 100 } ) ç›¸å½“äºæ‰§è¡Œ \u0026gt; db.accounts.update( { _id: \u0026#34;account2\u0026#34; }, { $set: { name: \u0026#34;oliver\u0026#34;, balance: 100 } }, { upsert: true } ) WriteResult({ \u0026#34;nMatched\u0026#34; : 0, \u0026#34;nUpserted\u0026#34; : 1, \u0026#34;nModified\u0026#34; : 0, \u0026#34;_id\u0026#34; : \u0026#34;account2\u0026#34; }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find({ name: \u0026#34;oliver\u0026#34; }) { \u0026#34;_id\u0026#34; : \u0026#34;account2\u0026#34;, \u0026#34;name\u0026#34; : \u0026#34;oliver\u0026#34;, \u0026#34;balance\u0026#34; : 100 }   åˆ é™¤æ–‡æ¡£ Â¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85  è¯­æ³•: db.\u0026lt;collection\u0026gt;.remove(\u0026lt;query\u0026gt;, \u0026lt;options\u0026gt;) # \u0026lt;query\u0026gt;æ–‡æ¡£å®šä¹‰äº†åˆ é™¤æ“ä½œæ—¶ç­›é€‰æ–‡æ¡£çš„æ¡ä»¶ # è¿™é‡Œçš„\u0026lt;query\u0026gt;æ–‡æ¡£ä¸ db.collection.find() ä¸­çš„ \u0026lt;query\u0026gt; æ–‡æ¡£æ˜¯ç›¸åŒçš„ # \u0026lt;options\u0026gt;æ–‡æ¡£å£°æ˜äº†ä¸€äº›åˆ é™¤æ“ä½œçš„é€‰é¡¹ # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, balance: 1, _id: 0 } ).sort({ balance: 1 }) { } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34; } { } { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;nick\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;name\u0026#34; : \u0026#34;bill\u0026#34;, \u0026#34;balance\u0026#34; : 80 } { \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 99.75 } { \u0026#34;name\u0026#34; : \u0026#34;alice\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;name\u0026#34; : \u0026#34;tom\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;name\u0026#34; : \u0026#34;oliver\u0026#34;, \u0026#34;balance\u0026#34; : 100 } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } # åˆ é™¤ä½™é¢ä¸º100çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.remove({ balance: 100 }) WriteResult({ \u0026#34;nRemoved\u0026#34; : 4 }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, balance: 1, _id: 0 } ).sort({ balance: 1 }) { } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34; } { } { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;nick\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;name\u0026#34; : \u0026#34;bill\u0026#34;, \u0026#34;balance\u0026#34; : 80 } { \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 99.75 } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } # åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œremove å‘½ä»¤ä¼šåˆ é™¤æ‰€æœ‰ç¬¦åˆç­›é€‰æ¡ä»¶çš„æ–‡æ¡£ # å¦‚æœåªæƒ³åˆ é™¤æ»¡è¶³ç­›é€‰æ¡ä»¶çš„ä¸€ç¯‡æ–‡æ¡£ï¼Œå¯ä»¥ä½¿ç”¨ justOne é€‰é¡¹ # åˆ é™¤ä¸€ç¯‡ä½™é¢å°äº100çš„é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.remove( { balance: { $lt: 100 } }, { justOne: true } ) WriteResult({ \u0026#34;nRemoved\u0026#34; : 1 }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, balance: 1, _id: 0 } ).sort({ balance: 1 }) { } { \u0026#34;name\u0026#34; : \u0026#34;karen\u0026#34; } { } { \u0026#34;name\u0026#34; : \u0026#34;lawrence\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;nick\u0026#34; } { \u0026#34;name\u0026#34; : \u0026#34;fred\u0026#34;, \u0026#34;balance\u0026#34; : 20 } { \u0026#34;name\u0026#34; : \u0026#34;david\u0026#34;, \u0026#34;balance\u0026#34; : 99.75 } { \u0026#34;name\u0026#34; : \u0026#34;john\u0026#34;, \u0026#34;balance\u0026#34; : 200 } { \u0026#34;name\u0026#34; : \u0026#34;champ\u0026#34;, \u0026#34;balance\u0026#34; : 200 } # åˆ é™¤é›†åˆå†…çš„æ‰€æœ‰æ–‡æ¡£ \u0026gt; db.accounts.remove({}) WriteResult({ \u0026#34;nRemoved\u0026#34; : 22 }) # æŸ¥çœ‹é“¶è¡Œè´¦æˆ·æ–‡æ¡£ \u0026gt; db.accounts.find( {}, { name: 1, balance: 1, _id: 0 } ).sort({ balance: 1 }) æ— è¾“å‡º   åˆ é™¤é›†åˆ Â¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  è¯­æ³•: db.\u0026lt;collection\u0026gt;.drop( { writeConcern: \u0026lt;document\u0026gt; } ) è¿™é‡Œçš„ writeConcern æ–‡æ¡£å®šä¹‰äº†æœ¬æ¬¡é›†åˆåˆ é™¤æ“ä½œçš„å®‰å…¨å†™çº§åˆ« # ä¹‹å‰çš„ remove å‘½ä»¤å¯ä»¥åˆ é™¤é›†åˆå†…çš„æ‰€æœ‰æ–‡æ¡£ï¼Œä½†æ˜¯ä¸ä¼šåˆ é™¤é›†åˆ \u0026gt; show collections accounts # drop å‘½ä»¤å¯ä»¥åˆ é™¤æ•´ä¸ªé›†åˆï¼ŒåŒ…æ‹¬é›†åˆä¸­çš„æ‰€æœ‰æ–‡æ¡£ï¼Œä»¥åŠé›†åˆçš„ç´¢å¼• \u0026gt; db.accounts.drop() true \u0026gt; show collections æ— è¾“å‡º # å¦‚æœé›†åˆä¸­çš„æ–‡æ¡£æ•°é‡å¾ˆå¤šï¼Œä½¿ç”¨ remove å‘½ä»¤åˆ é™¤æ‰€æœ‰æ–‡æ¡£çš„æ•ˆç‡ä¸é«˜ # è¿™ç§æƒ…å†µä¸‹ï¼Œæ›´åŠ æœ‰æ•ˆç‡çš„æ–¹æ³•ï¼Œæ˜¯ä½¿ç”¨ drop å‘½ä»¤åˆ é™¤æ•´ä¸ªé›†åˆï¼Œç„¶åå†åˆ›å»ºç©ºé›†åˆå¹¶åˆ›å»ºç´¢å¼•   "},{"href":"https://blog.champ.design/posts/2019/05/mac-cheat-sheet/","title":"Mac å®ç”¨æŠ€å·§","body":"å¾®è°ƒéŸ³é‡ Â¶ Shift + Option + éŸ³é‡é”® å¯ä»¥ä»¥ 1/4 å€è°ƒæ•´éŸ³é‡ï¼Œå®ç°æ›´ç²¾ç»†çš„æ§åˆ¶éŸ³é‡\nåˆ é™¤é”® Â¶ 1 2 3 4 5  å•æŒ‰ delete åˆ é™¤å…‰æ ‡ä¹‹å‰çš„ä¸€ä¸ªå­—ç¬¦ï¼ˆé»˜è®¤ï¼‰ ç»„åˆ `fn + delete`ï¼Œåˆ é™¤å…‰æ ‡ä¹‹åçš„ä¸€ä¸ªå­—ç¬¦ ç»„åˆ`option + delete`ï¼Œåˆ é™¤å…‰æ ‡ä¹‹å‰çš„ä¸€ä¸ªå•è¯(è‹±æ–‡æœ‰æ•ˆ) ç»„åˆ`fn + option + delete`ï¼Œåˆ é™¤å…‰æ ‡ä¹‹åçš„ä¸€ä¸ªå•è¯ ç»„åˆ`command + delete`ï¼Œåˆ é™¤æ–‡ä»¶   "},{"href":"https://blog.champ.design/posts/2019/05/koa-scaffold/","title":"Koa é¡¹ç›®è„šæ‰‹æ¶","body":"ç”±äº koa æ¡†æ¶éå¸¸ç²¾ç®€ï¼Œä¸æ†ç»‘ä»»ä½•ä¸­é—´ä»¶ï¼Œå› æ­¤ï¼Œè·¯ç”±ã€æ—¥å¿—ç­‰è¿™äº›å¸¸è§çš„åŠŸèƒ½éƒ½æ˜¯ç”±å•ç‹¬çš„æ¨¡å—æä¾›ã€‚è¿™é‡Œåˆ—ä¸¾ä¸€äº›å¸¸ç”¨çš„ä¸­é—´ä»¶ï¼Œå¯ä»¥ä½œä¸ºè„šæ‰‹æ¶ä½¿ç”¨ã€‚\nkoa-router Â¶ é¡¹ç›®åœ°å€: https://github.com/ZijianHe/koa-router 1  npm install koa-router   koa-body Â¶ é¡¹ç›®åœ°å€: https://github.com/dlau/koa-body ç”¨äºè§£æ post/put/... è¯·æ±‚æ—¶çš„ bodyï¼Œæ”¯æŒ jsonã€urlenocdedã€multipartç­‰æ ¼å¼ã€‚\n1  npm install koa-body   @koa/cors Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/cors å®˜æ–¹æä¾›çš„corsè·¨åŸŸè§£å†³æ–¹æ¡ˆ\n1  npm install @koa/cors   koa-session Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/session 1  npm install koa-session   koa-logger Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/logger 1  npm install koa-logger   koa-compress Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/compress 1  npm install koa-compress   koa-static Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/static 1  npm install koa-static   koa-csrf Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/csrf 1  npm install koa-csrf   koa-jwt Â¶ é¡¹ç›®åœ°å€: https://github.com/koajs/jwt ç”¨äºéªŒè¯jwt\n1  npm install koa-jwt    æ³¨æ„: ä»koa-v2åˆ†æ”¯ä¹‹åï¼Œkoa-jwtä¸å†æä¾›sign,verify,decodeç­‰å‡½æ•°å› æ­¤ï¼Œéœ€è¦é€šè¿‡ä¸‹é¢çš„jsonwebtokenæ¥ç”Ÿæˆjwt jsonwebtoken Â¶ é¡¹ç›®åœ°å€: https://github.com/auth0/node-jsonwebtoken ç”¨äºç”Ÿæˆjwt\n1  npm install jsonwebtoken   koa-helmet Â¶ é¡¹ç›®åœ°å€: https://github.com/venables/koa-helmet å®‰å…¨æ–¹é¢çš„é…ç½®\n1  npm install koa-static   mongoose Â¶ é¡¹ç›®åœ°å€: https://github.com/Automattic/mongoose MongoDB æ•°æ®åº“çš„nodejså®¢æˆ·ç«¯\n1  npm install mongoose   "},{"href":"https://blog.champ.design/posts/2019/05/koa-learn-note/","title":"Koa å­¦ä¹ ç¬”è®°","body":"nodemonå·¥å…·çš„ä½¿ç”¨ Â¶ å·¥å…·è¯´æ˜: ç±»ä¼¼äºå‰ç«¯å¼€å‘ï¼Œæˆ‘å¸Œæœ›nodeæœåŠ¡å™¨è¿è¡Œèµ·æ¥ä¹‹åï¼Œå½“æˆ‘ä¿®æ”¹äº†æˆ‘çš„ä»£ç ä¹‹åï¼ŒæœåŠ¡ä¼šè‡ªåŠ¨é‡å¯ï¼Œä¸éœ€è¦æˆ‘æ¯æ¬¡éƒ½æ‰‹åŠ¨é‡å¯æœåŠ¡ã€‚\né¡¹ç›®åœ°å€: https://github.com/remy/nodemon 1 2  $ node install -g nodemon #å…¨å±€å®‰è£… $ nodemon app.js #ç”¨ nodemon æ›¿ä»£ node æ¥å¯åŠ¨åº”ç”¨   å…³äºGenerator Â¶ åœ¨è€çš„æ•™ç¨‹ä¸­ï¼Œä¸­é—´ä»¶çš„å†™æ³•ä¼šæœ‰å¾ˆå¤šç”Ÿæˆå™¨å‡½æ•°çš„ç”¨æ³•ï¼Œæ¯”å¦‚:\n1 2 3 4 5  app.use(function* (next) { console.log(\u0026#34;1\u0026#34;); yield next; console.log(\u0026#34;2\u0026#34;); });   åœ¨koaçš„v2ç‰ˆä¸­ï¼Œå†™æ³•å‘ç”Ÿäº†å˜åŒ–:\n1 2 3 4 5  app.use(async (ctx, next) =\u0026gt; { console.log(\u0026#34;1\u0026#34;); await next(); console.log(\u0026#34;2\u0026#34;); })    ä¸çŸ¥é“è¿™ä¸ªæ˜¯ä¸æ˜¯åªæ˜¯ä¸€ä¸ªè¯­æ³•çš„é—®é¢˜ï¼ŒæŠ½æ—¶é—´éœ€è¦ç ”ç©¶ä¸€ä¸‹ã€‚ é™„ä¸Šes6 generatorçš„æ•™ç¨‹ MDN function*è¯­æ³• é˜®ä¸€å³°çš„æ–‡ç«  introduction to koa generator  å…³äº async/await ä¸ Promise Â¶ async/await æ˜¯ Promise çš„è¯­æ³•ç³–ï¼Œå‘ğŸ‘‡çœ‹: ä¸‹é¢è¿™ä¸¤ä¸ªå‡½æ•°æ˜¯ç­‰ä»·çš„:\n1 2 3 4 5 6 7 8 9  async function foo() { return 42; } function foo() { return new Promise((resolve, reject) =\u0026gt; { resolve(42); }); }   åœ¨ async å‡½æ•°é‡Œé¢æŠ›çš„é”™è¯¯ï¼Œä¼šå‡ºç°åœ¨ rejected promise ä¸­:\n1 2 3 4 5 6 7 8 9  async function foo() { throw new Error(\u0026#39;oops!\u0026#39;); } function foo() { return new Promise((resolve, reject) =\u0026gt; { reject(new Error(\u0026#39;oops!\u0026#39;)); }); }   å¦å¤–ï¼Œåœ¨ async å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ await å…³é”®å­—å»ç­‰å¾…å¦ä¸€ä¸ª promised å‡½æ•°è¿”å›ï¼Œç„¶åæŠŠç»“æœèµ‹ç»™ä¸€ä¸ªå±€éƒ¨å˜é‡:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14  async function foo() { const userId = 42; const user = await User.findById(userId); return user.name; } function foo() { const userId = 42; return User.findById(userId).then(user =\u0026gt; { return user.name; }); }   å‚è€ƒ Â¶ tutorial spoint koajs/examples "},{"href":"https://blog.champ.design/posts/2019/05/linux-command/","title":"Linuxå¸¸ç”¨å‘½ä»¤","body":"æ¸…ç©ºæ–‡ä»¶å†…å®¹ Â¶ 1 2 3 4 5 6 7  $ \u0026gt; filename #è¿™ä¸ªå‘½ä»¤æ‰§è¡Œå®Œä¹‹åï¼Œä¸ä¼šè‡ªåŠ¨é€€å‡ºï¼Œéœ€è¦æŒ‰Ctrl+Dç»“æŸ $ : \u0026gt; filename #æˆ‘æœ€å¸¸ç”¨çš„ï¼Œ:æ˜¯ä¸€ä¸ªå ä½ç¬¦ï¼Œä¸äº§ç”Ÿä»»ä½•è¾“å‡º $ echo \u0026#39;\u0026#39; \u0026gt; filename $ echo /dev/null \u0026gt; filename $ echo \u0026gt; filename $ cat /dev/null \u0026gt; filename $ cp /dev/null filename    å…³äºä¸Šé¢å‡ ä¸ªå‘½ä»¤çš„è§£é‡Šï¼š \u0026gt; filenameçš„æ„æ€æ˜¯ï¼Œä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–å†…å®¹å¹¶å†™å…¥åˆ°æ–‡ä»¶filenameä¸­ï¼Œæ‰§è¡Œå®Œè¯¥å‘½ä»¤ä¹‹åï¼Œéœ€è¦ç«‹å³æ‰§è¡ŒCtrl+Dè¡¨ç¤ºç»“æŸè¾“å…¥ï¼Œå› ä¸ºæ­¤æ—¶å¹¶æ²¡æœ‰è¾“å…¥ä»»ä½•å†…å®¹ï¼Œæ‰€ä»¥æ–‡ä»¶å°±è¢«æ¸…ç©ºäº†ã€‚ : \u0026gt; filenameæ˜¯ä¸Šé¢çš„æ”¹è¿›ç‰ˆï¼Œä¸éœ€è¦æ‰‹åŠ¨æ‰§è¡ŒCtrl+D   æŒ‰ç…§æ—¶é—´åˆ é™¤æ–‡ä»¶ Â¶ æœ‰æ—¶å€™ï¼Œæˆ‘ä¼šä¸å°å¿ƒæŠŠæ•´ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªé”™è¯¯çš„ç›®å½•ä¸‹ï¼Œç„¶åæƒ³åˆ é™¤åˆšä¸Šä¼ çš„æ–‡ä»¶ã€‚ä½†æ˜¯ç™»å½•åˆ°æœåŠ¡å™¨ä¹‹åï¼Œå‘ç°è¿™ä¸ªç›®å½•ä¸‹ä¸ä»…ä»…æ˜¯åˆšä¸Šä¼ çš„æ–‡ä»¶ï¼Œè¿˜æœ‰ä¹‹å‰å°±å­˜åœ¨çš„ä¸€äº›æ–‡ä»¶ã€‚è€Œæˆ‘åˆä¸èƒ½æŠŠè¿™ä¸ªç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½åˆ é™¤æ‰ï¼Œæˆ‘åªæƒ³åˆ é™¤åˆšåˆšä¸Šä¼ çš„é‚£äº›æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘åªæƒ³åˆ é™¤åˆšåˆšä¿®æ”¹çš„æ–‡ä»¶ã€‚æˆªå›¾å¦‚ä¸‹:\n1 2  find . -mtime -10 #æŸ¥æ‰¾å½“å‰ç›®å½•ä¸‹ï¼Œ10å¤©å†…ä¿®æ”¹è¿‡çš„æ‰€æœ‰æ–‡ä»¶ find . -mtime -10 -exec rm -Rf {} \\;   rsync ä½¿ç”¨è‡ªå®šä¹‰ ssh key è¿›è¡Œå‘å¸ƒ Â¶ 1  rsync -Pav public/ ubuntu@tencent:/var/www/xkiller   "},{"href":"https://blog.champ.design/posts/2019/05/nodejs-learn-note/","title":"Nodejsä¹‹nextTick vs setImmediate","body":"å…³äº process.nextTick å’Œ setImmediate æ‰§è¡Œæ—¶æœºçš„é—®é¢˜ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  // åŠ å…¥ä¸¤ä¸ªnextTick()çš„å›è°ƒå‡½æ•° process.nextTick(function () { console.log(\u0026#39;nextTickå»¶è¿Ÿæ‰§è¡Œ1\u0026#39;); }); process.nextTick(function () { console.log(\u0026#39;nextTickå»¶è¿Ÿæ‰§è¡Œ2\u0026#39;); }); // åŠ å…¥ä¸¤ä¸ªsetImmediate()çš„å›è°ƒå‡½æ•° setImmediate(function () { console.log(\u0026#39;setImmediateå»¶è¿Ÿæ‰§è¡Œ1\u0026#39;); // è¿›å…¥ä¸‹æ¬¡å¾ªç¯  process.nextTick(function () { console.log(\u0026#39;å¼ºåŠ¿æ’å…¥\u0026#39;); }); }); setImmediate(function () { console.log(\u0026#39;setImmediateå»¶è¿Ÿæ‰§è¡Œ2\u0026#39;); }); console.log(\u0026#39;æ­£å¸¸æ‰§è¡Œ\u0026#39;);   ã€Šnodejsæ·±å…¥æµ…å‡ºã€‹çš„3.4ç« ä¸­çš„ä»£ç æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\næ­£å¸¸æ‰§è¡Œ nextTickå»¶è¿Ÿæ‰§è¡Œ1 nextTickå»¶è¿Ÿæ‰§è¡Œ2 setImmediateå»¶è¿Ÿæ‰§è¡Œ1 å¼ºåŠ¿æ’å…¥ setImmediateå»¶è¿Ÿæ‰§è¡Œ2 å‚è§ å¯èƒ½æ˜¯å› ä¸ºnodeç‰ˆæœ¬ä¸åŒï¼Œæˆ‘åœ¨æœ¬åœ°çš„æ‰§è¡Œç»“æœå¦‚ä¸‹ï¼š\næ­£å¸¸æ‰§è¡Œ nextTickå»¶è¿Ÿæ‰§è¡Œ1 nextTickå»¶è¿Ÿæ‰§è¡Œ2 setImmediateå»¶è¿Ÿæ‰§è¡Œ1 setImmediateå»¶è¿Ÿæ‰§è¡Œ2 å¼ºåŠ¿æ’å…¥ 1 2  $ node -v v10.15.0   nextTick vs setImmediate stack-overflow å®˜æ–¹æ–‡æ¡£è¯´æ˜ æ›´å¤šæ–‡ç«  "},{"href":"https://blog.champ.design/posts/2019/05/setup-your-own-git-server/","title":"æ­å»ºè‡ªå·±çš„gitæœåŠ¡å™¨","body":"ç¯å¢ƒ: server: ubuntu 16.4\nç¬¬ä¸€æ­¥ï¼Œå®‰è£…git: sudo apt-get install git\nç¬¬äºŒæ­¥ï¼Œåˆ›å»ºä¸€ä¸ªgitç”¨æˆ·ï¼Œç”¨æ¥è¿è¡ŒgitæœåŠ¡ï¼š sudo adduser git\nç¬¬ä¸‰æ­¥ï¼Œåˆ›å»ºè¯ä¹¦ç™»å½•ï¼š æ”¶é›†æ‰€æœ‰éœ€è¦ç™»å½•çš„ç”¨æˆ·çš„å…¬é’¥ï¼Œå¯¼å…¥åˆ° /home/git/.ssh/authorized_keys æ–‡ä»¶ä¸­ï¼Œä¸€è¡Œä¸€ä¸ªã€‚\nç¬¬å››æ­¥ï¼Œåˆå§‹åŒ–gitè£¸ä»“åº“ï¼š cd /srv sudo git init \u0026ndash;bare blog.git sudo chown -R git:git blog.git\nç¬¬äº”æ­¥ï¼Œç¦ç”¨shellç™»å½•ï¼š ç¼–è¾‘ /etc/passwd æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š\ngitâŒ1001:1001:,,,:/home/git:/bin/bash gitâŒ1001:1001:,,,:/home/git:/user/bin/git-shell ç¬¬å…­æ­¥ï¼Œå…‹éš†è¿œç¨‹ä»“åº“ï¼š git clone git@server:/srv/blog.git\nç¬¬ä¸ƒæ­¥ï¼Œè®¾ç½®æœ¬åœ°ä»“åº“çš„originï¼š å¦‚æœå…ˆæœ‰æœ¬åœ°ä»“åº“ï¼Œåæœ‰æœåŠ¡å™¨çš„è£¸ä»“åº“ï¼Œå¯ä»¥è®¾ç½®æœ¬åœ°ä»“åº“çš„origin:\n"},{"href":"https://blog.champ.design/about/","title":"","body":"å…³äºæˆ‘ Â¶ ä½ å¥½ï¼Œæˆ‘æ˜¯ champkehï¼Œå°å champï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººå°ç«™ã€‚\næˆ‘æ˜¯ä¸€å Web å¼€å‘è€…ï¼Œæ›¾ä»äº‹è¿‡ .NET åç«¯å¼€å‘çš„å·¥ä½œ(2å¹´)ï¼Œç›®å‰ä¸»è¦å·¥ä½œå†…å®¹ä¸ºå‰ç«¯å¼€å‘ã€‚ åŒæ—¶æˆ‘ä¹Ÿå¯¹golangè¯­è¨€å¾ˆæ„Ÿå…´è¶£ã€‚\nå¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ï¼Œéƒ½å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹å¼è”ç³»åˆ°æˆ‘ã€‚\n Y2hhbXBpb24uZ2VAZ21haWwuY29t (é‚®ç®±) / Github "},{"href":"https://blog.champ.design/search/index.json","title":"","body":""}]}