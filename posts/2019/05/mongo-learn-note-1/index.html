<!doctype html><html><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<title>MongoDB 学习笔记之CRUD - champ的个人博客</title>
<meta name=author content>
<meta name=description content>
<meta name=keywords content>
<link rel=stylesheet href=/css/style.min.26861c21ac32379fb8e5f608829f044a996d611fdba1349db869cb08c486c5e2.css>
<link rel=stylesheet href=/css/syntax.min.css>
</head>
<body>
<div id=container class=container>
<header id=header>
<div class=wrapper>
<button class=round-left onclick="location.href='/'"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 24 24" aria-label="主页图标" class="css-ggaxow ellz05y0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M19 21H5a1 1 0 01-1-1v-9H1l10.327-9.388a1 1 0 011.346.0L23 11h-3v9a1 1 0 01-1 1zM6 19h12V9.157l-6-5.454-6 5.454V19z"/></g></svg>
回到主页</button>
<button class=round-right><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 24 24" aria-label="文章目录" class="css-ggaxow ellz05y0" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M20 22H4a1 1 0 01-1-1V3a1 1 0 011-1h16a1 1 0 011 1v18a1 1 0 01-1 1zm-1-2V4H5v16h14zM8 7h8v2H8V7zm0 4h8v2H8v-2zm0 4h8v2H8v-2z"/></g></svg>
目录</button>
</div>
</header>
<main id=main>
<article class=post-single>
<header>
<h1>MongoDB 学习笔记之CRUD</h1>
<span class=summary>启动一个 MongoDB 服务器容器 ¶ 1 2 $ docker pull mongo:4 $ docker run --name mymongo -v /data/docker-db:/data/db -d mongo:4 启动 Mongo Express 容器 ¶ 1 2 $ docker pull mongo-express $ docker run --link mymongo:mongo -p 8081:8081 -d mongo-express 在浏览器打开 http://localhost</span>
<div class=meta>
<time><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 24 24" aria-label="日期图标" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M17 3h4a1 1 0 011 1v16a1 1 0 01-1 1H3a1 1 0 01-1-1V4a1 1 0 011-1h4V1h2v2h6V1h2v2zm-2 2H9v2H7V5H4v4h16V5h-3v2h-2V5zm5 6H4v8h16v-8z"/></g></svg>
编辑于 2019 年 05 月 11 日
</time>
<a href=https://creativecommons.org/licenses/by-sa/4.0/deed.zh target=_blank rel="noopener noreferrer"><svg stroke="currentcolor" fill="currentcolor" stroke-width="0" viewBox="0 0 24 24" aria-label="版权图标" height="1.125em" width="1.125em" xmlns="http://www.w3.org/2000/svg"><g><path fill="none" d="M0 0h24v24H0z"/><path d="M12 2c5.52.0 10 4.48 10 10s-4.48 10-10 10S2 17.52 2 12 6.48 2 12 2zm0 2c-4.42.0-8 3.58-8 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm0 3c1.82.0 3.413.973 4.288 2.428l-1.714 1.029A3 3 0 1012 15a2.998 2.998.0 002.573-1.456l1.715 1.028A4.999 4.999.0 017 12c0-2.76 2.24-5 5-5z"/></g></svg>
CC-BY-SA-4.0
</a>
</div>
</header>
<aside>
<h2>Table of Contents</h2>
<nav id=TableOfContents>
<ul>
<li><a href=#启动一个-mongodb-服务器容器>启动一个 MongoDB 服务器容器</a></li>
<li><a href=#启动-mongo-express-容器>启动 Mongo Express 容器</a></li>
<li><a href=#启动-mongo-shell>启动 Mongo shell</a></li>
<li><a href=#文档的基本操作>文档的基本操作</a>
<ul>
<li><a href=#创建文档>创建文档</a></li>
<li><a href=#对象主键>对象主键</a></li>
<li><a href=#复合主键>复合主键</a></li>
<li><a href=#读取文档>读取文档</a></li>
<li><a href=#文档游标>文档游标</a></li>
<li><a href=#游标函数>游标函数</a></li>
<li><a href=#文档投射>文档投射</a></li>
</ul>
</li>
<li><a href=#更新文档>更新文档</a>
<ul>
<li><a href=#更新整篇文档>更新整篇文档</a></li>
<li><a href=#更新特定字段>更新特定字段</a></li>
<li><a href=#数组更新操作符>数组更新操作符</a></li>
<li><a href=#update-options>update options</a></li>
</ul>
</li>
<li><a href=#删除文档>删除文档</a></li>
<li><a href=#删除集合>删除集合</a></li>
</ul>
</nav>
</aside>
<section class=body>
<h2 id=启动一个-mongodb-服务器容器>启动一个 MongoDB 服务器容器 <a href=#%e5%90%af%e5%8a%a8%e4%b8%80%e4%b8%aa-mongodb-%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%ae%b9%e5%99%a8 class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ docker pull mongo:4
$ docker run --name mymongo -v /data/docker-db:/data/db -d mongo:4
</code></pre></td></tr></table>
</div>
</div><h2 id=启动-mongo-express-容器>启动 Mongo Express 容器 <a href=#%e5%90%af%e5%8a%a8-mongo-express-%e5%ae%b9%e5%99%a8 class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ docker pull mongo-express
$ docker run --link mymongo:mongo -p 8081:8081 -d mongo-express
</code></pre></td></tr></table>
</div>
</div><p>在浏览器打开 <code>http://localhost:8081</code>，mongo-expres 的界面如下:</p>
<p><p class=md__image>
<img src=/images/mongo-express-shot@2x.png alt>
</p>
</p>
<h2 id=启动-mongo-shell>启动 Mongo shell <a href=#%e5%90%af%e5%8a%a8-mongo-shell class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ docker <span style=color:#007020>exec</span> -it mymongo mongo
</code></pre></td></tr></table>
</div>
</div><h2 id=文档的基本操作>文档的基本操作 <a href=#%e6%96%87%e6%a1%a3%e7%9a%84%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9c class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 查看所有数据库</span>
&gt; show dbs
admin   0.000GB
config  0.000GB
<span style=color:#007020>local</span>   0.000GB

<span style=color:#60a0b0;font-style:italic># 切换到 test 数据库</span>
&gt; use <span style=color:#007020>test</span>
switched to db <span style=color:#007020>test</span>

<span style=color:#60a0b0;font-style:italic># 查看 test 数据库中的集合</span>
&gt; show collections
</code></pre></td></tr></table>
</div>
</div><h3 id=创建文档>创建文档 <a href=#%e5%88%9b%e5%bb%ba%e6%96%87%e6%a1%a3 class=anchor>¶</a></h3>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 准备写入数据库的文档</span>
<span style=color:#60a0b0;font-style:italic># {</span>
<span style=color:#60a0b0;font-style:italic>#   _id: &#34;account1&#34;,</span>
<span style=color:#60a0b0;font-style:italic>#   name: &#34;alice&#34;,</span>
<span style=color:#60a0b0;font-style:italic>#   balance: 100</span>
<span style=color:#60a0b0;font-style:italic># }</span>
<span style=color:#60a0b0;font-style:italic># 将文档写入 accounts 集合</span>
&gt; db.accounts.insertOne<span style=color:#666>(</span>
... <span style=color:#666>{</span>
...    _id: <span style=color:#4070a0>&#34;account1&#34;</span>,
...    name: <span style=color:#4070a0>&#34;alice&#34;</span>,
...    balance: <span style=color:#40a070>100</span>
...  <span style=color:#666>}</span>
...<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;acknowledged&#34;</span>: true, <span style=color:#4070a0>&#34;insertedId&#34;</span>: <span style=color:#4070a0>&#34;account1&#34;</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 写入id重复的数据时</span>
&gt; db.accounts.insertOne<span style=color:#666>(</span>
... <span style=color:#666>{</span>
...    _id: <span style=color:#4070a0>&#34;account1&#34;</span>,
...    name: <span style=color:#4070a0>&#34;bob&#34;</span>,
...    balance: <span style=color:#40a070>200</span>
...  <span style=color:#666>}</span>
...<span style=color:#666>)</span>
2019-05-18T13:37:29.722+0000 E QUERY    <span style=color:#666>[</span>js<span style=color:#666>]</span> WriteError: E11000 duplicate key error collection: test.accounts index: _id_ dup key: <span style=color:#666>{</span> : <span style=color:#4070a0>&#34;account1&#34;</span> <span style=color:#666>}</span> :
WriteError<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;index&#34;</span> : 0,
	<span style=color:#4070a0>&#34;code&#34;</span> : 11000,
	<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \&#34;account1\&#34; }&#34;</span>,
	<span style=color:#4070a0>&#34;op&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>,
		<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span>
	<span style=color:#666>}</span>
<span style=color:#666>})</span>
WriteError@src/mongo/shell/bulk_api.js:461:48
Bulk/mergeBatchResults@src/mongo/shell/bulk_api.js:841:49
Bulk/executeBatch@src/mongo/shell/bulk_api.js:906:13
Bulk/this.execute@src/mongo/shell/bulk_api.js:1150:21
DBCollection.prototype.insertOne@src/mongo/shell/crud_api.js:252:9
@<span style=color:#666>(</span>shell<span style=color:#666>)</span>:1:1

<span style=color:#60a0b0;font-style:italic># 使用 try-catch 捕获错误</span>
&gt; try <span style=color:#666>{</span>
...  db.accounts.insertOne<span style=color:#666>(</span>
...    <span style=color:#666>{</span>
...      _id: <span style=color:#4070a0>&#34;account1&#34;</span>,
...      name: <span style=color:#4070a0>&#34;bob&#34;</span>,
...      balance: <span style=color:#40a070>200</span>
...    <span style=color:#666>}</span>
...  <span style=color:#666>)</span>
...<span style=color:#666>}</span> catch <span style=color:#666>(</span>e<span style=color:#666>)</span> <span style=color:#666>{</span>
...  print<span style=color:#666>(</span>e<span style=color:#666>)</span>    
...<span style=color:#666>}</span>
WriteError<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;index&#34;</span> : 0,
	<span style=color:#4070a0>&#34;code&#34;</span> : 11000,
	<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \&#34;account1\&#34; }&#34;</span>,
	<span style=color:#4070a0>&#34;op&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>,
		<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span>
	<span style=color:#666>}</span>
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 创建多个文档</span>
&gt; db.accounts.insertMany<span style=color:#666>(</span> <span style=color:#666>[</span>
... <span style=color:#666>{</span>
...   name: <span style=color:#4070a0>&#39;charlie&#39;</span>,
...   balance: <span style=color:#40a070>500</span>
... <span style=color:#666>}</span>,
... <span style=color:#666>{</span>
...   name: <span style=color:#4070a0>&#39;david&#39;</span>,
...   balance: <span style=color:#40a070>200</span>
... <span style=color:#666>}</span>
... <span style=color:#666>]</span> <span style=color:#666>)</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;acknowledged&#34;</span> : true,
	<span style=color:#4070a0>&#34;insertedIds&#34;</span> : <span style=color:#666>[</span>
		ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>,
		ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 顺序写出现错误时</span>
&gt; try <span style=color:#666>{</span>
... db.accounts.insertMany<span style=color:#666>(</span> <span style=color:#666>[</span>
...   <span style=color:#666>{</span>
...     _id: <span style=color:#4070a0>&#39;account1&#39;</span>,
...     name: <span style=color:#4070a0>&#39;edwrad&#39;</span>,
...     balance: <span style=color:#40a070>700</span>
...   <span style=color:#666>}</span>,
...   <span style=color:#666>{</span>
...     name: <span style=color:#4070a0>&#39;fred&#39;</span>,
...     balance: <span style=color:#40a070>20</span>
...   <span style=color:#666>}</span>
... <span style=color:#666>]</span> <span style=color:#666>)</span>
... <span style=color:#666>}</span> catch<span style=color:#666>(</span>e<span style=color:#666>)</span> <span style=color:#666>{</span>
...   print<span style=color:#666>(</span>e<span style=color:#666>)</span>
... <span style=color:#666>}</span>
BulkWriteError<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;writeErrors&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;index&#34;</span> : 0,
			<span style=color:#4070a0>&#34;code&#34;</span> : 11000,
			<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \&#34;account1\&#34; }&#34;</span>,
			<span style=color:#4070a0>&#34;op&#34;</span> : <span style=color:#666>{</span>
				<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>,
				<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;edwrad&#34;</span>,
				<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>700</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;writeConcernErrors&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;nInserted&#34;</span> : 0, <span style=color:#60a0b0;font-style:italic>#注意这里，插入条数为0</span>
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nRemoved&#34;</span> : 0,
	<span style=color:#4070a0>&#34;upserted&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 乱序写出现错误时</span>
&gt; try <span style=color:#666>{</span>
... db.accounts.insertMany<span style=color:#666>(</span> <span style=color:#666>[</span>
...   <span style=color:#666>{</span>
...     _id: <span style=color:#4070a0>&#39;account1&#39;</span>,
...     name: <span style=color:#4070a0>&#39;edwrad&#39;</span>,
...     balance: <span style=color:#40a070>700</span>
...   <span style=color:#666>}</span>,
...   <span style=color:#666>{</span>
...     name: <span style=color:#4070a0>&#39;fred&#39;</span>,
...     balance: <span style=color:#40a070>20</span>
...   <span style=color:#666>}</span>
... <span style=color:#666>]</span>, <span style=color:#666>{</span> ordered: <span style=color:#007020>false</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
... <span style=color:#666>}</span> catch<span style=color:#666>(</span>e<span style=color:#666>)</span> <span style=color:#666>{</span>
...   print<span style=color:#666>(</span>e<span style=color:#666>)</span>
... <span style=color:#666>}</span>
BulkWriteError<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;writeErrors&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;index&#34;</span> : 0,
			<span style=color:#4070a0>&#34;code&#34;</span> : 11000,
			<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;E11000 duplicate key error collection: test.accounts index: _id_ dup key: { : \&#34;account1\&#34; }&#34;</span>,
			<span style=color:#4070a0>&#34;op&#34;</span> : <span style=color:#666>{</span>
				<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>,
				<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;edwrad&#34;</span>,
				<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>700</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;writeConcernErrors&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;nInserted&#34;</span> : 1, <span style=color:#60a0b0;font-style:italic>#成功插入了1条</span>
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nRemoved&#34;</span> : 0,
	<span style=color:#4070a0>&#34;upserted&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>
<span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>总结
<code>db.collection.insertMany()</code> 处理错误的方式:</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{
    <span style=color:#40a070>_</span>id<span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>,
    name<span style=color:#666>:</span> <span style=color:#4070a0>&#34;edwrad&#34;</span>,        <span style=color:#666>-------&gt;</span> 错误的文档
    balance<span style=color:#666>:</span> <span style=color:#40a070>700</span>
}
{
    name<span style=color:#666>:</span> <span style=color:#4070a0>&#34;fred&#34;</span>,          <span style=color:#666>-------&gt;</span> 正确的文档
    balance<span style=color:#666>:</span> <span style=color:#40a070>20</span>
}
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>在顺序写入时，一旦遇到错误，操作便会退出，剩余的文档无论正确与否，都不会被写入
所以，上面这两个文档都不会被写入到数据库
在乱序写入时，即使某些文档造成了错误，剩余的正确的文档仍然会被写入
所以，第二篇文档会被正常写入数据库</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># insert 命令</span>
<span style=color:#60a0b0;font-style:italic># 创建单个或多个文档</span>
&gt; db.accounts.insert<span style=color:#666>(</span>
... <span style=color:#666>{</span>
...   name: <span style=color:#4070a0>&#39;george&#39;</span>,
...   balance: <span style=color:#40a070>1000</span>
... <span style=color:#666>}</span>
... <span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nInserted&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

&gt; db.accounts.insert<span style=color:#666>(</span> <span style=color:#666>[</span>
...  <span style=color:#666>{</span>
...    name: <span style=color:#4070a0>&#39;abc&#39;</span>,
...    balance: <span style=color:#40a070>200</span>
...  <span style=color:#666>}</span>,
...  <span style=color:#666>{</span>
...    name: <span style=color:#4070a0>&#39;xyz&#39;</span>,
...    balance: <span style=color:#40a070>200</span>
...  <span style=color:#666>}</span>
<span style=color:#666>]</span> <span style=color:#666>)</span>
BulkWriteResult<span style=color:#666>({</span>
    <span style=color:#4070a0>&#34;writeErrors&#34;</span>: <span style=color:#666>[</span> <span style=color:#666>]</span>,
    <span style=color:#4070a0>&#34;writeConcernErrors&#34;</span>: <span style=color:#666>[</span> <span style=color:#666>]</span>,
    <span style=color:#4070a0>&#34;nInserted&#34;</span>: 2,
    <span style=color:#4070a0>&#34;nUpserted&#34;</span>: 0,
    <span style=color:#4070a0>&#34;nMatched&#34;</span>: 0,
    <span style=color:#4070a0>&#34;nModified&#34;</span>: 0,
    <span style=color:#4070a0>&#34;nRemoved&#34;</span>: 0,
    <span style=color:#4070a0>&#34;upserted&#34;</span>: <span style=color:#666>[</span> <span style=color:#666>]</span>
<span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># save 创建单一文档</span>
&gt; db.accounts.save<span style=color:#666>(</span>
    <span style=color:#666>{</span>
        name: <span style=color:#4070a0>&#39;&#39;</span>,
        balance: <span style=color:#40a070>200</span>
    <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        writeConcern: &lt;document&gt;
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
<span style=color:#60a0b0;font-style:italic># save 会调用 insert 创建文档，所以 save 的返回类型和 insert 相同</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=对象主键>对象主键 <a href=#%e5%af%b9%e8%b1%a1%e4%b8%bb%e9%94%ae class=anchor>¶</a></h3>
<p>默认的对象主键 objectId</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 生成objectId主键</span>
&gt; ObjectId<span style=color:#666>()</span>
ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0ec0672e77e7cb392a90b&#34;</span><span style=color:#666>)</span>

<span style=color:#60a0b0;font-style:italic># 提前 ObjectId 的创建时间</span>
&gt; ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0ec0672e77e7cb392a90b&#34;</span><span style=color:#666>)</span>.getTimestamp<span style=color:#666>()</span>
ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2019-05-19T05:39:18Z&#34;</span><span style=color:#666>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=复合主键>复合主键 <a href=#%e5%a4%8d%e5%90%88%e4%b8%bb%e9%94%ae class=anchor>¶</a></h3>
<p>可以使用文档作为文档的主键</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.insert<span style=color:#666>(</span>
    <span style=color:#666>{</span>
        _id: <span style=color:#666>{</span> accountNo: <span style=color:#4070a0>&#34;001&#34;</span>, type: <span style=color:#4070a0>&#34;savings&#34;</span> <span style=color:#666>}</span>,
        name: <span style=color:#4070a0>&#34;irene&#34;</span>,
        balance: <span style=color:#40a070>80</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=读取文档>读取文档 <a href=#%e8%af%bb%e5%8f%96%e6%96%87%e6%a1%a3 class=anchor>¶</a></h3>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># find 支持匹配查询和投射</span>
db.&lt;collection&gt;.find<span style=color:#666>(</span>&lt;query&gt;, &lt;projection&gt;<span style=color:#666>)</span>
&lt;query&gt;定义了搜索条件
&lt;projection&gt;定义了投射，可以只返回结果文档中的部分字段

<span style=color:#60a0b0;font-style:italic># 读取全部文档</span>
<span style=color:#60a0b0;font-style:italic># 既不筛选，也不投射</span>
&gt; db.accounts.find<span style=color:#666>()</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 格式化结果</span>
&gt; db.accounts.find<span style=color:#666>()</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>,
		<span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span>
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>,
		<span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span>
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span>
<span style=color:#666>}</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>,
		<span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span>
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=匹配查询>匹配查询 <a href=#%e5%8c%b9%e9%85%8d%e6%9f%a5%e8%af%a2 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 筛选文档</span>
<span style=color:#60a0b0;font-style:italic># 匹配查询</span>
语法: <span style=color:#666>{</span> &lt;field&gt;: &lt;value&gt;, ... <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取 alice 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取 alice 的余额为100元的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;alice&#34;</span>, balance: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取 alice 的余额为200元的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;alice&#34;</span>, balance: <span style=color:#40a070>200</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
不存在

<span style=color:#60a0b0;font-style:italic># 读取银行账户类型为 savings 的文档 (复合主键)</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id.type&#34;</span>: <span style=color:#4070a0>&#34;savings&#34;</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=比较操作符>比较操作符 <a href=#%e6%af%94%e8%be%83%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 筛选文档</span>
<span style=color:#60a0b0;font-style:italic># 比较操作符</span>

<span style=color:#bb60d5>$eq</span>     equal
<span style=color:#bb60d5>$ne</span>     not equal
<span style=color:#bb60d5>$gt</span>     great than
<span style=color:#bb60d5>$gte</span>    great than or equal
<span style=color:#bb60d5>$lt</span>     less than
<span style=color:#bb60d5>$lte</span>    less than or equal

语法: <span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> $&lt;operator&gt;: &lt;value&gt; <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取 alice 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$eq</span>: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#60a0b0;font-style:italic># 与 db.accounts.find( { name: &#34;alice&#34; } ) 的查询效果相同</span>

<span style=color:#60a0b0;font-style:italic># 读取不属于 alice 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$ne</span>: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取所有余额不等于100的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$ne</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取余额大于200的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#40a070>200</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>


<span style=color:#bb60d5>$in</span>     匹配字段值与任一查询值相等的文档
<span style=color:#bb60d5>$nin</span>    匹配字段值与任何查询值都不相等的文档

语法: <span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$in</span>: <span style=color:#666>[</span> &lt;value1&gt;, &lt;value2&gt;, ... <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取 alice 和 charlie 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$in</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取除了 alice 和 charlie 以外的其他用户的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$nin</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>$ne</code>会筛选出并不包含查询字段的文档
比如，读取银行账户类型不是 <code>savings</code> 的文档:
<code>db.accounts.find( { "_id.type": { $ne: "savings" } } )</code></p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>50</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>500</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>200</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>20</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>1000</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;003&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>500</span> }
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看到，结果中有很多文档并没有包含 <code>_id.type</code> 这个字段
可以配合下面的 <code>$exists</code> 操作符一块使用
与 <code>$ne</code> 类似，<code>$nin</code> 也会筛选出并不包含查询字段的文档
比如，读取账户类型不是 <code>savings</code> 的银行账户文档:
<code>db.accounts.find( { "_id.type": { $nin: [ "savings" ] } } )</code></p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>50</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>500</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>200</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>20</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>1000</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;003&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>500</span> }
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看到，结果中有很多文档并没有包含 <code>_id.type</code> 这个字段
可以配合下面的 <code>$exists</code> 操作符一块使用</p>
</blockquote>
<h4 id=逻辑操作符>逻辑操作符 <a href=#%e9%80%bb%e8%be%91%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">92
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 筛选文档</span>
<span style=color:#60a0b0;font-style:italic># 逻辑操作符查询</span>

<span style=color:#bb60d5>$not</span>    匹配筛选条件不成立的文档
<span style=color:#bb60d5>$and</span>    匹配多个筛选条件全部成立的文档
<span style=color:#bb60d5>$or</span>     匹配至少一个筛选条件成立的文档
<span style=color:#bb60d5>$nor</span>    匹配多个筛选条件全部不成立的文档


<span style=color:#bb60d5>$not</span> 语法:
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$not</span>: <span style=color:#666>{</span> &lt;operator-expression&gt; <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取余额不小于200的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$not</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>200</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>


<span style=color:#bb60d5>$and</span> 语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$and</span>: <span style=color:#666>[</span> <span style=color:#666>{</span> &lt;expression1&gt; <span style=color:#666>}</span>, <span style=color:#666>{</span> &lt;expression2&gt; <span style=color:#666>}</span>, ... <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取余额大于100并且用户姓名排在 fred 之后的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> <span style=color:#bb60d5>$and</span>: <span style=color:#666>[</span>
    <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;fred&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>]</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 当筛选条件应用在不同字段上时，可以省略 $and 操作符</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span>, name: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;fred&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
和上面的查询效果相同

<span style=color:#60a0b0;font-style:italic># 当筛选条件应用在同一个字段上时，也可以简化命令</span>
<span style=color:#60a0b0;font-style:italic># 读取余额大于100并且小于500的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> <span style=color:#bb60d5>$and</span>: <span style=color:#666>[</span>
    <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>500</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>]</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>

&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: 100, <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>500</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>


<span style=color:#bb60d5>$or</span> 语法:<span style=color:#666>(</span>与 <span style=color:#bb60d5>$and</span> 类似<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#bb60d5>$or</span>: <span style=color:#666>[</span> <span style=color:#666>{</span> &lt;expression1&gt; <span style=color:#666>}</span>, <span style=color:#666>{</span> &lt;expression2&gt; <span style=color:#666>}</span>, ... <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取属于 alice 或者 charlie 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> <span style=color:#bb60d5>$or</span>: <span style=color:#666>[</span> 
    <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$eq</span>: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$eq</span>: <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>]</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 当所有筛选条件使用的都是 $eq 操作符时，$or 和 $in 的效果是相同的</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$in</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取余额小于100或者大于500的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> <span style=color:#bb60d5>$or</span>: <span style=color:#666>[</span>
    <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#40a070>500</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>]</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>


<span style=color:#bb60d5>$nor</span> 语法:<span style=color:#666>(</span>与 <span style=color:#bb60d5>$and</span> 类似<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#bb60d5>$nor</span>: <span style=color:#666>[</span> <span style=color:#666>{</span> &lt;expression1&gt; <span style=color:#666>}</span>, <span style=color:#666>{</span> &lt;expression2&gt; <span style=color:#666>}</span>, ... <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取不属于 alice 和 charlie 且余额不小于100的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> <span style=color:#bb60d5>$nor</span>: <span style=color:#666>[</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>]</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>$not</code> 和 <code>$nor</code> 也会筛选出并不包含查询字段的文档
可以配合下面的 <code>$exists</code> 操作符一块使用</p>
</blockquote>
<h4 id=字段操作符>字段操作符 <a href=#%e5%ad%97%e6%ae%b5%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 筛选文档</span>
<span style=color:#60a0b0;font-style:italic># 字段操作符</span>

<span style=color:#bb60d5>$exists</span>     匹配包含查询字段的文档
<span style=color:#bb60d5>$type</span>       匹配字段类型符合查询值的文档


<span style=color:#bb60d5>$exists</span> 语法:
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$exists</span>: &lt;boolean&gt; <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取包含账户类型字段的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id.type&#34;</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$exists</span>: <span style=color:#007020>true</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id.type&#34;</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$ne</span>: <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#bb60d5>$exists</span>: <span style=color:#007020>true</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>


<span style=color:#bb60d5>$type</span> 语法:
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$type</span>: &lt;BSON type&gt; <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$type</span>: <span style=color:#666>[</span> &lt;BSON type1&gt;, &lt;BSON type2&gt;, ... <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取文档主键是字符串的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> _id: <span style=color:#666>{</span> <span style=color:#bb60d5>$type</span>: <span style=color:#4070a0>&#34;string&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取文档主键是对象主键或者复合主键的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> _id: <span style=color:#666>{</span> <span style=color:#bb60d5>$type</span>: <span style=color:#666>[</span><span style=color:#4070a0>&#34;objectId&#34;</span>, <span style=color:#4070a0>&#34;object&#34;</span><span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取用户姓名是 null 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$type</span>: <span style=color:#4070a0>&#34;null&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>

除了使用BSON类型名称作为 <span style=color:#bb60d5>$type</span> 操作符的参数，我们还可以使用类型序号。比如
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> _id: <span style=color:#666>{</span> <span style=color:#bb60d5>$type</span>: <span style=color:#40a070>2</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>

</code></pre></td></tr></table>
</div>
</div><h4 id=数组操作符>数组操作符 <a href=#%e6%95%b0%e7%bb%84%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 筛选文档</span>
<span style=color:#60a0b0;font-style:italic># 数组操作符</span>

<span style=color:#bb60d5>$all</span>        匹配数组字段中包含所有查询值的文档
<span style=color:#bb60d5>$elemMatch</span>  匹配数组字段中至少存在一个值满足筛选条件的文档


<span style=color:#bb60d5>$all</span> 语法:
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$all</span>: <span style=color:#666>[</span> &lt;value1&gt;, &lt;value2&gt;, ... <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 首先，为了练习这个操作符，我们先创建一些包含数组和嵌套数组的文档</span>
&gt; db.accounts.insert<span style=color:#666>([</span>
    <span style=color:#666>{</span>
        name: <span style=color:#4070a0>&#34;jack&#34;</span>,
        balance: 2000,
        contact: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span>
    <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        name: <span style=color:#4070a0>&#34;karen&#34;</span>,
        balance: 2500,
        contact: <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span>
    <span style=color:#666>}</span>
<span style=color:#666>])</span>
BulkWriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;writeErrors&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;writeConcernErrors&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;nInserted&#34;</span> : 2,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nRemoved&#34;</span> : 0,
	<span style=color:#4070a0>&#34;upserted&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>]</span>
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 读取联系地址位于中国北京的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$all</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;China&#34;</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2500, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取联系电话包含 22222222 和 33333333 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$all</span>: <span style=color:#666>[</span> <span style=color:#666>[</span><span style=color:#4070a0>&#34;22222222&#34;</span>,<span style=color:#4070a0>&#34;33333333&#34;</span><span style=color:#666>]</span> <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2500, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$all</span>: <span style=color:#666>[</span> <span style=color:#666>[</span><span style=color:#4070a0>&#34;33333333&#34;</span>,<span style=color:#4070a0>&#34;22222222&#34;</span><span style=color:#666>]</span> <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
不匹配任何文档


<span style=color:#bb60d5>$elemMatch</span> 语法:
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> &lt;query1&gt;, &lt;query2&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取联系电话范围在 10000000 至 20000000 之间的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;10000000&#34;</span>, <span style=color:#bb60d5>$lt</span>: <span style=color:#4070a0>&#34;20000000&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2000, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取包含一个在 10000000 至 20000000 之间，和一个在 20000000 至 30000000 之间的联系电话的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span>
    contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$all</span>: <span style=color:#666>[</span>
        <span style=color:#666>{</span> <span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;10000000&#34;</span>, <span style=color:#bb60d5>$lt</span>: <span style=color:#4070a0>&#34;20000000&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
        <span style=color:#666>{</span> <span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;20000000&#34;</span>, <span style=color:#bb60d5>$lt</span>: <span style=color:#4070a0>&#34;30000000&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
    <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>}</span> <span style=color:#666>)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=运算操作符>运算操作符 <a href=#%e8%bf%90%e7%ae%97%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 筛选文档</span>
<span style=color:#60a0b0;font-style:italic># 运算操作符</span>

<span style=color:#bb60d5>$regex</span>      匹配满足正则表达式的文档

语法:
<span style=color:#666>{</span> &lt;field&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$regex</span>: /pattern/, <span style=color:#bb60d5>$options</span>: <span style=color:#4070a0>&#34;&lt;options&gt;&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>  <span style=color:#60a0b0;font-style:italic># 大部分场景使用该语法</span>
<span style=color:#666>{</span> &lt;field&gt;: /pattern/&lt;options&gt; <span style=color:#666>}</span>        <span style=color:#60a0b0;font-style:italic># 特定场景使用该语法</span>

兼容 PCRE v8.41 正则表达式库
在与 <span style=color:#bb60d5>$in</span> 操作符配合使用时，只能使用 /pattern/&lt;options&gt; 语法

<span style=color:#60a0b0;font-style:italic># 读取用户姓名以 c 或者 j 开头的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$in</span>: <span style=color:#666>[</span> /^c/, /^j/ <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2000, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取用户姓名包含 LIE (不区分大小写)的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#666>{</span> <span style=color:#bb60d5>$regex</span>: /LIE/, <span style=color:#bb60d5>$options</span>: <span style=color:#4070a0>&#39;i&#39;</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>

&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: /LIE/i <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=文档游标>文档游标 <a href=#%e6%96%87%e6%a1%a3%e6%b8%b8%e6%a0%87 class=anchor>¶</a></h3>
<p><code>db.collection.find()</code> 返回的是一个文档集合游标</p>
<p>在<strong>不迭代</strong>游标的情况下，只列出前20个文档:</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> <span style=color:#007020;font-weight:700>var</span> myCursor <span style=color:#666>=</span> db.accounts.find();
<span style=color:#666>&gt;</span> myCursor
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>50</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>500</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>200</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>20</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>1000</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;001&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>200</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;002&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;003&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>500</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>2000</span>, <span style=color:#4070a0>&#34;contact&#34;</span> <span style=color:#666>:</span> [ <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> ] }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>2500</span>, <span style=color:#4070a0>&#34;contact&#34;</span> <span style=color:#666>:</span> [ [ <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> ], <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> ] }
<span style=color:#60a0b0;font-style:italic>// 这里由于我们的文档总数不足20，所以看不出效果
</span></code></pre></td></tr></table>
</div>
</div><p>我们也可以使用游标下标直接访问文档集合中的某一个文档，<strong>下标从0开始</strong>:</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> <span style=color:#007020;font-weight:700>var</span> myCursor <span style=color:#666>=</span> db.accounts.find();
<span style=color:#666>&gt;</span> myCursor[<span style=color:#40a070>1</span>]
{
	<span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span>),
	<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;bob&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>50</span>
}
</code></pre></td></tr></table>
</div>
</div><p>默认情况下，遍历完游标中所有的文档之后，或者在10分钟之后，游标便会自动关闭</p>
<p>我们可以使用 <code>noCursorTimeout()</code> 函数来保持游标一直有效</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> <span style=color:#007020;font-weight:700>var</span> myCursor <span style=color:#666>=</span> db.accounts.find().noCursorTimeout();
</code></pre></td></tr></table>
</div>
</div><p>在这之后，如果我们遍历完了游标，游标会自动关闭。但是如果在不遍历游标的情况下，需要主动关闭游标</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> myCursor.close();
</code></pre></td></tr></table>
</div>
</div><h3 id=游标函数>游标函数 <a href=#%e6%b8%b8%e6%a0%87%e5%87%bd%e6%95%b0 class=anchor>¶</a></h3>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>cursor.hasNext()
cursor.next()
cursor.forEach()
cursor.limit()
cursor.skip()
cursor.count()
cursor.sort()
</code></pre></td></tr></table>
</div>
</div><h4 id=hasnext-和-next-函数>hasNext 和 next 函数 <a href=#hasnext-%e5%92%8c-next-%e5%87%bd%e6%95%b0 class=anchor>¶</a></h4>
<blockquote>
<p>hasNext 和 next 用于遍历游标</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> <span style=color:#007020;font-weight:700>var</span> myCursor <span style=color:#666>=</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> });
<span style=color:#666>&gt;</span> <span style=color:#007020;font-weight:700>while</span>( myCursor.hasNext() ) {
    printjson(myCursor.next());
}
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{
	<span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>),
	<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span>
}
{
	<span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> {
		<span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>,
		<span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;002&#34;</span>
	},
	<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span>
}
</code></pre></td></tr></table>
</div>
</div><h4 id=foreach-函数>forEach 函数 <a href=#foreach-%e5%87%bd%e6%95%b0 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> <span style=color:#007020;font-weight:700>var</span> myCursor <span style=color:#666>=</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> });
<span style=color:#666>&gt;</span> myCursor.forEach(printjson);
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{
	<span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>),
	<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span>
}
{
	<span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> {
		<span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>,
		<span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;002&#34;</span>
	},
	<span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span>
}
</code></pre></td></tr></table>
</div>
</div><h4 id=limit-和-skip-函数>limit 和 skip 函数 <a href=#limit-%e5%92%8c-skip-%e5%87%bd%e6%95%b0 class=anchor>¶</a></h4>
<blockquote>
<p>这两个函数通常用于分页</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>cursor.limit(<span style=color:#666>&lt;</span>number<span style=color:#666>&gt;</span>)
cursor.skip(<span style=color:#666>&lt;</span>offset<span style=color:#666>&gt;</span>)
<span style=color:#666>&gt;</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> }).limit(<span style=color:#40a070>1</span>)
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }

<span style=color:#666>&gt;</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> }).skip(<span style=color:#40a070>1</span>)
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;002&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>问题:
如果使用 <code>cursor.limit(0)</code> 会返回什么结果呢？
答案: </p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;002&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>不对游标进行任何限制，与 <code>limit()</code> 以及不进行调用效果相同。
也就是说，默认返回前20个文档？</p>
</blockquote>
<h4 id=count-函数>count 函数 <a href=#count-%e5%87%bd%e6%95%b0 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>cursor.count(<span style=color:#666>&lt;</span>applySkipLimit<span style=color:#666>&gt;</span>)
</code></pre></td></tr></table>
</div>
</div><p>默认情况下，<code>&lt;applySkipLimit></code> 为 <code>false</code>，即 <code>cursor.count()</code> 不会考虑 <code>cursor.skip()</code> 和 <code>cursor.limit()</code> 的效果</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> })
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;002&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }

<span style=color:#666>&gt;</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> }).limit(<span style=color:#40a070>1</span>).count()
<span style=color:#40a070>3</span>

<span style=color:#666>&gt;</span> db.accounts.find({ balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> }).limit(<span style=color:#40a070>1</span>).count(<span style=color:#007020;font-weight:700>true</span>)
<span style=color:#40a070>1</span>
</code></pre></td></tr></table>
</div>
</div><div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 在不提供筛选条件时，cursor.count() 会从集合的元数据 Metadata 中取得结果，而不会遍历集合</span>
&gt; db.accounts.find<span style=color:#666>()</span>.count<span style=color:#666>()</span>
<span style=color:#40a070>22</span>
&gt; db.accounts.count<span style=color:#666>()</span>
<span style=color:#40a070>22</span>

<span style=color:#60a0b0;font-style:italic># 当数据库分布式结构较为复杂时，元数据中的文档数量可能不准确</span>
<span style=color:#60a0b0;font-style:italic># 在这种情况下，应该避免使用不提供筛选条件的 cursor.count() 函数，而使用聚合管道来计算文档数量</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=sort-函数>sort 函数 <a href=#sort-%e5%87%bd%e6%95%b0 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>cursor.sort(<span style=color:#666>&lt;</span><span style=color:#007020>document</span><span style=color:#666>&gt;</span>)
</code></pre></td></tr></table>
</div>
</div><p>这里的 <code>&lt;document></code> 定义了排序的要求，<code>{ field: ordering}</code></p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>1表示递增排序
-1表示递减排序

<span style=color:#60a0b0;font-style:italic># 按照余额从大到小，用户姓名按字母排序的方式排列银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>()</span>.sort<span style=color:#666>(</span> <span style=color:#666>{</span> balance: -1, name: <span style=color:#40a070>1</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2500, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2000, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>1000</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225972e77e7cb392a90f&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225b72e77e7cb392a910&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225c72e77e7cb392a911&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225d72e77e7cb392a912&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225d72e77e7cb392a913&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225e72e77e7cb392a914&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1226b72e77e7cb392a915&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1226b72e77e7cb392a916&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1226c72e77e7cb392a917&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1226d72e77e7cb392a918&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
Type <span style=color:#4070a0>&#34;it&#34;</span> <span style=color:#007020;font-weight:700>for</span> more
&gt; it
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 读取余额最大的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>()</span>.sort<span style=color:#666>({</span> balance: -1 <span style=color:#666>})</span>.limit<span style=color:#666>(</span>1<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 2500, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>cursor.skip()</code>, <code>cursor.limit()</code>, <code>cursor.sort()</code>的执行顺序
原则一: <code>cursor.skip()</code>永远在<code>cursor.limit()</code>之前执行</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.find().limit(<span style=color:#40a070>5</span>).skip(<span style=color:#40a070>3</span>)
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>从书写顺序看，是先执行了<code>limit(5)</code>拿到5条数据，然后执行<code>skip(3)</code>跳过3条数据，结果就剩2条数据了。
但是执行结果如下</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>200</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>20</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>1000</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> ObjectId(<span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span>), <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>100</span> }
{ <span style=color:#4070a0>&#34;_id&#34;</span> <span style=color:#666>:</span> { <span style=color:#4070a0>&#34;type&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;001&#34;</span> }, <span style=color:#4070a0>&#34;name&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>200</span> }
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>实际执行顺序是，<code>find()</code>拿到所有文档数量，<code>skip(3)</code>跳过前3条，然后<code>limit(5)</code>取出接下来的5条数据
原则二: <code>cursor.sort()</code>永远在<code>cursor.skip()</code>和<code>cursor.limit()</code>之前执行</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.find().skip(<span style=color:#40a070>3</span>).limit(<span style=color:#40a070>5</span>).sort({ balance<span style=color:#666>:</span> <span style=color:#666>-</span><span style=color:#40a070>1</span> })
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>先执行<code>sort({ balance: -1 })</code>按照余额降序排序，然后执行<code>skip(3)</code>跳过前3条，最后执行<code>limit(5)</code>取出接下来的5条数据
与 <code>db.accounts.find().limit(5).skip(3).sort({ balance: -1 })</code>的结果相同，不管书写顺序如何，执行顺序永远是:
<code>sort()</code> > <code>skip()</code> > <code>limit()</code></p>
</blockquote>
<h3 id=文档投射>文档投射 <a href=#%e6%96%87%e6%a1%a3%e6%8a%95%e5%b0%84 class=anchor>¶</a></h3>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>db.collection.find(<span style=color:#666>&lt;</span>query<span style=color:#666>&gt;</span>, <span style=color:#666>&lt;</span>projection<span style=color:#666>&gt;</span>)
</code></pre></td></tr></table>
</div>
</div><p>不使用投射时，<code>db.collection.find()</code>返回符合筛选条件的完整文档，而使用投射可以有选择性的返回文档中的部分字段</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>projection: <span style=color:#666>{</span> field: inclusion <span style=color:#666>}</span>
<span style=color:#40a070>1</span> 表示返回该字段
<span style=color:#40a070>0</span> 表示不返回该字段

<span style=color:#60a0b0;font-style:italic># 只返回银行账户文档中的用户姓名</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> name: <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 只返回银行账户文档中的用户姓名(不包含文档主键)</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> name: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 不返回银行账户文档中的用户姓名(也不返回文档主键)</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> name: 0, _id: <span style=color:#40a070>0</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>500</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;balance&#34;</span> : 2000, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;balance&#34;</span> : 2500, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>projection</code>参数不能混用包含与不包含这两种投射操作，文档主键除外</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.find({}, { name<span style=color:#666>:</span> <span style=color:#40a070>1</span>, balance<span style=color:#666>:</span> <span style=color:#40a070>0</span>, <span style=color:#40a070>_</span>id<span style=color:#666>:</span> <span style=color:#40a070>0</span> })
<span style=color:#007020>Error</span><span style=color:#666>:</span> error<span style=color:#666>:</span> {
	<span style=color:#4070a0>&#34;ok&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>0</span>,
	<span style=color:#4070a0>&#34;errmsg&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;Projection cannot have a mix of inclusion and exclusion.&#34;</span>,
	<span style=color:#4070a0>&#34;code&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>2</span>,
	<span style=color:#4070a0>&#34;codeName&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;BadValue&#34;</span>
}
</code></pre></td></tr></table>
</div>
</div><h4 id=在数组字段上使用投射>在数组字段上使用投射 <a href=#%e5%9c%a8%e6%95%b0%e7%bb%84%e5%ad%97%e6%ae%b5%e4%b8%8a%e4%bd%bf%e7%94%a8%e6%8a%95%e5%b0%84 class=anchor>¶</a></h4>
<p><code>$slice</code>操作符可以返回数组字段中的部分元素</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 不使用 slice 操作符</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> _id: 0, name: 1, contact: <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span>, <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span>, <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 返回 contact 字段的第一个元素</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> _id: 0, name: 1, contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$slice</span>: <span style=color:#40a070>1</span> <span style=color:#666>}</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;11111111&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#666>[</span> <span style=color:#4070a0>&#34;22222222&#34;</span>, <span style=color:#4070a0>&#34;33333333&#34;</span> <span style=color:#666>]</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 返回 contact 字段最后一个元素</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> _id: 0, name: 1, contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$slice</span>: -1 <span style=color:#666>}</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 返回 contact 字段的最后两个元素</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> _id: 0, name: 1, contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$slice</span>: -2 <span style=color:#666>}</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 对 contact 字段先执行一个 skip(1) 操作，然后执行 limit(2) 操作</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span> _id: 0, name: 1, contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$slice</span>: <span style=color:#666>[</span>1, 2<span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;Alabama&#34;</span>, <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;Beijing&#34;</span>, <span style=color:#4070a0>&#34;China&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>$elemMatch</code>和<code>$</code>操作符可以返回数组字段中，满足筛选条件的第一个元素</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 返回 contact 中大于 Alabama 的第一个元素</span>
&gt; db.accounts.find<span style=color:#666>({}</span>, <span style=color:#666>{</span>
    _id: 0,
    name: 1,
    contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;Alabama&#34;</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;US&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;Beijing&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 使用&lt;query&gt;参数中 contact 的筛选条件作为 projection 中 contact 的投射操作</span>
<span style=color:#60a0b0;font-style:italic># 是上面 $elemMatch 的简写形式</span>
&gt; db.accounts.find<span style=color:#666>({</span>
    contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#4070a0>&#34;Alabama&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>}</span>, <span style=color:#666>{</span>
    _id: 0,
    name: 1,
    <span style=color:#4070a0>&#34;contact.</span>$<span style=color:#4070a0>&#34;</span>: <span style=color:#40a070>1</span>  <span style=color:#60a0b0;font-style:italic># contact: { $elemMatch: { $gt: &#34;Alabama&#34; } } 的简写形式？</span>
<span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>？疑问</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.find({ contact<span style=color:#666>:</span> { $gt<span style=color:#666>:</span> <span style=color:#4070a0>&#34;Alabama&#34;</span> } })
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>是查询出<code>contact</code>字段大于字符串<code>Alabama</code>的文档，但是<code>contact</code>是数组类型，数组是如何与字符串进行比较操作的？</p>
</blockquote>
<h2 id=更新文档>更新文档 <a href=#%e6%9b%b4%e6%96%b0%e6%96%87%e6%a1%a3 class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法: db.&lt;collection&gt;.update<span style=color:#666>(</span>&lt;query&gt;, &lt;update&gt;, &lt;options&gt;<span style=color:#666>)</span>

<span style=color:#60a0b0;font-style:italic># &lt;query&gt; 文档定义了更新文档时筛选文档的条件，也就是说，要更新哪些文档</span>
<span style=color:#60a0b0;font-style:italic># 与 db.collection.find() 中的 query 相同</span>

<span style=color:#60a0b0;font-style:italic># &lt;update&gt; 文档提供了更新的内容，也就是说，要进行什么样的更新</span>

<span style=color:#60a0b0;font-style:italic># &lt;options&gt; 文档声明了一些应用于更新操作的选项和参数</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=更新整篇文档>更新整篇文档 <a href=#%e6%9b%b4%e6%96%b0%e6%95%b4%e7%af%87%e6%96%87%e6%a1%a3 class=anchor>¶</a></h3>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 如果 &lt;update&gt; 文档不包含任何更新操作符，则会更新整个文档。</span>
<span style=color:#60a0b0;font-style:italic># 执行的是替换操作</span>

<span style=color:#60a0b0;font-style:italic># 检查 alice 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 将 alice 的账户余额更改为123</span>
&gt; db.accounts.update<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span>, <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;alice&#34;</span>, balance: <span style=color:#40a070>123</span> <span style=color:#666>})</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 检查 alice 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>123</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
第一，文档主键 <code>_id</code> <strong>在任何情况下</strong>都是不可以更改的
如果我们在 <code>&lt;update></code>文档中包含<code>_id</code>字段，则<code>_id</code>值一定要和被更新文档的<code>_id</code>值保持一致</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.update({ name<span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span> }, { <span style=color:#40a070>_</span>id<span style=color:#666>:</span> <span style=color:#4070a0>&#34;account1&#34;</span>, name<span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, balance<span style=color:#666>:</span> <span style=color:#40a070>100</span> })
WriteResult({ <span style=color:#4070a0>&#34;nMatched&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>1</span>, <span style=color:#4070a0>&#34;nUpserted&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>0</span>, <span style=color:#4070a0>&#34;nModified&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>1</span> })
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如果<code>&lt;update></code>文档中包含的<code>_id</code>字段和被更新的文档<code>_id</code>值不一致，则会更新失败</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#666>&gt;</span> db.accounts.update({ name<span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span> }, { <span style=color:#40a070>_</span>id<span style=color:#666>:</span> <span style=color:#4070a0>&#34;account2&#34;</span>, name<span style=color:#666>:</span> <span style=color:#4070a0>&#34;alice&#34;</span>, balance<span style=color:#666>:</span> <span style=color:#40a070>123</span> })
WriteResult({
	<span style=color:#4070a0>&#34;nMatched&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>0</span>,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>0</span>,
	<span style=color:#4070a0>&#34;nModified&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>0</span>,
	<span style=color:#4070a0>&#34;writeError&#34;</span> <span style=color:#666>:</span> {
		<span style=color:#4070a0>&#34;code&#34;</span> <span style=color:#666>:</span> <span style=color:#40a070>66</span>,
		<span style=color:#4070a0>&#34;errmsg&#34;</span> <span style=color:#666>:</span> <span style=color:#4070a0>&#34;After applying the update, the (immutable) field &#39;_id&#39; was found to have been altered to _id: \&#34;account2\&#34;&#34;</span>
	}
})
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>第二，在使用<code>&lt;update></code>文档替换整篇被更新文档时，只有<strong>第一篇</strong>符合<code>&lt;query></code>筛选条件的文档才会被更新</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 查看账户余额在0到100之间的账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: 0, <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bob&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>50</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新账户余额在0到100之间的账户文档</span>
&gt; db.accounts.update<span style=color:#666>({</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: 0, <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span>, <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;bill&#34;</span>, balance: 80, gender: <span style=color:#4070a0>&#34;M&#34;</span> <span style=color:#666>}</span> <span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看账户余额在0到100之间的账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: 0, <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bill&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 80, <span style=color:#4070a0>&#34;gender&#34;</span> : <span style=color:#4070a0>&#34;M&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>也就是说，更新整篇文档的操作，只能应用在单一文档上</p>
</blockquote>
<h3 id=更新特定字段>更新特定字段 <a href=#%e6%9b%b4%e6%96%b0%e7%89%b9%e5%ae%9a%e5%ad%97%e6%ae%b5 class=anchor>¶</a></h3>
<p>如果<code>&lt;update></code>文档只包含更新操作符，<code>db.collection.update()</code>将会使用<code>&lt;update></code>文档更新集合中符合<code>&lt;query></code>筛选条件的所有文档中的特定字段</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 文档更新操作符</span>

<span style=color:#bb60d5>$set</span>        更新或新增字段
<span style=color:#bb60d5>$unset</span>      删除字段
<span style=color:#bb60d5>$rename</span>     重命名字段
<span style=color:#bb60d5>$inc</span>        加减字段值
<span style=color:#bb60d5>$mul</span>        相乘字段值
<span style=color:#bb60d5>$min</span>        比较减小字段值
<span style=color:#bb60d5>$max</span>        比较增大字段值
</code></pre></td></tr></table>
</div>
</div><h4 id=set操作符>$set操作符 <a href=#set%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>更新或新增字段</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value1&gt;, &lt;field2&gt;: &lt;value2&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 2000,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;11111111&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新 jack 的银行账户余额和开户信息</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
            balance: 3000,
            info: <span style=color:#666>{</span>
                dateOpened: new Date<span style=color:#666>(</span><span style=color:#4070a0>&#34;2019-05-18T16:00:00Z&#34;</span><span style=color:#666>)</span>,
                branch: <span style=color:#4070a0>&#34;branch1&#34;</span>
            <span style=color:#666>}</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 3000,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;11111111&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2019-05-18T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## 更新或新增内嵌文档的字段</span>

<span style=color:#60a0b0;font-style:italic># 更新 jack 的银行账户的开户时间</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.dateOpened&#34;</span>: new Date<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 3000,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;11111111&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## 更新或新增数组内的元素</span>

<span style=color:#60a0b0;font-style:italic># 更新 jack 的联系电话</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;contact.0&#34;</span>: <span style=color:#4070a0>&#34;66666666&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 3000,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;66666666&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 添加 jack 的联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;contact.3&#34;</span>: <span style=color:#4070a0>&#34;new contact&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 3000,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;66666666&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>,
		<span style=color:#4070a0>&#34;new contact&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 数组索引可以随便设置</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;contact.10&#34;</span>: <span style=color:#4070a0>&#34;new contact 10&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 3000,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;66666666&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>,
		<span style=color:#4070a0>&#34;new contact&#34;</span>,
		null,
		null,
		null,
		null,
		null,
		null,
		<span style=color:#4070a0>&#34;new contact10&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
如果向现有数组字段范围以外的位置添加新值，数组字段的长度会扩大，未被赋值的数组成员将被设置为<code>null</code></p>
</blockquote>
<h4 id=unset-操作符>$unset 操作符 <a href=#unset-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>删除字段</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$unset</span>: <span style=color:#666>{</span> &lt;field1&gt;: <span style=color:#4070a0>&#34;&#34;</span>, &lt;field2&gt;: <span style=color:#4070a0>&#34;&#34;</span>, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 删除 jack 的银行账户余额和开户地点</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$unset</span>: <span style=color:#666>{</span>
            balance: <span style=color:#4070a0>&#34;&#34;</span>,
            <span style=color:#4070a0>&#34;info.branch&#34;</span>: <span style=color:#4070a0>&#34;&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;66666666&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>,
		<span style=color:#4070a0>&#34;new contact2&#34;</span>,
		null,
		null,
		null,
		null,
		null,
		null,
		<span style=color:#4070a0>&#34;new contact10&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## 删除数组内的字段</span>

<span style=color:#60a0b0;font-style:italic># 删除 jack 的联系电话</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$unset</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;contact.0&#34;</span>: <span style=color:#4070a0>&#34;&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		null,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>,
		<span style=color:#4070a0>&#34;new contact2&#34;</span>,
		null,
		null,
		null,
		null,
		null,
		null,
		<span style=color:#4070a0>&#34;new contact10&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>

	<span style=color:#666>}</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>$unset</code>操作符中的赋值(<code>""</code>)对操作结果并没有任何影响</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 删除 jack 的银行开户时间</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$unset</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.dateOpened&#34;</span>: <span style=color:#4070a0>&#34;this can be any value&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 再次查看 jack 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;66666666&#34;</span>,
		<span style=color:#4070a0>&#34;Alabama&#34;</span>,
		<span style=color:#4070a0>&#34;US&#34;</span>,
		<span style=color:#4070a0>&#34;new contact2&#34;</span>,
		null,
		null,
		null,
		null,
		null,
		null,
		<span style=color:#4070a0>&#34;new contact10&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>

	<span style=color:#666>}</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如果<code>$unset</code>命令中的字段根本不存在，那么文档内容将保持不变</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$unset</span>: <span style=color:#666>{</span>
            notExist: <span style=color:#4070a0>&#34;&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>当使用<code>$unset</code>命令删除数组字段中的某一个元素时，这个元素不会被删除，只会被赋以<code>null</code>值，而数组的长度不会改变</p>
</blockquote>
<h4 id=rename-操作符>$rename 操作符 <a href=#rename-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>重命名字段</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$rename</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;newName1&gt;, &lt;field2&gt;: &lt;newName2&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic>## 重命名内嵌文档的字段</span>

<span style=color:#60a0b0;font-style:italic># 更新 karen 的银行账户的开户时间和联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
            info: <span style=color:#666>{</span>
                dateOpened: new Date<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
                branch: <span style=color:#4070a0>&#34;branch1&#34;</span>
            <span style=color:#666>}</span>,
            <span style=color:#4070a0>&#34;contact.3&#34;</span>: <span style=color:#666>{</span>
                primaryEmail: <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
                secondaryEmail: <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
            <span style=color:#666>}</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;balance&#34;</span> : 2500,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新账户余额和开户地点字段在文档中的位置</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$rename</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.branch&#34;</span>: <span style=color:#4070a0>&#34;branch&#34;</span>,
            <span style=color:#4070a0>&#34;balance&#34;</span>: <span style=color:#4070a0>&#34;info.balance&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>2500</span>
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>
<span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## 重命名数组中内嵌文档的字段</span>

<span style=color:#60a0b0;font-style:italic># 更新 karen 的联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$rename</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;contact.3.primaryEmail&#34;</span>: <span style=color:#4070a0>&#34;primaryEmail&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;writeError&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;code&#34;</span> : 2,
		<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;The source field cannot be an array element, &#39;contact.3.primaryEmail&#39; in doc with _id: ObjectId(&#39;5ce1107d72e77e7cb392a90e&#39;) has an array field called &#39;contact&#39;&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 反向操作</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$rename</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;branch&#34;</span>: <span style=color:#4070a0>&#34;contact.3.branch&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;writeError&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;code&#34;</span> : 2,
		<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;The destination field cannot be an array element, &#39;contact.3.branch&#39; in doc with _id: ObjectId(&#39;5ce1107d72e77e7cb392a90e&#39;) has an array field called &#39;contact&#39;&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
如果<code>$rename</code>命令要重命名的字段在文档中并不存在，那么文档内容不会发生任何改变</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">9
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$rename</span>: <span style=color:#666>{</span>
            notExist: <span style=color:#4070a0>&#34;name&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如果新的字段名已经存在，那么原有的这个字段会被覆盖</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$rename</span>: <span style=color:#666>{</span>
            name: <span style=color:#4070a0>&#34;contact&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;jack&#34;</span> <span style=color:#666>})</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#4070a0>&#34;jack&#34;</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>

	<span style=color:#666>}</span>
        <span style=color:#60a0b0;font-style:italic># 原来的 contact 内容不见了!!!</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>当<code>$rename</code>命令中的新字段存在的时候，<code>$rename</code>命令会先<code>$unset</code>新旧字段，然后再<code>$set</code>新字段
<code>$rename</code>命令中的旧字段和新字段都不可以指向数组元素</p>
</blockquote>
<h4 id=inc-和-mul-操作符>$inc 和 $mul 操作符 <a href=#inc-%e5%92%8c-mul-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>更新字段值</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$inc</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;amount1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#bb60d5>$mul</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;amount1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 查看 david 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新 david 的账户余额</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$inc</span>: <span style=color:#666>{</span>
            balance: -0.5
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 david 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 199.5 <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新 david 的账户余额</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$mul</span>: <span style=color:#666>{</span>
            balance: 0.5
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 david 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 99.75 <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>$inc</code>和<code>$mul</code>命令只能应用在数字字段上</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$inc</span>: <span style=color:#666>{</span>
            name: -0.5
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;writeError&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;code&#34;</span> : 14,
		<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;Cannot apply </span><span style=color:#bb60d5>$inc</span><span style=color:#4070a0> to a value of non-numeric type. {_id: ObjectId(&#39;5ce00d5972e77e7cb392a8ff&#39;)} has the field &#39;name&#39; of non-numeric type string&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如果被<code>$inc</code>或<code>$mul</code>更新的字段不存在。。。</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$inc</span>: <span style=color:#666>{</span>
            notYetExist: <span style=color:#40a070>10</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 99.75, <span style=color:#4070a0>&#34;notYetExist&#34;</span> : <span style=color:#40a070>10</span> <span style=color:#666>}</span>

&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$mul</span>: <span style=color:#666>{</span>
            notYetExistEither: <span style=color:#40a070>20</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 99.75, <span style=color:#4070a0>&#34;notYetExist&#34;</span> : 10, <span style=color:#4070a0>&#34;notYetExistEither&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=min-和-max-操作符>$min 和 $max 操作符 <a href=#min-%e5%92%8c-max-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>比较之后更新字段值</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法: 
<span style=color:#666>{</span> <span style=color:#bb60d5>$min</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#bb60d5>$max</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, info: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>2500</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新 karen 的账户余额</span>
<span style=color:#60a0b0;font-style:italic># 比较 info.balance 字段原本的字段值与5000的大小，把这两者中较小的保留，作为 info.balance 字段的值</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$min</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.balance&#34;</span>: <span style=color:#40a070>5000</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 更新 karen 的账户余额</span>
<span style=color:#60a0b0;font-style:italic># 比较 info.balance 字段原本的字段值与5000的大小，把这两者中较大的保留，作为 info.balance 字段的值</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$max</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.balance&#34;</span>: <span style=color:#40a070>5000</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, info: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2017-01-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>5000</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 更新 karen 的开户时间</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$min</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.dateOpened&#34;</span>: new Date<span style=color:#666>(</span><span style=color:#4070a0>&#34;2013-10-01T16:00:00Z&#34;</span><span style=color:#666>)</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, info: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2013-10-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>5000</span>
	<span style=color:#666>}</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
如果被更新的字段不存在。。。</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$min</span>: <span style=color:#666>{</span>
            notYetExist: <span style=color:#40a070>10</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 kaven 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, info: 1, notYetExist: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2013-10-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>5000</span>
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;notYetExist&#34;</span> : <span style=color:#40a070>10</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如果被更新的字段不存在，<code>$min</code>和<code>$max</code>命令会创建字段，并且将字段值设置为命令中的更新值
如果被更新的字段类型和更新值类型不一致。。。</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$min</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;info.balance&#34;</span>: null
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, info: 1, notYetExist: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2013-10-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : null
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;notYetExist&#34;</span> : <span style=color:#40a070>10</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>如果被更新的字段类型和更新值类型不一致，<code>$min</code>和<code>$max</code>命令会按照<code>BSON</code>数据类型排序规则进行比较</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>(最小)
Null
Numbers (ints, longs, doubles, decimals)
Symbol, <span style=color:#007020>String</span>
<span style=color:#007020>Object</span>
<span style=color:#007020>Array</span>
BinData
ObjectId
<span style=color:#007020>Boolean</span>
<span style=color:#007020>Date</span>
Timestamp
Regular Expression
(最大)
</code></pre></td></tr></table>
</div>
</div><h3 id=数组更新操作符>数组更新操作符 <a href=#%e6%95%b0%e7%bb%84%e6%9b%b4%e6%96%b0%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h3>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#bb60d5>$addToSet</span>   向数组中增添元素
<span style=color:#bb60d5>$pop</span>        从数组中移除元素
<span style=color:#bb60d5>$pull</span>       从数组中有选择性地移除元素
<span style=color:#bb60d5>$pullAll</span>    从数组中有选择性地移除元素
<span style=color:#bb60d5>$push</span>       向数组中增添元素
</code></pre></td></tr></table>
</div>
</div><h4 id=addtoset-操作符>$addToSet 操作符 <a href=#addtoset-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>向数组字段中添加元素</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$addToSet</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 向 karen 的账户文档中添加联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$addToSet</span>: <span style=color:#666>{</span>
            contact: <span style=color:#4070a0>&#34;China&#34;</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
如果要插入的值已经存在数组字段中，则<code>$addToSet</code>不会再添加重复值
注意一下，使用<code>$addToSet</code>插入数组和文档时，插入值中的字段顺序也和已有值重复的时候，才被算作重复值被忽略</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 向 karen 的账户文档中添加新的联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$addToSet</span>: <span style=color:#666>{</span>
            contact: <span style=color:#666>{</span>
                <span style=color:#4070a0>&#34;secondaryEmail&#34;</span>: <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
                <span style=color:#4070a0>&#34;primaryEmail&#34;</span>: <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
            <span style=color:#666>}</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic>## 向数组字段中添加多个值</span>

<span style=color:#60a0b0;font-style:italic># 向 karen 的账户文档中添加多个联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$addToSet</span>: <span style=color:#666>{</span>
            contact: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;contact1&#34;</span>, <span style=color:#4070a0>&#34;contact2&#34;</span> <span style=color:#666>]</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;contact1&#34;</span>,
			<span style=color:#4070a0>&#34;contact2&#34;</span>
		<span style=color:#666>]</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic>#由此可见，默认情况下，$addToSet 会将数组插入被更新的数组字段中，成为内嵌数组</span>
<span style=color:#60a0b0;font-style:italic>#如果想要将多个元素直接添加到数组字段中，则需要使用 $each 操作符</span>

<span style=color:#60a0b0;font-style:italic># 向 karen 的账户文档中添加多个联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$addToSet</span>: <span style=color:#666>{</span>
            contact: <span style=color:#666>{</span>
                <span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;contact1&#34;</span>, <span style=color:#4070a0>&#34;contact2&#34;</span> <span style=color:#666>]</span>
            <span style=color:#666>}</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;contact1&#34;</span>,
			<span style=color:#4070a0>&#34;contact2&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>,
		<span style=color:#4070a0>&#34;contact2&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=pop-操作符>$pop 操作符 <a href=#pop-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>从数组字段中删除元素(只能删除数组中第一个或者最后一个元素)</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$pop</span>: <span style=color:#666>{</span> &lt;field&gt;: &lt;-1 | 1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 从 karen 的账户文档中删除最后一个联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$pop</span>: <span style=color:#666>{</span>
            contact: <span style=color:#40a070>1</span>
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;contact1&#34;</span>,
			<span style=color:#4070a0>&#34;contact2&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 从 karen 的账户文档中删除第一个联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span>
        <span style=color:#bb60d5>$pop</span>: <span style=color:#666>{</span>
            <span style=color:#4070a0>&#34;contact.5&#34;</span>: -1
        <span style=color:#666>}</span>
    <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;contact2&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 继续从 karen 的账户文档中删除联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pop</span>: <span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;contact.5&#34;</span>: -1
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
    <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
    <span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
删除掉数组中最后一个元素后，会留下空数组
<code>$pop</code>操作符只能应用在数组字段上</p>
</blockquote>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pop</span>: <span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;contact.1&#34;</span>: -1
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;writeError&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;code&#34;</span> : 14,
		<span style=color:#4070a0>&#34;errmsg&#34;</span> : <span style=color:#4070a0>&#34;Path &#39;contact.1&#39; contains an element of non-array type &#39;string&#39;&#34;</span>
	<span style=color:#666>}</span>
<span style=color:#666>})</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=pull-操作符>$pull 操作符 <a href=#pull-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>从数组字段中删除特定元素(灵活性比<code>$pop</code>强)</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value | condition&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 为了演示方便，首先将 karen 的账户文档复制成为一篇新文档，并且把新文档的用户姓名设置为 lawrence</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.forEach<span style=color:#666>(</span><span style=color:#bb60d5>doc</span> <span style=color:#666>=</span>&gt; <span style=color:#666>{</span>
	var <span style=color:#bb60d5>newDoc</span> <span style=color:#666>=</span> doc;
	newDoc.name <span style=color:#666>=</span> <span style=color:#4070a0>&#34;lawrence&#34;</span>;
	db.accounts.insert<span style=color:#666>(</span>newDoc<span style=color:#666>)</span>;
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span> <span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span> <span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce188c687c9a4c5934a9550&#34;</span><span style=color:#666>)</span>,
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>,
	<span style=color:#4070a0>&#34;info&#34;</span> : <span style=color:#666>{</span>
		<span style=color:#4070a0>&#34;dateOpened&#34;</span> : ISODate<span style=color:#666>(</span><span style=color:#4070a0>&#34;2013-10-01T16:00:00Z&#34;</span><span style=color:#666>)</span>,
		<span style=color:#4070a0>&#34;balance&#34;</span> : null
	<span style=color:#666>}</span>,
	<span style=color:#4070a0>&#34;branch&#34;</span> : <span style=color:#4070a0>&#34;branch1&#34;</span>,
	<span style=color:#4070a0>&#34;notYetExist&#34;</span> : <span style=color:#40a070>10</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 从 karen 的联系方式中删除包含 &#39;hi&#39; 字母的元素</span>
<span style=color:#60a0b0;font-style:italic># 想一想，既然是针对数组元素的筛选条件，是否需要使用 $elemMatch 操作符呢？</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$regex</span>: /hi/ <span style=color:#666>}</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 事实上，既然 $pull 操作符本身是只能作用在数组元素上的，我们便不需要再额外使用 $elemMatch 操作符了</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$regex</span>: /hi/ <span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 当然，如果有数组元素本身就是一个内嵌数组，我们也可以使用 $elemMatch 来对这些内嵌数组进行筛选</span>

<span style=color:#60a0b0;font-style:italic># 从 karen 的联系方式中删除电话号码 22222222</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>{</span> <span style=color:#bb60d5>$elemMatch</span>: <span style=color:#666>{</span> <span style=color:#bb60d5>$eq</span>: <span style=color:#4070a0>&#34;22222222&#34;</span> <span style=color:#666>}}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 karen 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>
<span style=color:#60a0b0;font-style:italic># 这里需要说明一下，虽然 $elemMatch 匹配的是内嵌数组中的元素，但是 $pull 的删除操作是针对 contact 的顶级元素进行的，所以会把符合内嵌数组中的筛选条件的元素所在的顶级元素整个删除掉。</span>
<span style=color:#60a0b0;font-style:italic># 因此，33333333没有出现在查询结果中</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=pullall-操作符>$pullAll 操作符 <a href=#pullall-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>从数组字段中删除特定元素</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#666>{</span> <span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#bb60d5>$pullAll</span>: <span style=color:#666>{</span> &lt;field1&gt;: <span style=color:#666>[</span> &lt;value1&gt;, &lt;value2&gt;, ... <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#666>{</span> <span style=color:#bb60d5>$pullAll</span>: <span style=color:#666>{</span> &lt;field1&gt;: <span style=color:#666>[</span> &lt;value1&gt;, &lt;value2&gt;, ... <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span>
相当于
<span style=color:#666>{</span> <span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span> &lt;field1&gt;: <span style=color:#666>{</span> <span style=color:#bb60d5>$in</span>: <span style=color:#666>[</span> &lt;value1&gt;, &lt;value2&gt;, ... <span style=color:#666>]</span> <span style=color:#666>}</span> <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic>## 如果要删除的元素是一个内嵌数组，则数组元素的值和排列顺序都必须和被删除的数组完全一样</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 删除第一个联系方式</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pullAll</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>[</span> <span style=color:#666>[</span><span style=color:#4070a0>&#34;33333333&#34;</span>, <span style=color:#4070a0>&#34;22222222&#34;</span><span style=color:#666>]</span> <span style=color:#666>]</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>
<span style=color:#60a0b0;font-style:italic># 因为排列顺序不一样，所以没有被删除</span>

<span style=color:#60a0b0;font-style:italic>## 如果要删除的元素是一个内嵌文档</span>
<span style=color:#bb60d5>$pullAll</span> 命令只会删除字段和字段排列顺序都完全匹配的文档元素

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pullAll</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>[</span> <span style=color:#666>{</span><span style=color:#4070a0>&#34;primaryEmail&#34;</span>:<span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span><span style=color:#666>}</span> <span style=color:#666>]</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>0</span> <span style=color:#666>})</span>
<span style=color:#60a0b0;font-style:italic># 因为提供给 $pullAll 的文档和源文档并没有完全匹配，所以没有删除</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pullAll</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>[</span> 
				<span style=color:#666>{</span> <span style=color:#4070a0>&#34;secondaryEmail&#34;</span>: <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>, <span style=color:#4070a0>&#34;primaryEmail&#34;</span>: <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span> <span style=color:#666>}</span>,
			<span style=color:#666>]</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#60a0b0;font-style:italic># 只会删除第二个内嵌文档</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;primaryEmail&#34;</span> : <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
			<span style=color:#4070a0>&#34;secondaryEmail&#34;</span> : <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 但是，$pull 命令会删除包含指定的文档字段和字段值的文档元素，字段排列顺序不需要完全匹配。</span>
<span style=color:#60a0b0;font-style:italic># 这一点和 $pullAll 不太一样</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>{</span>
				<span style=color:#4070a0>&#34;primaryEmail&#34;</span>: <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#60a0b0;font-style:italic># $pull 在删除内嵌文档的时候，允许部分匹配，他的模糊程度更高</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 将刚才删除的文档元素再添加到 contact 数组中去</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$addToSet</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>{</span>
				<span style=color:#4070a0>&#34;primaryEmail&#34;</span>: <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>,
				<span style=color:#4070a0>&#34;secondaryEmail&#34;</span>: <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$pull</span>: <span style=color:#666>{</span>
			contact: <span style=color:#666>{</span>
				<span style=color:#4070a0>&#34;secondaryEmail&#34;</span>: <span style=color:#4070a0>&#34;yyy@gmail.com&#34;</span>,
				<span style=color:#4070a0>&#34;primaryEmail&#34;</span>: <span style=color:#4070a0>&#34;xxx@gmail.com&#34;</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#60a0b0;font-style:italic># 可以看到，$pull 在删除内嵌文档时，对字段的排列顺序没有要求</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=push-操作符>$push 操作符 <a href=#push-%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>向数组字段中添加元素</p>
<p><code>$push</code>和<code>$addToSet</code>命令相似，但是<code>$push</code>命令的功能更强大</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">  9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 85
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 86
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 87
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 88
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 89
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 90
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 91
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 92
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 93
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 94
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 95
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 96
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 97
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 98
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 99
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">100
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">101
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">102
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">103
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">104
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">105
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">106
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">107
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">108
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">109
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">110
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">111
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">112
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">113
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">114
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">115
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">116
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">117
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">118
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">119
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">120
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">121
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">122
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">123
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">124
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">125
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">126
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">127
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">128
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">129
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">130
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">131
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">132
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">133
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">134
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">135
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">136
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">137
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">138
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">139
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">140
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">141
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">142
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">143
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">144
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">145
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">146
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">147
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">148
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">149
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">150
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">151
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">152
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">153
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">154
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">155
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">156
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">157
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">158
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">159
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">160
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">161
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">162
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">163
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">164
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">165
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">166
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">167
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">168
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">169
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">170
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">171
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">172
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">173
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">174
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">175
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">176
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">177
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">178
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">179
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">180
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">181
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">182
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">183
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">184
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">185
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">186
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">187
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">188
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">189
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">190
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">191
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">192
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">193
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">194
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">195
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">196
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">197
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">198
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">199
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">200
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">201
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">202
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">203
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">204
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">205
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">206
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">207
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">208
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">209
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">210
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">211
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">212
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">213
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">214
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">215
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">216
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">217
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">218
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">219
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">220
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">221
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">222
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">223
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">224
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">225
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">226
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">227
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">228
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">229
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">230
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">231
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">232
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">233
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">234
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">235
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">236
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">237
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">238
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">239
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">240
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">241
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">242
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">243
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">244
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">245
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">246
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">247
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">248
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">249
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">250
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">251
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">252
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">253
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">254
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">255
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">256
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">257
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">258
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">259
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">260
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">261
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">262
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">263
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">264
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">265
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">266
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">267
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">268
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">269
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">270
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">271
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">272
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">273
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">274
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">275
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">276
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">277
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">278
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">279
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">280
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">281
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">282
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">283
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">284
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">285
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">286
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">287
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">288
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">289
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">290
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">291
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">292
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">293
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">294
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">295
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">296
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">297
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">298
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">299
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">300
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">301
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">302
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">303
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">304
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">305
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">306
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">307
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">308
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">309
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">310
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">311
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">312
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">313
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">314
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">315
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">316
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">317
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">318
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">319
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">320
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">321
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">322
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">323
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">324
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">325
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">326
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> <span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span> &lt;field1&gt;: &lt;value1&gt;, ... <span style=color:#666>}</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 和 $addToSet 命令一样，如果 $push 命令中指定的数组字段不存在，则这个字段会被添加到原文档中</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#4070a0>&#34;new element&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>, <span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;new element&#34;</span> <span style=color:#666>]</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic>## 和 $addToSet 相似，$push 操作符也可以和 $each 搭配使用</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> 2, 3, <span style=color:#40a070>4</span> <span style=color:#666>]</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>, <span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span> <span style=color:#4070a0>&#34;new element&#34;</span>, 2, 3, <span style=color:#40a070>4</span> <span style=color:#666>]</span> <span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## $push 和 $each 操作符还可以和更多的操作符搭配使用，实现比 $addToSet 更复杂的操作</span>

<span style=color:#60a0b0;font-style:italic>## 使用 $position 操作符将元素插入到数组的指定位置</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;pos1&#34;</span>, <span style=color:#4070a0>&#34;pos2&#34;</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$position</span>: <span style=color:#40a070>0</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		2,
		3,
		<span style=color:#40a070>4</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;pos3&#34;</span>, <span style=color:#4070a0>&#34;pos4&#34;</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$position</span>: -1  <span style=color:#60a0b0;font-style:italic>#插入到最后一个元素的前面</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		2,
		3,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos4&#34;</span>,
		<span style=color:#40a070>4</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic>## 使用 $sort 对数组进行排序</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;sort1&#34;</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$sort</span>: <span style=color:#40a070>1</span>  <span style=color:#60a0b0;font-style:italic># 1升序 -1降序</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		2,
		3,
		4,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos4&#34;</span>,
		<span style=color:#4070a0>&#34;sort1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 如果插入的元素是一个内嵌文档，也可以根据内嵌文档的字段值进行排序</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#666>{</span> key: <span style=color:#4070a0>&#34;sort&#34;</span>, value: <span style=color:#40a070>100</span> <span style=color:#666>}</span>, <span style=color:#666>{</span> key: <span style=color:#4070a0>&#34;sort&#34;</span>, value: <span style=color:#40a070>200</span> <span style=color:#666>}</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$sort</span>: <span style=color:#666>{</span> value: -1 <span style=color:#666>}</span>  <span style=color:#60a0b0;font-style:italic># 1升序 -1降序</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;key&#34;</span> : <span style=color:#4070a0>&#34;sort&#34;</span>,
			<span style=color:#4070a0>&#34;value&#34;</span> : <span style=color:#40a070>200</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;key&#34;</span> : <span style=color:#4070a0>&#34;sort&#34;</span>,
			<span style=color:#4070a0>&#34;value&#34;</span> : <span style=color:#40a070>100</span>
		<span style=color:#666>}</span>,
		2,
		3,
		4,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos4&#34;</span>,
		<span style=color:#4070a0>&#34;sort1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 如果不想插入元素，只想对文档中的数组字段进行排序。。。</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$sort</span>: -1
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;key&#34;</span> : <span style=color:#4070a0>&#34;sort&#34;</span>,
			<span style=color:#4070a0>&#34;value&#34;</span> : <span style=color:#40a070>200</span>
		<span style=color:#666>}</span>,
		<span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;key&#34;</span> : <span style=color:#4070a0>&#34;sort&#34;</span>,
			<span style=color:#4070a0>&#34;value&#34;</span> : <span style=color:#40a070>100</span>
		<span style=color:#666>}</span>,
		<span style=color:#4070a0>&#34;sort1&#34;</span>,
		<span style=color:#4070a0>&#34;pos4&#34;</span>,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		4,
		3,
		<span style=color:#40a070>2</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## 使用 $slice 来截取数组的一部分</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;slice1&#34;</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$slice</span>: -8  <span style=color:#60a0b0;font-style:italic>#只保留最后8个元素，其他的都被删除掉</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		4,
		3,
		2,
		<span style=color:#4070a0>&#34;slice1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 如果不想插入元素，只想截取文档中的数组字段。。。</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$slice</span>: <span style=color:#40a070>6</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>,
		<span style=color:#4070a0>&#34;new element&#34;</span>,
		4,
		<span style=color:#40a070>3</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic>## $position, $sort, $slice 可以一起使用</span>
<span style=color:#60a0b0;font-style:italic># 这三个操作符的执行顺序是:</span>
<span style=color:#60a0b0;font-style:italic># $position -&gt; $sort -&gt; $slice</span>
<span style=color:#60a0b0;font-style:italic># 写在命令中的操作符顺序并不重要，并不会影响命令的执行顺序</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$push</span>: <span style=color:#666>{</span>
			newArray: <span style=color:#666>{</span>
				<span style=color:#bb60d5>$each</span>: <span style=color:#666>[</span> <span style=color:#4070a0>&#34;push1&#34;</span>, <span style=color:#4070a0>&#34;push2&#34;</span> <span style=color:#666>]</span>,
				<span style=color:#bb60d5>$position</span>: 2,
				<span style=color:#bb60d5>$sort</span>: -1,
				<span style=color:#bb60d5>$slice</span>: <span style=color:#40a070>5</span>
			<span style=color:#666>}</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;push2&#34;</span>,
		<span style=color:#4070a0>&#34;push1&#34;</span>,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=占位操作符>$占位操作符 <a href=#%e5%8d%a0%e4%bd%8d%e6%93%8d%e4%bd%9c%e7%ac%a6 class=anchor>¶</a></h4>
<p>更新数组中的特定元素</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
db.collection.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> &lt;array&gt;: &lt;query selector&gt; <span style=color:#666>}</span>,
	<span style=color:#666>{</span> &lt;update operator&gt;: <span style=color:#666>{</span> <span style=color:#4070a0>&#34;&lt;array&gt;.</span>$<span style=color:#4070a0>&#34;</span>: value <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
$ 是数组中第一个符合筛选条件的数组元素的占位符
搭配更新操作符使用，可以对满足筛选条件的数组元素进行更新

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;push2&#34;</span>,
		<span style=color:#4070a0>&#34;push1&#34;</span>,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;pos2&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span>, newArray: <span style=color:#4070a0>&#34;pos2&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;newArray.</span>$<span style=color:#4070a0>&#34;</span>: <span style=color:#4070a0>&#34;updated&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, newArray: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;newArray&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#4070a0>&#34;push2&#34;</span>,
		<span style=color:#4070a0>&#34;push1&#34;</span>,
		<span style=color:#4070a0>&#34;pos3&#34;</span>,
		<span style=color:#4070a0>&#34;updated&#34;</span>,
		<span style=color:#4070a0>&#34;pos1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><p>更新数组中的所有元素</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
db.collection.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> &lt;query&gt; <span style=color:#666>}</span>,
	<span style=color:#666>{</span> &lt;update operator&gt;: <span style=color:#666>{</span> <span style=color:#4070a0>&#34;&lt;array&gt;.</span>$<span style=color:#4070a0>[]&#34;</span>: value <span style=color:#666>}</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>

$<span style=color:#666>[]</span> 指代数组字段中的所有元素
搭配更新操作符使用，可以对数组中所有的元素进行更新

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;22222222&#34;</span>,
			<span style=color:#4070a0>&#34;33333333&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			<span style=color:#4070a0>&#34;contact.0.</span>$<span style=color:#4070a0>[]&#34;</span>: <span style=color:#4070a0>&#34;88888888&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 lawrence 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, contact: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span>
	<span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span>,
	<span style=color:#4070a0>&#34;contact&#34;</span> : <span style=color:#666>[</span>
		<span style=color:#666>[</span>
			<span style=color:#4070a0>&#34;88888888&#34;</span>,
			<span style=color:#4070a0>&#34;88888888&#34;</span>
		<span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;Beijing&#34;</span>,
		<span style=color:#4070a0>&#34;China&#34;</span>,
		<span style=color:#666>[</span> <span style=color:#666>]</span>,
		<span style=color:#4070a0>&#34;contact1&#34;</span>
	<span style=color:#666>]</span>
<span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id=update-options>update options <a href=#update-options class=anchor>¶</a></h3>
<p><code>db.&lt;collection>.update(&lt;query>, &lt;update>, &lt;options>)</code></p>
<p><code>&lt;options></code>参数提供了<code>update</code>命令的更多选项</p>
<h4 id=multi-更新多个文档>multi 更新多个文档 <a href=#multi-%e6%9b%b4%e6%96%b0%e5%a4%9a%e4%b8%aa%e6%96%87%e6%a1%a3 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> multi: &lt;boolean&gt; <span style=color:#666>}</span>

在默认情况下，即使筛选条件对应了多篇文档，update命令仍然只会更新一篇文档

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			currency: <span style=color:#4070a0>&#34;USD&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, currency: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bill&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 使用 multi 选项来更新多个符合筛选条件的文档</span>
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			currency: <span style=color:#4070a0>&#34;USD&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>,
	<span style=color:#666>{</span> multi: <span style=color:#007020>true</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 24, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>23</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, currency: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.pretty<span style=color:#666>()</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bill&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;currency&#34;</span> : <span style=color:#4070a0>&#34;USD&#34;</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意:
<code>MongoDB</code>只能保证<strong>单个</strong>文档操作的原子性，不能保证<strong>多个</strong>文档操作的原子性
更新多个文档的操作虽然在单一线程中执行，但是线程在执行过程中可能会被挂起，以便其他线程也有机会对数据进行操作
如果需要保证多个文档操作时的原子性，就需要使用<code>MongoDB 4.0</code>版本中引入的事物功能进行操作</p>
</blockquote>
<h4 id=upsert-更新或创建文档>upsert 更新或创建文档 <a href=#upsert-%e6%9b%b4%e6%96%b0%e6%88%96%e5%88%9b%e5%bb%ba%e6%96%87%e6%a1%a3 class=anchor>¶</a></h4>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
<span style=color:#666>{</span> upsert: &lt;boolean&gt; <span style=color:#666>}</span>

在默认情况下，如果 update 命令中的筛选条件没有匹配任何文档，则不会进行任何操作
将 upsert 选项设置为 true, 如果 update 命令中的筛选条件没有匹配任何文档，则会创建新文档

<span style=color:#60a0b0;font-style:italic># 查看 maggie 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;maggie&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
无输出，说明没有这个用户

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;maggie&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			balance: <span style=color:#40a070>700</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>,
	<span style=color:#666>{</span> upsert: <span style=color:#007020>true</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 1,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce23eaf65fdd3b3b65b3810&#34;</span><span style=color:#666>)</span>
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 maggie 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;maggie&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;maggie&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>700</span> <span style=color:#666>}</span>

如果无法从筛选条件中推断出确定的字段值，新创建的文档将不会包含筛选条件涉及的字段

&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$gt</span>: <span style=color:#40a070>20000</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			name: <span style=color:#4070a0>&#34;nick&#34;</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>,
	<span style=color:#666>{</span> upsert: <span style=color:#007020>true</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span>
	<span style=color:#4070a0>&#34;nMatched&#34;</span> : 0,
	<span style=color:#4070a0>&#34;nUpserted&#34;</span> : 1,
	<span style=color:#4070a0>&#34;nModified&#34;</span> : 0,
	<span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce2403b65fdd3b3b65b3869&#34;</span><span style=color:#666>)</span>
<span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看 nick 的银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{</span> name: <span style=color:#4070a0>&#34;nick&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;nick&#34;</span> <span style=color:#666>}</span>
<span style=color:#60a0b0;font-style:italic># 👆这里没有包含 balance 字段</span>
</code></pre></td></tr></table>
</div>
</div><h4 id=save>save <a href=#save class=anchor>¶</a></h4>
<p>这个命令也可以用来更新文档</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
db.&lt;collection&gt;.save<span style=color:#666>(</span>&lt;document&gt;<span style=color:#666>)</span>
</code></pre></td></tr></table>
</div>
</div><p>如果<code>document</code>文档中包含了<code>_id</code>字段，<code>save()</code>命令将会调用<code>db.collection.update()</code>命令(<code>upsert</code>选项被打开)</p>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, _id: <span style=color:#40a070>1</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00c9672e77e7cb392a8fd&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bill&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8fe&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;charlie&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00d5972e77e7cb392a8ff&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce00f5272e77e7cb392a901&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce011fd72e77e7cb392a902&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;george&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce0f15c72e77e7cb392a90c&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;001&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;savings&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;002&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#666>{</span> <span style=color:#4070a0>&#34;type&#34;</span> : <span style=color:#4070a0>&#34;alipay&#34;</span>, <span style=color:#4070a0>&#34;accountId&#34;</span> : <span style=color:#4070a0>&#34;003&#34;</span> <span style=color:#666>}</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90d&#34;</span><span style=color:#666>)</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1107d72e77e7cb392a90e&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : ObjectId<span style=color:#666>(</span><span style=color:#4070a0>&#34;5ce1225972e77e7cb392a90f&#34;</span><span style=color:#666>)</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># _id已存在，更新已有文档</span>
&gt; db.accounts.save<span style=color:#666>(</span>
	<span style=color:#666>{</span> _id: <span style=color:#4070a0>&#34;account1&#34;</span>, name: <span style=color:#4070a0>&#34;alice&#34;</span>, balance: <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
相当于执行
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> _id: <span style=color:#4070a0>&#34;account1&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			name: <span style=color:#4070a0>&#34;alice&#34;</span>,
			balance: <span style=color:#40a070>100</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>,
	<span style=color:#666>{</span> upsert: <span style=color:#007020>true</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 1, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 0, <span style=color:#4070a0>&#34;nModified&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;alice&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account1&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic># _id不存在，创建新文档</span>
&gt; db.accounts.save<span style=color:#666>(</span>
	<span style=color:#666>{</span> _id: <span style=color:#4070a0>&#34;account2&#34;</span>, name: <span style=color:#4070a0>&#34;oliver&#34;</span>, balance: <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
相当于执行
&gt; db.accounts.update<span style=color:#666>(</span>
	<span style=color:#666>{</span> _id: <span style=color:#4070a0>&#34;account2&#34;</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span>
		<span style=color:#bb60d5>$set</span>: <span style=color:#666>{</span>
			name: <span style=color:#4070a0>&#34;oliver&#34;</span>,
			balance: <span style=color:#40a070>100</span>
		<span style=color:#666>}</span>
	<span style=color:#666>}</span>,
	<span style=color:#666>{</span> upsert: <span style=color:#007020>true</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nMatched&#34;</span> : 0, <span style=color:#4070a0>&#34;nUpserted&#34;</span> : 1, <span style=color:#4070a0>&#34;nModified&#34;</span> : 0, <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account2&#34;</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>({</span> name: <span style=color:#4070a0>&#34;oliver&#34;</span> <span style=color:#666>})</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;_id&#34;</span> : <span style=color:#4070a0>&#34;account2&#34;</span>, <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;oliver&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id=删除文档>删除文档 <a href=#%e5%88%a0%e9%99%a4%e6%96%87%e6%a1%a3 class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">77
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">78
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">79
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">80
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">81
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">82
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">83
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">84
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">85
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
db.&lt;collection&gt;.remove<span style=color:#666>(</span>&lt;query&gt;, &lt;options&gt;<span style=color:#666>)</span>

<span style=color:#60a0b0;font-style:italic># &lt;query&gt;文档定义了删除操作时筛选文档的条件</span>
<span style=color:#60a0b0;font-style:italic># 这里的&lt;query&gt;文档与 db.collection.find() 中的 &lt;query&gt; 文档是相同的</span>

<span style=color:#60a0b0;font-style:italic># &lt;options&gt;文档声明了一些删除操作的选项</span>


<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.sort<span style=color:#666>({</span> balance: <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#666>{</span>  <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span>  <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;nick&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bill&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>80</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 99.75 <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;alice&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;tom&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;oliver&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>100</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 删除余额为100的银行账户文档</span>
&gt; db.accounts.remove<span style=color:#666>({</span> balance: <span style=color:#40a070>100</span> <span style=color:#666>})</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nRemoved&#34;</span> : <span style=color:#40a070>4</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.sort<span style=color:#666>({</span> balance: <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#666>{</span>  <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span>  <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;nick&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;bill&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>80</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 99.75 <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>


<span style=color:#60a0b0;font-style:italic># 在默认情况下，remove 命令会删除所有符合筛选条件的文档</span>
<span style=color:#60a0b0;font-style:italic># 如果只想删除满足筛选条件的一篇文档，可以使用 justOne 选项</span>

<span style=color:#60a0b0;font-style:italic># 删除一篇余额小于100的银行账户文档</span>
&gt; db.accounts.remove<span style=color:#666>(</span>
	<span style=color:#666>{</span> balance: <span style=color:#666>{</span> <span style=color:#bb60d5>$lt</span>: <span style=color:#40a070>100</span> <span style=color:#666>}</span> <span style=color:#666>}</span>,
	<span style=color:#666>{</span> justOne: <span style=color:#007020>true</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nRemoved&#34;</span> : <span style=color:#40a070>1</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.sort<span style=color:#666>({</span> balance: <span style=color:#40a070>1</span> <span style=color:#666>})</span>
<span style=color:#666>{</span>  <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;karen&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span>  <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;lawrence&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;nick&#34;</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;fred&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>20</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;david&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : 99.75 <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;john&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>
<span style=color:#666>{</span> <span style=color:#4070a0>&#34;name&#34;</span> : <span style=color:#4070a0>&#34;champ&#34;</span>, <span style=color:#4070a0>&#34;balance&#34;</span> : <span style=color:#40a070>200</span> <span style=color:#666>}</span>

<span style=color:#60a0b0;font-style:italic># 删除集合内的所有文档</span>
&gt; db.accounts.remove<span style=color:#666>({})</span>
WriteResult<span style=color:#666>({</span> <span style=color:#4070a0>&#34;nRemoved&#34;</span> : <span style=color:#40a070>22</span> <span style=color:#666>})</span>

<span style=color:#60a0b0;font-style:italic># 查看银行账户文档</span>
&gt; db.accounts.find<span style=color:#666>(</span>
	<span style=color:#666>{}</span>,
	<span style=color:#666>{</span> name: 1, balance: 1, _id: <span style=color:#40a070>0</span> <span style=color:#666>}</span>
<span style=color:#666>)</span>.sort<span style=color:#666>({</span> balance: <span style=color:#40a070>1</span> <span style=color:#666>})</span>
无输出
</code></pre></td></tr></table>
</div>
</div><h2 id=删除集合>删除集合 <a href=#%e5%88%a0%e9%99%a4%e9%9b%86%e5%90%88 class=anchor>¶</a></h2>
<div class=highlight><div style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4>
<table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span></code></pre></td>
<td style=vertical-align:top;padding:0;margin:0;border:0;width:100%>
<pre tabindex=0 style=background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>语法:
db.&lt;collection&gt;.drop<span style=color:#666>(</span> <span style=color:#666>{</span> writeConcern: &lt;document&gt; <span style=color:#666>}</span> <span style=color:#666>)</span>

这里的 writeConcern 文档定义了本次集合删除操作的安全写级别

<span style=color:#60a0b0;font-style:italic># 之前的 remove 命令可以删除集合内的所有文档，但是不会删除集合</span>
&gt; show collections
accounts

<span style=color:#60a0b0;font-style:italic># drop 命令可以删除整个集合，包括集合中的所有文档，以及集合的索引</span>
&gt; db.accounts.drop<span style=color:#666>()</span>
<span style=color:#007020>true</span>

&gt; show collections
无输出

<span style=color:#60a0b0;font-style:italic># 如果集合中的文档数量很多，使用 remove 命令删除所有文档的效率不高</span>
<span style=color:#60a0b0;font-style:italic># 这种情况下，更加有效率的方法，是使用 drop 命令删除整个集合，然后再创建空集合并创建索引</span>
</code></pre></td></tr></table>
</div>
</div>
</section>
<section class=related>
</section>
<div class=bottom-nav>
<a href=/posts/2019/05/mac-cheat-sheet/>&lt; Mac 实用技巧</a>
<a href=/posts/2019/05/deno_install_explain/>Deno安装脚本的解读 ></a>
</div>
<section class=comments>
<h3>Comments</h3>
</section>
</article>
</main>
</div>
</body>
</html>